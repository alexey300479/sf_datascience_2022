<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>Пережевывая логистическую регрессию / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.2d67f629.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.9b76199c.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.aeffa4e0.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.9b76199c.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.20fb7121c5d9f14909af6c8354ebb9b2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/articles\/485872\/"},"headline":"Пережевывая логистическую регрессию","datePublished":"2020-01-28T13:32:47+03:00","dateModified":"2020-10-30T11:48:14+03:00","author":{"@type":"Person","name":"Александр Петренко"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, фун...","url":"https:\/\/habr.com\/ru\/articles\/485872\/#post-content-body","about":["h_python","h_maths","h_machine_learning","h_study","h_artificial_intelligence","f_develop","f_management","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/485872\/2ef456ad68f6970ce2f07b0622f8c45a\/","https:\/\/habrastorage.org\/webt\/gz\/x1\/oz\/gzx1ozgcc-evcxyxrjjefqfetja.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/734\/c62\/0a1\/734c620a1b0b841a33c195da2b9eea42.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/585\/ef6\/e3a\/585ef6e3a3cddcd7fc7f3a2066a186b5.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e80\/d81\/93d\/e80d8193d49469dee69b5a8c4bf8b6ec.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/6cd\/3e7\/a4e\/6cd3e7a4e1762efb4733a1ef7d0047de.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d6e\/0b4\/554\/d6e0b4554b2d543ca71a394156c386b1.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/9b3\/4c4\/da5\/9b34c4da5c757d4982bbd1b6f2e8998a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/6d6\/a4f\/78f\/6d6a4f78fbacd6edecc018ce8ad3e364.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c6e\/9ce\/6fa\/c6e9ce6fa3ec33e39afdda03e5559c67.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/64b\/eb7\/37a\/64beb737a23fb5cb0a455f0e9213f2a4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d07\/cc5\/b26\/d07cc5b26db621faab45e0e0b54ede62.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b81\/a7c\/1e9\/b81a7c1e9676b36cc02ddeea5d5f6e51.svg","https:\/\/habrastorage.org\/webt\/is\/xw\/0m\/isxw0mnnbx1iowlms-cim4nekzs.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/bc0\/520\/56d\/bc052056d1d8b3737378422e61c0b96a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1d6\/fc6\/8e9\/1d6fc68e93e5b2fb640d3c5ba30838b4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b9a\/683\/b5b\/b9a683b5bb695de57126e5db4ebb7436.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4d5\/24b\/21f\/4d524b21f2020047e2d340a59f17ccba.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/0df\/530\/fff\/0df530ffff8762f5174e6539bc64ddc4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/bf8\/3b5\/32c\/bf83b532cd867d34004f8eded8c5c79a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/941\/d95\/780\/941d95780d8800fd32e758b586120101.svg","https:\/\/habrastorage.org\/webt\/6u\/mu\/vk\/6umuvkl-ulskbew1eptm9azq-ns.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c8a\/7a1\/d6e\/c8a7a1d6ed0bb61476e853b184c1ae34.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4a9\/d9b\/7c3\/4a9d9b7c3a796b664147c4267469a945.svg","https:\/\/habrastorage.org\/webt\/d5\/mt\/vp\/d5mtvp3cdodptyrglkqkjumcz4c.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/77c\/86b\/417\/77c86b4173bc0406c4de95039461df33.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/9d1\/49e\/a8e\/9d149ea8ef8692eb106a55ce5af36ccd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d06\/719\/edc\/d06719edc69908e7467f7e6189302b74.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f9c\/3c8\/e48\/f9c3c8e488ead4696749012f5ece6d13.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/83a\/09b\/484\/83a09b484baf09b29374b626743ee4de.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b0b\/232\/f34\/b0b232f343595119559cf1186dd5f4a7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e52\/d01\/8f8\/e52d018f87e1844bc2e714af79f0cdf0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d6d\/1e2\/ab7\/d6d1e2ab791a06785be738fe3a3a4f9d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d11\/82d\/cbe\/d1182dcbec38620f7bdfad6d7a8529ab.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f68\/2d0\/19e\/f682d019e8fd1f11da97e75f9863c232.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1d0\/034\/a09\/1d0034a09108db7af7cf42ea23a91ecd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/80b\/03c\/cfd\/80b03ccfdd0e8cb84e222715755ccf26.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a5d\/538\/f83\/a5d538f83bd73f9d1c9e8338db9a398a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/3e4\/c77\/a6e\/3e4c77a6e7c579a778fa84a18b6f4be0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1f1\/806\/caa\/1f1806caa396ad814c5cbae44638a38f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/3d4\/4dd\/ae7\/3d44ddae7c3d13b9dd873c4a1e09491b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/91c\/34b\/351\/91c34b351d7bb8df08e960b4cdc79b16.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/53f\/440\/8d3\/53f4408d3030531b75daef03c76269a0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/cc6\/f03\/35e\/cc6f0335e61e908711d629714f8d8b9e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f5c\/dcd\/662\/f5cdcd662a6590cdf971e57494ad123e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ca8\/978\/ec5\/ca8978ec597af63524046a377099d3e3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/578\/281\/d89\/578281d8997e0a562a02dd61422d408e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c61\/27e\/d7b\/c6127ed7b7116b2c9a29e8e238568254.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e94\/750\/131\/e9475013121faba30996b549a41012e4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/5ca\/4b8\/ca1\/5ca4b8ca180f7495da819508f8afce6e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/3b2\/5f5\/4ec\/3b25f54ec24ac9790536a5bfcdb7dcbd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c7e\/327\/ed9\/c7e327ed9d8fd93eb5907c962f2f0328.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1d2\/7d3\/bdb\/1d27d3bdb1b03bf2039cce88af50c550.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d2c\/bf7\/357\/d2cbf7357ab08df200b02965bbb4ab7d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c6d\/3a5\/e80\/c6d3a5e8054aff891d32c89f4ee0c644.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/833\/9ae\/0b9\/8339ae0b9d7645bc12a507a4ac54cf5d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/998\/ca3\/299\/998ca3299c7f4129d6975ea34d17809a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f0f\/e94\/423\/f0fe944236e68f60b16034803d6f1823.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/84e\/9ac\/43b\/84e9ac43b312c23b9b1f4df072eef404.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/8a4\/3e6\/be5\/8a43e6be57441a31f74f074ea308af36.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a63\/d3d\/38a\/a63d3d38ab1e837cefce61df83c7462e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/581\/dfc\/94f\/581dfc94f691212b843d5ca4ceb6cd9e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/6c6\/dea\/0d6\/6c6dea0d6895ca8fd36155c626096403.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a12\/825\/840\/a128258409b83f835e4ec02da427bfcf.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c25\/62f\/5ef\/c2562f5ef0d27f9097183c0938c48b52.svg","https:\/\/habrastorage.org\/webt\/ks\/by\/4c\/ksby4cvyvhchnyw3g7mogrucage.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/712\/33f\/9da\/71233f9da088a69f4f80e0a824f0bd91.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4c0\/d80\/e6b\/4c0d80e6b4c4049ac52c22fd0d27637e.svg","https:\/\/habrastorage.org\/webt\/10\/tg\/7r\/10tg7rztpblsl8swwgjzmlgtwlo.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/efe\/096\/7c6\/efe0967c69a87a9a7f693fd242b72387.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/cd6\/887\/374\/cd6887374d65ca7e0699f041a7654ae1.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/443\/801\/8cd\/4438018cd3c35de475a419ecf521c389.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/5c8\/4b2\/2b7\/5c84b22b7edd29e66fd652a658254ec0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/818\/0dc\/f31\/8180dcf31c8787d11205a3b3536e2900.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/005\/ad0\/d51\/005ad0d512f20ff825d820bdbd26ba7f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e64\/afb\/a2b\/e64afba2b591c3b84beebfc496e12c51.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/839\/f25\/c27\/839f25c2746382debd4f08ea25ad5ecf.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d0b\/857\/b4e\/d0b857b4ee991737b3ec7dbd1407cacb.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/edf\/fd0\/f08\/edffd0f0825aef6a235b500fb1b87584.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ad1\/c0a\/9f6\/ad1c0a9f6ac079079f55104222ff7a13.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d47\/c89\/4c4\/d47c894c4276b3f3b8b5fe9158ab0cfe.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/daf\/63d\/647\/daf63d6479f73e4d3402348866d62dbf.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/fb3\/a6d\/4e4\/fb3a6d4e4b9ab34c577d6e5ddc7cb395.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f8a\/1c5\/0ed\/f8a1c50ed39505a982ca83ce75812904.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f8e\/ca7\/d90\/f8eca7d90ef3968c1680a1be4dc64103.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/139\/181\/ad0\/139181ad0acdf2d6d84dcf662097019a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/832\/fa7\/c30\/832fa7c3084c0110a5e3d7621631a1fc.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/919\/a65\/b66\/919a65b6676bcd796279a8aac6163a7a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e47\/b36\/a76\/e47b36a76b99b13313aff0043d484c77.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/cca\/29f\/b6c\/cca29fb6c52655a8f94f7bbe703f11c7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/72f\/090\/8f0\/72f0908f0f53ffc3a54f80d75d3fb568.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/27f\/4f6\/6c3\/27f4f66c312aa01b7a3501d94baa0c49.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ee0\/c6f\/fe8\/ee0c6ffe8a8600fd1cbf065d96aef5ee.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d9e\/f57\/1ce\/d9ef571ce10aee3f03bdbda6593efa25.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c60\/0eb\/78d\/c600eb78d0627ef7e91964968ce726ab.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ff3\/c27\/3c6\/ff3c273c683dbcd3c7b00d2a071d6a7c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/08b\/a9c\/561\/08ba9c56140cf603308f9b84a26dc818.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d07\/f1d\/a80\/d07f1da809e6567bb1d0c45ee267aef7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/577\/682\/05c\/57768205c03a5547a4d44277f9c9d441.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/eb8\/e5d\/bae\/eb8e5dbae515dac15b124967e822d9b9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/50b\/e11\/495\/50be114953cd6d5bc76bbb62189f8b1b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f2d\/4d0\/64a\/f2d4d064aa2bf94950efb5b08c371248.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f5e\/477\/412\/f5e477412164fb26f86f1919a3280d08.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/961\/5a3\/c22\/9615a3c22f2f2616e78ffa70509cb3aa.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/784\/337\/a20\/784337a20607f4c11e39bdf873b1136a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/0cf\/b19\/be5\/0cfb19be54f9e85b2b01e516230de60c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b2d\/f21\/037\/b2df210378053a29907debcb8e4594e9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ae4\/dc5\/c6f\/ae4dc5c6fd4ec28ba4b81a2ec09d88b9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d3d\/f50\/b83\/d3df50b83f85c2e599b5a46b9d893c5e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/fd1\/184\/5be\/fd11845becb97f0b8b77b8b6e081ae3f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4a1\/375\/d87\/4a1375d876abb71c1dd376a63d13c727.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/569\/d14\/c6b\/569d14c6b282aa74ae81d7e57e25205d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f82\/7d8\/2db\/f827d82db4267e554348e2466d45bba6.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/482\/d62\/b49\/482d62b4937323f4105296ea8c16acef.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b5d\/f1c\/a28\/b5df1ca28f5177703028579f63ece0a3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/42a\/ee5\/5a3\/42aee55a3d38b48198849d201571fec7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/631\/c81\/b26\/631c81b26a64fc66071635fc4d148e83.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c78\/83a\/44f\/c7883a44f4318bc1e3efbc58d60ae578.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/130\/e8f\/691\/130e8f691883e01464d6cff33b3855b8.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1ad\/a5b\/74b\/1ada5b74b1742762c61122c55c12278d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/12e\/d0f\/ce9\/12ed0fce95916e6d30c11224edeedb2f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c2c\/0ab\/36e\/c2c0ab36e7845ed6bc08f3bfa7f7a6f5.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c5e\/32f\/f29\/c5e32ff297d5114261c85aa8b00d74e4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/98f\/639\/4b2\/98f6394b2bd98b852bb0895b97d55e9f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/2ef\/fe9\/b2f\/2effe9b2fa746e71bccdc797bd588ee2.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/cd2\/d35\/acf\/cd2d35acf1773be3215db6fd6e748ec9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/938\/9c1\/2ac\/9389c12ac3c73b94e1a58ee72b0a2f4b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/870\/10b\/55a\/87010b55ab3e5edfcdce9d64fcd39532.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/1ea\/f1d\/7cc\/1eaf1d7cc593750347f384d8d73d69a5.svg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.119.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Пережевывая логистическую регрессию" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Пережевывая логистическую регрессию" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Пережевывая логистическую регрессию" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="485872" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2020-01-28T10:32:47.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/articles/485872/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="анализ данных для начинающих, линейный классификатор, логистическая регрессия, правдоподобие, функция потерь &#x27;Logistic Loss&#x27;">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/publications/485872?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/articles/485872/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habrastorage.org/webt/go/l_/hb/gol_hb6f3ink4lzvhvgj5mk0gnc.jpeg" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark"><title>Профиль</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!----> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/AlexanderPetrenko/" title="AlexanderPetrenko" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/827/c53/968/827c5396819ba5bce84d403bb214ca99.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/AlexanderPetrenko/" class="tm-user-info__username">
      AlexanderPetrenko
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2020-01-28T10:32:47.000Z" title="2020-01-28, 13:32">28  янв  2020 в 13:32</time></span></span></span></div> <!----></div> <h1 lang="ru" class="tm-title tm-title_h1"><span>Пережевывая логистическую регрессию</span></h1> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    20 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">36K</span></span></div> <div class="tm-article-snippet__hubs-container"><div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/python/" class="tm-article-snippet__hubs-item-link"><span>Python</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/maths/" class="tm-article-snippet__hubs-item-link"><span>Математика</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/machine_learning/" class="tm-article-snippet__hubs-item-link"><span>Машинное обучение</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/study/" class="tm-article-snippet__hubs-item-link"><span>Учебный процесс в IT</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/artificial_intelligence/" class="tm-article-snippet__hubs-item-link"><span>Искусственный интеллект</span> <!----></a></span></div></div> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-tutorial"><span>
          Туториал
        </span></div> </div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><img src="https://habrastorage.org/r/w780q1/webt/gz/x1/oz/gzx1ozgcc-evcxyxrjjefqfetja.jpeg" data-src="https://habrastorage.org/webt/gz/x1/oz/gzx1ozgcc-evcxyxrjjefqfetja.jpeg" data-blurred="true"/><br/>
<br/>
В этой статье, мы будем разбирать теоретические выкладки преобразования <i>функции линейной регрессии</i> в <i>функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика)</i>. Затем, воспользовавшись арсеналом <i>метода максимального правдоподобия</i>, в соответствии с моделью логистической регрессии, выведем функцию потерь <i>Logistic Loss</i>, или другими словами, мы определим функцию, с помощью которой в модели логистической регрессии подбираются параметры вектора весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>.<br/>
<br/>
План статьи:<br/>
<br/>
<ol>
<li>Повторим о прямолинейной зависимости между двумя переменными</li>
<li>Выявим необходимость преобразования <i>функции линейной регрессии</i> <img src="https://habrastorage.org/getpro/habr/formulas/585/ef6/e3a/585ef6e3a3cddcd7fc7f3a2066a186b5.svg" alt="$ f(w,x_i) = \vec{w}^T \vec{x_i}$" data-tex="inline"/> в <i>функцию логистического отклика</i> <img src="https://habrastorage.org/getpro/habr/formulas/e80/d81/93d/e80d8193d49469dee69b5a8c4bf8b6ec.svg" alt="$\sigma(\vec{w}^T \vec{x_i}) = \frac{1}{1+e^{-\vec{w}^T \vec{x_i}}}$" data-tex="inline"/></li>
<li>Проведем преобразования и выведем <i>функцию логистического отклика</i></li>
<li>Попытаемся понять, чем плох метод наименьших квадратов при подборе параметров <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> функции <i>Logistic Loss</i></li>
<li>Используем <i>метод максимального правдоподобия</i> для определения <i>функции подбора параметров</i> <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>:<br/>
 <br/>
 5.1. Случай 1: функция <i>Logistic Loss</i> для объектов с обозначением классов <b>0</b> и <b>1</b>:<br/>
 <br/>
 <p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/6cd/3e7/a4e/6cd3e7a4e1762efb4733a1ef7d0047de.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n(-y_i \mkern 2mu log_e \mkern 5mu \sigma(\vec{w}^T \vec{x_i}) - (1-y_i) \mkern 2mu log_e \mkern 5mu (1 - \sigma(\vec{w}^T \vec{x_i})) ) \rightarrow min$" data-tex="display"/></p><br/>
 <br/>
 5.2. Случай 2: функция <i>Logistic Loss</i> для объектов с обозначением классов <b>-1</b> и <b>+1</b>:<br/>
 <br/>
 <p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/d6e/0b4/554/d6e0b4554b2d543ca71a394156c386b1.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n \mkern 2mu log_e \mkern 5mu (1+e^{-y_i\vec{w}^T\vec{x_i}}) \rightarrow min$" data-tex="display"/></p></li>
</ol><a name="habracut"></a><br/>
Статья изобилует простыми примерами, в которых все расчеты легко произвести устно или на бумаге, в некоторых случаях может потребоваться калькулятор. Так что подготовьтесь :)<br/>
<br/>
Данная статья в большей мере рассчитана на датасайнтистов с начальным уровнем познаний в основах машинного обучения.<br/>
<br/>
В статье также будет приведен код для отрисовки графиков и расчетов. Весь код написан на языке <i>python 2.7</i>. Заранее поясню о «новизне» используемой версии — таково одно из условий прохождения известного курса от <i>Яндекса</i> на не менее известной интернет-площадке онлайн образования <i>Coursera</i>, и, как можно предположить, материал подготовлен по мотивам этого курса.<br/>
<br/>
<h2>01. Прямолинейная зависимость</h2><br/>
Вполне резонно задать вопрос — причем здесь прямолинейная зависимость и логистическая регрессия?<br/>
<br/>
Все просто! Логистическая регрессия представляет собой одну из моделей, которые относятся к линейному классификатору. Простыми словами, задачей линейного классификатора является предсказание целевых значений <img src="https://habrastorage.org/getpro/habr/formulas/9b3/4c4/da5/9b34c4da5c757d4982bbd1b6f2e8998a.svg" alt="$y$" data-tex="inline"/> от переменных (регрессоров) <img src="https://habrastorage.org/getpro/habr/formulas/6d6/a4f/78f/6d6a4f78fbacd6edecc018ce8ad3e364.svg" alt="$X$" data-tex="inline"/>. При этом считается, что зависимость между признаками <img src="https://habrastorage.org/getpro/habr/formulas/6d6/a4f/78f/6d6a4f78fbacd6edecc018ce8ad3e364.svg" alt="$X$" data-tex="inline"/> и целевыми значениями <img src="https://habrastorage.org/getpro/habr/formulas/9b3/4c4/da5/9b34c4da5c757d4982bbd1b6f2e8998a.svg" alt="$y$" data-tex="inline"/> линейная. Отсюда собственно и название классификатора — линейный. Если очень грубо обобщить, то в основе модели логистической регрессии лежит предположение о наличии линейной зависимости между признаками <img src="https://habrastorage.org/getpro/habr/formulas/6d6/a4f/78f/6d6a4f78fbacd6edecc018ce8ad3e364.svg" alt="$X$" data-tex="inline"/> и целевыми значениями <img src="https://habrastorage.org/getpro/habr/formulas/9b3/4c4/da5/9b34c4da5c757d4982bbd1b6f2e8998a.svg" alt="$y$" data-tex="inline"/>. Вот она — связь.<br/>
<br/>
В студии первый пример, и он, правильно, о прямолинейной зависимости исследуемых величин. В процессе подготовки статьи наткнулся на пример, набивший уже многим оскомину — зависимость силы тока от напряжения <i>(«Прикладной регрессионный анализ», Н.Дрейпер, Г.Смит)</i>. Здесь мы его тоже рассмотрим. <br/>
<br/>
В соответствии с <i>законом Ома:</i><br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/c6e/9ce/6fa/c6e9ce6fa3ec33e39afdda03e5559c67.svg" alt="$I = U/R$" data-tex="inline"/>, где <img src="https://habrastorage.org/getpro/habr/formulas/64b/eb7/37a/64beb737a23fb5cb0a455f0e9213f2a4.svg" alt="$I$" data-tex="inline"/> — сила тока, <img src="https://habrastorage.org/getpro/habr/formulas/d07/cc5/b26/d07cc5b26db621faab45e0e0b54ede62.svg" alt="$U$" data-tex="inline"/> — напряжение, <img src="https://habrastorage.org/getpro/habr/formulas/b81/a7c/1e9/b81a7c1e9676b36cc02ddeea5d5f6e51.svg" alt="$R$" data-tex="inline"/> — сопротивление. <br/>
<br/>
Если бы мы не знали <i>закон Ома</i>, то могли бы найти зависимость эмпирически, изменяя <img src="https://habrastorage.org/getpro/habr/formulas/d07/cc5/b26/d07cc5b26db621faab45e0e0b54ede62.svg" alt="$U$" data-tex="inline"/> и измеряя <img src="https://habrastorage.org/getpro/habr/formulas/64b/eb7/37a/64beb737a23fb5cb0a455f0e9213f2a4.svg" alt="$I$" data-tex="inline"/>, поддерживая при этом <img src="https://habrastorage.org/getpro/habr/formulas/b81/a7c/1e9/b81a7c1e9676b36cc02ddeea5d5f6e51.svg" alt="$R$" data-tex="inline"/> фиксированным. Тогда мы бы увидели, что график зависимости <img src="https://habrastorage.org/getpro/habr/formulas/64b/eb7/37a/64beb737a23fb5cb0a455f0e9213f2a4.svg" alt="$I$" data-tex="inline"/> от <img src="https://habrastorage.org/getpro/habr/formulas/d07/cc5/b26/d07cc5b26db621faab45e0e0b54ede62.svg" alt="$U$" data-tex="inline"/> дает более или менее прямую линию, проходящую через начало координат. Мы сказали «более или менее», так как, хотя зависимость фактически точная, наши измерения могут содержать малые ошибки, и поэтому точки на графике, возможно не попадут строго на линию, а будут разбросаны вокруг нее случайным образом.<br/>
<br/>
График 1 «Зависимость <img src="https://habrastorage.org/getpro/habr/formulas/64b/eb7/37a/64beb737a23fb5cb0a455f0e9213f2a4.svg" alt="$I$" data-tex="inline"/> от <img src="https://habrastorage.org/getpro/habr/formulas/d07/cc5/b26/d07cc5b26db621faab45e0e0b54ede62.svg" alt="$U$" data-tex="inline"/>»<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/is/xw/0m/isxw0mnnbx1iowlms-cim4nekzs.jpeg" data-src="https://habrastorage.org/webt/is/xw/0m/isxw0mnnbx1iowlms-cim4nekzs.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код отрисовки графика</b>
                        <div class="spoiler_text"><pre><code class="python">import matplotlib.pyplot as plt
%matplotlib inline

import numpy as np

import random

R = 13.75

x_line = np.arange(0,220,1)
y_line = []
for i in x_line:
    y_line.append(i/R)
    
y_dot = []
for i in y_line:
    y_dot.append(i+random.uniform(-0.9,0.9))


fig, axes = plt.subplots(figsize = (14,6), dpi = 80)
plt.plot(x_line,y_line,color = 'purple',lw = 3, label = 'I = U/R')
plt.scatter(x_line,y_dot,color = 'red', label = 'Actual results')
plt.xlabel('I', size = 16)
plt.ylabel('U', size = 16)
plt.legend(prop = {'size': 14})
plt.show()</code></pre><br/>
</div>
                    </div><br/>
<h2>02. Необходимость преобразований уравнения линейной регрессии</h2><br/>
Рассмотрим очередной пример. Представим, что мы работаем в банке и перед нами задача определить вероятность возврата кредита заемщиком в зависимости от некоторых факторов. Для упрощения задачи, рассмотрим только два фактора: месячная зарплата заемщика и месячный размер платежа на погашение кредита. <br/>
<br/>
Задача очень условная, но на этом примере мы сможем понять, почему для ее решения недостаточно применения <i>функции линейной регрессии</i>, а также узнаем какие преобразования с функцией требуется провести.<br/>
<br/>
Возвращаемся к примеру. Понятно, что чем выше зарплата, тем больше заемщик сможет ежемесячно направлять на погашение кредита. При этом, для определенного диапазона зарплат эта зависимость будет вполне себе линейная. Например, возьмем диапазон зарплат от 60.000Р до 200.000Р и предположим, что в указанном диапазоне заработных плат, зависимость размера ежемесячного платежа от размера заработной платы — линейная. Допустим, для указанного диапазона размера заработных плат было выявлено, что соотношение зарплаты к платежу не может опускаться ниже 3 и еще у заемщика должно оставаться в запасе 5.000Р. И только в таком случае, мы будем считать, что заемщик вернет кредит банку. Тогда, уравнение линейной регрессии примет вид:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/bc0/520/56d/bc052056d1d8b3737378422e61c0b96a.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}, $" data-tex="inline"/><br/>
<br/>
где <img src="https://habrastorage.org/getpro/habr/formulas/1d6/fc6/8e9/1d6fc68e93e5b2fb640d3c5ba30838b4.svg" alt="$w_0 = -5.000$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/b9a/683/b5b/b9a683b5bb695de57126e5db4ebb7436.svg" alt="$w_1 = 1$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/4d5/24b/21f/4d524b21f2020047e2d340a59f17ccba.svg" alt="$w_2 = -3$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/0df/530/fff/0df530ffff8762f5174e6539bc64ddc4.svg" alt="$x_{i1}$" data-tex="inline"/> — <i>зарплата</i> <img src="https://habrastorage.org/getpro/habr/formulas/bf8/3b5/32c/bf83b532cd867d34004f8eded8c5c79a.svg" alt="$i$" data-tex="inline"/>-го заемщика, <img src="https://habrastorage.org/getpro/habr/formulas/941/d95/780/941d95780d8800fd32e758b586120101.svg" alt="$x_{i2}$" data-tex="inline"/> — <i>платеж по кредиту</i> <img src="https://habrastorage.org/getpro/habr/formulas/bf8/3b5/32c/bf83b532cd867d34004f8eded8c5c79a.svg" alt="$i$" data-tex="inline"/>-го заемщика. <br/>
<br/>
Подставляя в уравнение зарплату и платеж по кредиту с фиксированными параметрами <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> можно принять решение о выдаче или отказе кредита. <br/>
<br/>
Забегая вперед, отметим, что, при заданных параметрах <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> <i>функция линейной регрессии</i>, применяемая в <i>функции логистичиеского отклика</i> будет выдавать большие значения, которые затруднят проведение расчетов по определению вероятностей погашения кредита. Поэтому, предлагается уменьшить наши коэффициенты, скажем так, в 25.000 раз. От этого преобразования в коэффициентах, решение о выдачи кредита не изменится. Запомним этот момент на будущее, а сейчас чтобы было еще понятнее, о чем речь, рассмотрим ситуация с тремя потенциальными заемщиками.<br/>
<br/>
Таблица 1 «Потенциальные заемщики»<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/6u/mu/vk/6umuvkl-ulskbew1eptm9azq-ns.jpeg" data-src="https://habrastorage.org/webt/6u/mu/vk/6umuvkl-ulskbew1eptm9azq-ns.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для формирования таблицы</b>
                        <div class="spoiler_text"><pre><code class="python">import pandas as pd

r = 25000.0
w_0 = -5000.0/r
w_1 = 1.0/r
w_2 = -3.0/r

data = {'The borrower':np.array(['Vasya', 'Fedya', 'Lesha']), 
        'Salary':np.array([120000,180000,210000]),
       'Payment':np.array([3000,50000,70000])}

df = pd.DataFrame(data)

df['f(w,x)'] = w_0 + df['Salary']*w_1 + df['Payment']*w_2

decision = []
for i in df['f(w,x)']:
    if i > 0:
        dec = 'Approved'
        decision.append(dec)
    else:
        dec = 'Refusal'
        decision.append(dec)
        
df['Decision'] = decision

df[['The borrower', 'Salary', 'Payment', 'f(w,x)', 'Decision']]</code></pre><br/>
</div>
                    </div><br/>
В соответствии с данными таблицы, Вася при зарплате в 120.000Р хочет получить такой кредит, чтобы ежемесячного гасить его по 3.000Р. Нами было определено, что для одобрения кредита, размер заработной платы Васи должен превышать в три раза размер платежа, и чтобы еще оставалось 5.000Р. Этому требованию Вася удовлетворяет: <img src="https://habrastorage.org/getpro/habr/formulas/c8a/7a1/d6e/c8a7a1d6ed0bb61476e853b184c1ae34.svg" alt="$120.000-3 * 3.000-5.000 = 106.000$" data-tex="inline"/>. Остается даже 106.000Р. Несмотря на то, что при расчете <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/> мы уменьшили коэффициенты <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> в 25.000 раз, результат получили тот же — кредит может быть одобрен. Федя тоже получит кредит, а вот Леше, несмотря на то, что он получает больше всех, придется поумерить свои аппетиты.<br/>
<br/>
Нарисуем график по такому случаю.<br/>
<br/>
График 2 «Классификация заемщиков»<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/d5/mt/vp/d5mtvp3cdodptyrglkqkjumcz4c.jpeg" data-src="https://habrastorage.org/webt/d5/mt/vp/d5mtvp3cdodptyrglkqkjumcz4c.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для отрисовки графика</b>
                        <div class="spoiler_text"><pre><code class="python">salary = np.arange(60000,240000,20000)
payment = (-w_0-w_1*salary)/w_2


fig, axes = plt.subplots(figsize = (14,6), dpi = 80)
plt.plot(salary, payment, color = 'grey', lw = 2, label = '$f(w,x_i)=w_0 + w_1x_{i1} + w_2x_{i2}$')
plt.plot(df[df['Decision'] == 'Approved']['Salary'], df[df['Decision'] == 'Approved']['Payment'], 
         'o', color ='green', markersize = 12, label = 'Decision - Loan approved')
plt.plot(df[df['Decision'] == 'Refusal']['Salary'], df[df['Decision'] == 'Refusal']['Payment'], 
         's', color = 'red', markersize = 12, label = 'Decision - Loan refusal')
plt.xlabel('Salary', size = 16)
plt.ylabel('Payment', size = 16)
plt.legend(prop = {'size': 14})
plt.show()</code></pre><br/>
</div>
                    </div><br/>
Итак, наша прямая, построенная в соответствии с функцией <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/>, отделяет «плохих» заемщиков от «хороших». Те заемщики, у кого желания не совпадают с возможностями находятся выше прямой (Леша), те же, кто способен согласно параметрам нашей модели, вернуть кредит, находятся под прямой (Вася и Федя). Иначе можно сказать так — наша прямая разделяет заемщиков на два класса. Обозначим их следующим образом: к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> отнесем тех заемщиков, которые скорее всего вернут кредит, к классу <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> отнесем тех заемщиков, которые скорее всего не смогут вернуть кредит. <br/>
<br/>
Обобщим выводы из этого простенького примера. Возьмем точку <img src="https://habrastorage.org/getpro/habr/formulas/83a/09b/484/83a09b484baf09b29374b626743ee4de.svg" alt="$M(x_1,x_2)$" data-tex="inline"/> и, подставляя координаты точки в соответствующее уравнение прямой <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/>, рассмотрим три варианта:<br/>
<br/>
<ol>
<li>Если точка находится под прямой, и мы относим ее к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>, то значение функции <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/> будет положительным от <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/b0b/232/f34/b0b232f343595119559cf1186dd5f4a7.svg" alt="$+\infty$" data-tex="inline"/>. Значит мы можем считать, что вероятность погашения кредита, находится в пределах <img src="https://habrastorage.org/getpro/habr/formulas/e52/d01/8f8/e52d018f87e1844bc2e714af79f0cdf0.svg" alt="$(0.5,1]$" data-tex="inline"/>. Чем больше значение функции, тем выше вероятность.</li>
<li>Если точка находится над прямой и мы относим ее к классу <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/>, то значение функции будет отрицательным от <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/d6d/1e2/ab7/d6d1e2ab791a06785be738fe3a3a4f9d.svg" alt="$-\infty$" data-tex="inline"/>. Тогда мы будем считать, что вероятность погашения задолженности находится в пределах <img src="https://habrastorage.org/getpro/habr/formulas/d11/82d/cbe/d1182dcbec38620f7bdfad6d7a8529ab.svg" alt="$[0,0.5)$" data-tex="inline"/> и, чем больше по модулю значение функции, тем выше наша уверенность.</li>
<li>Точка находится на прямой, на границе между двумя классами. В таком случае значение функции <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/> будет равно <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> и вероятность погашения кредита равна <img src="https://habrastorage.org/getpro/habr/formulas/f68/2d0/19e/f682d019e8fd1f11da97e75f9863c232.svg" alt="$0.5$" data-tex="inline"/>.</li>
</ol><br/>
Теперь, представим, что у нас не два фактора, а десятки, заемщиков не три, а тысячи. Тогда вместо прямой у нас будет <i>m-мерная</i> плоскость и коэффициенты <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/> у нас будут взяты не с потолка, а выведены по всем правилам, да на основе накопленных данных о заемщиках, вернувших или не вернувших кредит. И действительно, заметьте, мы сейчас отбираем заемщиков при уже известных коэффициентах <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>. На самом же деле, задача модели логистической регрессии как раз и состоит в том, чтобы определить параметры <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>, при которых значение функции потерь <i>Logistic Loss</i> будет стремиться к минимальному. Но о том, как рассчитывается вектор <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>, мы еще узнаем в 5-м разделе статьи. А пока возвращаемся на землю обетованную — к нашему банкиру и трем его клиентам.<br/>
<br/>
Благодаря функции <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/> мы знаем кому можно дать кредит, а кому нужно отказать. Но с такой информацией к директору идти нельзя, ведь от нас хотели получить вероятность возврата кредита каждым заемщиком. Что делать? Ответ простой — нам нужно как-то преобразовать функцию <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/>, значения которой лежат в диапазоне <img src="https://habrastorage.org/getpro/habr/formulas/80b/03c/cfd/80b03ccfdd0e8cb84e222715755ccf26.svg" alt="$(-\infty,+\infty)$" data-tex="inline"/> на функцию, значения которой будут лежать в диапазоне <img src="https://habrastorage.org/getpro/habr/formulas/a5d/538/f83/a5d538f83bd73f9d1c9e8338db9a398a.svg" alt="$[0,1]$" data-tex="inline"/>. И такая функция существует, ее называют <i>функцией логистического отклика или обратного-логит преобразования</i>. Знакомьтесь: <br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/e80/d81/93d/e80d8193d49469dee69b5a8c4bf8b6ec.svg" alt="$\sigma(\vec{w}^T \vec{x_i}) = \frac{1}{1+e^{-\vec{w}^T \vec{x_i}}}$" data-tex="display"/></p><br/>
Посмотрим по шагам как получается <i>функция логистического отклика</i>. Отметим, что шагать мы будем в обратную сторону, т.е. мы предположим, что нам известно значение вероятности, которое лежит в пределах от <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/> и далее мы будем «раскручивать» это значение на всю область чисел от <img src="https://habrastorage.org/getpro/habr/formulas/d6d/1e2/ab7/d6d1e2ab791a06785be738fe3a3a4f9d.svg" alt="$-\infty$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/b0b/232/f34/b0b232f343595119559cf1186dd5f4a7.svg" alt="$+\infty$" data-tex="inline"/>.<br/>
<br/>
<h2>03. Выводим функцию логистического отклика</h2><br/>
<h3>Шаг 1. Переведем значения вероятности в диапазон <img src="https://habrastorage.org/getpro/habr/formulas/1f1/806/caa/1f1806caa396ad814c5cbae44638a38f.svg" alt="$[0,+\infty)$" data-tex="inline"/></h3><br/>
<br/>
На время трансформации функции <img src="https://habrastorage.org/getpro/habr/formulas/77c/86b/417/77c86b4173bc0406c4de95039461df33.svg" alt="$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$" data-tex="inline"/> в <i><i>функцию логистического отклика</i></i> <img src="https://habrastorage.org/getpro/habr/formulas/3d4/4dd/ae7/3d44ddae7c3d13b9dd873c4a1e09491b.svg" alt="$\sigma(\vec{w}^T \vec{x_i}) = \frac{1}{1+e^{\vec{w}^T \vec{x_i}}}$" data-tex="inline"/> мы оставим в покое нашего кредитного аналитика, а вместо этого пройдемся по букмекерским конторам. Нет, конечно, ставки делать мы не будем, все что нас там интересует, так это смысл выражения, например, шанс 4 к 1. Шансы, знакомые всем делающим ставки игрокам, являются соотношением «успехов» к «неуспехам». С точки зрения вероятностей, шансы — это вероятность наступления события, деленная на вероятность того, что событие не произойдет. Запишем формулу шанса наступления события <img src="https://habrastorage.org/getpro/habr/formulas/91c/34b/351/91c34b351d7bb8df08e960b4cdc79b16.svg" alt="$(odds_+)$" data-tex="inline"/>:<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/53f/440/8d3/53f4408d3030531b75daef03c76269a0.svg" alt="$odds_+ = \frac{p_+}{1-p_+}$" data-tex="display"/></p><br/>
, где <img src="https://habrastorage.org/getpro/habr/formulas/cc6/f03/35e/cc6f0335e61e908711d629714f8d8b9e.svg" alt="$p_+$" data-tex="inline"/> — вероятность наступления события, <img src="https://habrastorage.org/getpro/habr/formulas/f5c/dcd/662/f5cdcd662a6590cdf971e57494ad123e.svg" alt="$(1-p_+)$" data-tex="inline"/> — вероятность НЕ наступления события<br/>
<br/>
Например, если вероятность того, что молодой, сильный и резвый конь по прозвищу «Ветерок» обойдет на скачках старую и дряблую старушку по кличке «Матильда» равняется <img src="https://habrastorage.org/getpro/habr/formulas/ca8/978/ec5/ca8978ec597af63524046a377099d3e3.svg" alt="$0.8$" data-tex="inline"/>, то шансы на успех «Ветерка» составят <img src="https://habrastorage.org/getpro/habr/formulas/578/281/d89/578281d8997e0a562a02dd61422d408e.svg" alt="$4$" data-tex="inline"/> к <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/> <img src="https://habrastorage.org/getpro/habr/formulas/c61/27e/d7b/c6127ed7b7116b2c9a29e8e238568254.svg" alt="$(0.8/(1-0.8))$" data-tex="inline"/> и наоборот, зная шансы, нам не составит труда вычислить вероятность <img src="https://habrastorage.org/getpro/habr/formulas/cc6/f03/35e/cc6f0335e61e908711d629714f8d8b9e.svg" alt="$p_+$" data-tex="inline"/>:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/e94/750/131/e9475013121faba30996b549a41012e4.svg" alt="$\frac{p_+}{1-p_+} = 4 \mkern 15mu \Longrightarrow \mkern 15mu p_+=4(1-p_+) \mkern 15mu \Longrightarrow \mkern 15mu 5p_+=4 \mkern 15mu \Longrightarrow \mkern 15mu p_+=0.8 $" data-tex="inline"/><br/>
<br/>
Таким образом, мы научились «переводить» вероятность в шансы, которые принимают значения от <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/b0b/232/f34/b0b232f343595119559cf1186dd5f4a7.svg" alt="$+\infty$" data-tex="inline"/>. Сделаем еще один шаг и научимся «переводить» вероятность на всю числовую прямую от <img src="https://habrastorage.org/getpro/habr/formulas/d6d/1e2/ab7/d6d1e2ab791a06785be738fe3a3a4f9d.svg" alt="$-\infty$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/b0b/232/f34/b0b232f343595119559cf1186dd5f4a7.svg" alt="$+\infty$" data-tex="inline"/>.<br/>
<br/>
<h3>Шаг 2. Переведем значения вероятности в диапазон <img src="https://habrastorage.org/getpro/habr/formulas/80b/03c/cfd/80b03ccfdd0e8cb84e222715755ccf26.svg" alt="$(-\infty,+\infty)$" data-tex="inline"/></h3><br/>
Шаг этот очень простой — прологарифмируем шансы по основанию числа Эйлера <img src="https://habrastorage.org/getpro/habr/formulas/5ca/4b8/ca1/5ca4b8ca180f7495da819508f8afce6e.svg" alt="$e$" data-tex="inline"/> и получим:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/3b2/5f5/4ec/3b25f54ec24ac9790536a5bfcdb7dcbd.svg" alt="$f(w,x_i)=\vec{w}^T\vec{x}=ln(odds_+)$" data-tex="display"/></p><br/>
<br/>
Теперь мы знаем, что если <img src="https://habrastorage.org/getpro/habr/formulas/c7e/327/ed9/c7e327ed9d8fd93eb5907c962f2f0328.svg" alt="$p_+=0.8$" data-tex="inline"/>, то вычислить значение <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/> будет очень просто и, более того, оно должно быть положительным: <img src="https://habrastorage.org/getpro/habr/formulas/1d2/7d3/bdb/1d27d3bdb1b03bf2039cce88af50c550.svg" alt="$f(w,x_i)=ln(odds_+)=ln(0.8/0.2)=ln(4) \approx +1.38629$" data-tex="inline"/>. Так и есть.<br/>
<br/>
Ради любопытства проверим, что если <img src="https://habrastorage.org/getpro/habr/formulas/d2c/bf7/357/d2cbf7357ab08df200b02965bbb4ab7d.svg" alt="$p_+=0.2$" data-tex="inline"/>, тогда мы ожидаем увидеть отрицательное значение <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/>. Проверяем: <img src="https://habrastorage.org/getpro/habr/formulas/c6d/3a5/e80/c6d3a5e8054aff891d32c89f4ee0c644.svg" alt="$f(w,x_i)=ln(0.2/0.8)=ln(0.25) \approx -1.38629$" data-tex="inline"/>. Все верно.<br/>
<br/>
Теперь мы знаем как перевести значение вероятности от <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/> на всю числовую прямую от <img src="https://habrastorage.org/getpro/habr/formulas/d6d/1e2/ab7/d6d1e2ab791a06785be738fe3a3a4f9d.svg" alt="$-\infty$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/b0b/232/f34/b0b232f343595119559cf1186dd5f4a7.svg" alt="$+\infty$" data-tex="inline"/>. В следующем шаге сделаем все наоборот.<br/>
<br/>
А пока, отметим, что в соответствии с правилами логарифмирования, зная значение функции <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/>, можно вычислить шансы: <br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/833/9ae/0b9/8339ae0b9d7645bc12a507a4ac54cf5d.svg" alt="$odds_+ = e^{f(w,x_i)} = e^{\vec{w}^T\vec{x}}$" data-tex="display"/></p><br/>
<br/>
Этот способ определения шансов нам пригодится на следующем шаге.<br/>
<br/>
<h3>Шаг 3. Выведем формулу для определения <img src="https://habrastorage.org/getpro/habr/formulas/cc6/f03/35e/cc6f0335e61e908711d629714f8d8b9e.svg" alt="$p_+$" data-tex="inline"/></h3><br/>
Итак, мы научились, зная <img src="https://habrastorage.org/getpro/habr/formulas/cc6/f03/35e/cc6f0335e61e908711d629714f8d8b9e.svg" alt="$p_+$" data-tex="inline"/>, находить значения функции <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/>. Однако, на самом деле нам нужно все с точностью до наоборот — зная значение <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/> находить <img src="https://habrastorage.org/getpro/habr/formulas/cc6/f03/35e/cc6f0335e61e908711d629714f8d8b9e.svg" alt="$p_+$" data-tex="inline"/>. Для этого обратимся к такому понятию как обратная функция шансов, в соответствии с которой:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/998/ca3/299/998ca3299c7f4129d6975ea34d17809a.svg" alt="$p_+ = \frac{odds_+}{1+odds_+} $" data-tex="display"/></p><br/>
<br/>
В статье мы не будем выводить вышеобозначенную формулу, но проверим на цифрах из примера выше. Мы знаем, что при шансах равными 4 к 1 (<img src="https://habrastorage.org/getpro/habr/formulas/f0f/e94/423/f0fe944236e68f60b16034803d6f1823.svg" alt="$odds_+=4$" data-tex="inline"/>), вероятность наступления события равна 0.8 (<img src="https://habrastorage.org/getpro/habr/formulas/c7e/327/ed9/c7e327ed9d8fd93eb5907c962f2f0328.svg" alt="$p_+=0.8$" data-tex="inline"/>). Сделаем подстановку: <img src="https://habrastorage.org/getpro/habr/formulas/84e/9ac/43b/84e9ac43b312c23b9b1f4df072eef404.svg" alt="$p_+=\frac{4}{1+4}=0.8$" data-tex="inline"/>. Это совпадает с нашими вычислениями, проведенными ранее. Двигаемся далее.<br/>
<br/>
На прошлом шаге мы вывели, что <img src="https://habrastorage.org/getpro/habr/formulas/8a4/3e6/be5/8a43e6be57441a31f74f074ea308af36.svg" alt="$odds_+ = e^{\vec{w}^T\vec{x}}$" data-tex="inline"/>, а значит можно сделать замену в обратной функции шансов. Получим:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/a63/d3d/38a/a63d3d38ab1e837cefce61df83c7462e.svg" alt="$p_+ = \frac{e^{\vec{w}^T\vec{x}}}{1+e^{\vec{w}^T\vec{x}}}$" data-tex="display"/></p><br/>
<br/>
Разделим и числитель и знаменатель на <img src="https://habrastorage.org/getpro/habr/formulas/581/dfc/94f/581dfc94f691212b843d5ca4ceb6cd9e.svg" alt="$e^{\vec{w}^T\vec{x}}$" data-tex="inline"/>, тогда:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/6c6/dea/0d6/6c6dea0d6895ca8fd36155c626096403.svg" alt="$p_+ = \frac{1}{1+e^{-\vec{w}^T\vec{x}}} = \sigma(\vec{w}^T\vec{x})$" data-tex="display"/></p><br/>
<br/>
На всякий пожарный, дабы убедиться, что мы нигде не ошиблись, сделаем еще одну небольшую проверку. На шаге 2, мы для <img src="https://habrastorage.org/getpro/habr/formulas/c7e/327/ed9/c7e327ed9d8fd93eb5907c962f2f0328.svg" alt="$p_+=0.8$" data-tex="inline"/> определили, что <img src="https://habrastorage.org/getpro/habr/formulas/a12/825/840/a128258409b83f835e4ec02da427bfcf.svg" alt="$f(w,x_i) \approx +1.38629$" data-tex="inline"/>. Тогда, подставив значение <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/> в функцию логистического отклика, мы ожидаем получить <img src="https://habrastorage.org/getpro/habr/formulas/c7e/327/ed9/c7e327ed9d8fd93eb5907c962f2f0328.svg" alt="$p_+=0.8$" data-tex="inline"/>. Подставляем и получаем: <img src="https://habrastorage.org/getpro/habr/formulas/c25/62f/5ef/c2562f5ef0d27f9097183c0938c48b52.svg" alt="$p_+=\frac{1}{1+e^{-1.38629}}=0.8$" data-tex="inline"/><br/>
<br/>
Поздравляю вас, уважаемый читатель, мы только что вывели и протестировали функцию логистического отклика. Давайте посмотрим на график функции.<br/>
<br/>
График 3 «Функция логистического отклика»<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/ks/by/4c/ksby4cvyvhchnyw3g7mogrucage.jpeg" data-src="https://habrastorage.org/webt/ks/by/4c/ksby4cvyvhchnyw3g7mogrucage.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для отрисовки графика</b>
                        <div class="spoiler_text"><pre><code class="python">import math

def logit (f):
    return 1/(1+math.exp(-f))

f = np.arange(-7,7,0.05)
p = []

for i in f:
    p.append(logit(i))

fig, axes = plt.subplots(figsize = (14,6), dpi = 80)
plt.plot(f, p, color = 'grey', label = '$ 1 / (1+e^{-w^Tx_i})$')
plt.xlabel('$f(w,x_i) = w^Tx_i$', size = 16)
plt.ylabel('$p_{i+}$', size = 16)
plt.legend(prop = {'size': 14})
plt.show()</code></pre><br/>
</div>
                    </div><br/>
В литературе также можно встретить название данной функции как <i>сигмоид-функция</i>. По графику хорошо заметно, что основное изменение вероятности принадлежности объекта к классу происходит на относительно небольшом диапазоне <img src="https://habrastorage.org/getpro/habr/formulas/4a9/d9b/7c3/4a9d9b7c3a796b664147c4267469a945.svg" alt="$f(w,x_i)$" data-tex="inline"/>, где-то от <img src="https://habrastorage.org/getpro/habr/formulas/712/33f/9da/71233f9da088a69f4f80e0a824f0bd91.svg" alt="$-4$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/4c0/d80/e6b/4c0d80e6b4c4049ac52c22fd0d27637e.svg" alt="$+4$" data-tex="inline"/>.<br/>
<br/>
Предлагаю вернуться к нашему кредитному аналитику и помочь ему с вычислением вероятности погашения кредитов, иначе он рискует остаться без премии :)<br/>
<br/>
Таблица 2 «Потенциальные заемщики»<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/10/tg/7r/10tg7rztpblsl8swwgjzmlgtwlo.jpeg" data-src="https://habrastorage.org/webt/10/tg/7r/10tg7rztpblsl8swwgjzmlgtwlo.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для формирования таблицы</b>
                        <div class="spoiler_text"><pre><code class="python">proba = []
for i in df['f(w,x)']:
    proba.append(round(logit(i),2))
    
df['Probability'] = proba

df[['The borrower', 'Salary', 'Payment', 'f(w,x)', 'Decision', 'Probability']]</code></pre><br/>
</div>
                    </div><br/>
Итак, вероятность возврата кредита мы определили. В целом, это похоже на правду. <br/>
<br/>
Действительно, вероятность того что Вася при зарплате в 120.000Р сможет ежемесячно отдавать в банк 3.000Р близка к 100%. Кстати, мы должны понимать, что банк может выдать кредит и Леше в том случае, если политикой банка предусмотрено, например, кредитовать клиентов с вероятностью возврата кредита более, ну скажем, 0.3. Просто в таком случае банк сформирует больший резерв под возможные потери.<br/>
<br/>
Также следует отметить, что соотношение зарплаты к платежу не менее 3 и с запасом в 5.000Р было взято с потолка. Поэтому нам нельзя было использовать в первоначальном виде вектор весов <img src="https://habrastorage.org/getpro/habr/formulas/efe/096/7c6/efe0967c69a87a9a7f693fd242b72387.svg" alt="$\vec w = (-5000,1,-3)$" data-tex="inline"/>. Нам требовалось сильно уменьшить коэффициенты и в таком случае мы разделили каждый коэффициент на 25.000, то есть по сути мы подогнали результат. Но это сделано было специально, чтобы упростить понимание материала на начальном этапе. В жизни, же нам потребуется не выдумывать и подгонять коэффициенты, а находить их. Как раз в следующих разделах статьи мы выведем уравнения, с помощью которых подбираются параметры <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>.<br/>
<br/>
<h2>04. Метод наименьших квадратов при определении вектора весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> в функции логистического отклика</h2><br/>
Нам уже известен такой метод подбора вектора весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>, как <i>метод наименьших квадратов (МНК)</i> и собственно, почему бы нам тогда не использовать его в задачах бинарной классификации? Действительно, ничто не мешает использовать <i>МНК</i>, только вот данный способ в задачах классификации дает результаты менее точные, нежели <i>Logistic Loss</i>. Этому есть теоретическое обоснование. Давайте для начала посмотрим на один простой пример.<br/>
<br/>
Предположим, что наши модели (использующие <i>MSE</i> и <i>Logistic Loss</i>) уже начали подбор вектора весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> и мы остановили расчет на каком-то шаге. Неважно, в середине, в конце или в начале, главное, что у нас уже есть какие-то значения вектора весов и допустим, что на этом шаге, вектора весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/> для обеих моделей не имеют различий. Тогда возьмем полученные веса и подставим их в <i>функцию логистического отклика</i> (<img src="https://habrastorage.org/getpro/habr/formulas/cd6/887/374/cd6887374d65ca7e0699f041a7654ae1.svg" alt="$\frac{1}{1+e^{-\vec{w}^T\vec{x}}}$" data-tex="inline"/>) для какого-нибудь объекта, который относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>. Исследуем два случая, когда в соответствии с подобранным вектором весов наша модель сильно ошибается и наоборот — модель сильно уверена в том, что объект относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>. Посмотрим какие штрафы будут «выписаны» при использовании <i>МНК </i>и <i>Logistic Loss</i>.<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для расчета штрафов в зависимости от используемой функции потерь</b>
                        <div class="spoiler_text"><pre><code class="python"># класс объекта
y = 1
# вероятность отнесения объекта к классу в соответствии с параметрами w
proba_1 = 0.01

MSE_1 = (y - proba_1)**2
print 'Штраф MSE при грубой ошибке =', MSE_1

# напишем функцию для вычисления f(w,x) при известной вероятности отнесения объекта к классу +1 (f(w,x)=ln(odds+))
def f_w_x(proba):
    return math.log(proba/(1-proba)) 

LogLoss_1 = math.log(1+math.exp(-y*f_w_x(proba_1)))
print 'Штраф Log Loss при грубой ошибке =', LogLoss_1

proba_2 = 0.99

MSE_2 = (y - proba_2)**2
LogLoss_2 = math.log(1+math.exp(-y*f_w_x(proba_2)))

print '**************************************************************'
print 'Штраф MSE при сильной уверенности =', MSE_2
print 'Штраф Log Loss при сильной уверенности =', LogLoss_2</code></pre><br/>
</div>
                    </div><br/>
<b>Случай с грубой ошибкой</b> — модель относит объект к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> с вероятностью в 0,01<br/>
<br/>
Штраф при использовании <i>МНК </i>составит: <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/443/801/8cd/4438018cd3c35de475a419ecf521c389.svg" alt="$MSE = (y - p_+) = (1-0.01)^2 = 0.9801$" data-tex="inline"/><br/>
<br/>
Штраф при использовании <i>Logistic Loss</i> составит: <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/5c8/4b2/2b7/5c84b22b7edd29e66fd652a658254ec0.svg" alt="$Log Loss = log_e(1+e^{-yf(w,x)}) = log_e(1+e^{-1(-4.595...)}) \approx 4.605$" data-tex="inline"/><br/>
<br/>
<b>Случай с сильной уверенностью</b> — модель относит объект к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> с вероятностью в 0,99<br/>
<br/>
Штраф при использовании <i>МНК</i> составит: <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/818/0dc/f31/8180dcf31c8787d11205a3b3536e2900.svg" alt="$MSE = (1-0.99)^2 = 0.0001$" data-tex="inline"/><br/>
<br/>
Штраф при использовании <i>Logistic Loss</i> составит: <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/005/ad0/d51/005ad0d512f20ff825d820bdbd26ba7f.svg" alt="$Log Loss = log_e(1+e^{-4.595...}) \approx 0.01 $" data-tex="inline"/><br/>
<br/>
Этот пример хорошо иллюстрирует, что при грубой ошибке функция потерь <i>Log Loss</i> штрафует модель значительно сильнее, чем <i>MSE</i>. Давайте теперь разберемся, каковы теоретические предпосылки использования функции потерь <i>Log Loss</i> в задачах классификации.<br/>
<br/>
<h2>05. Метод максимального правдоподобия и логистическая регрессия</h2><br/>
Как и было обещано в начале, статья изобилует простыми примерами. В студии очередной пример и старые гости — заемщики банка: Вася, Федя и Леша. <br/>
<br/>
На всякий пожарный, перед тем как развивать пример, напомню, что в жизни мы имеем дело с обучающей выборкой из тысяч или миллионов объектов с десятками или сотнями признаков. Однако здесь цифры взяты так, чтобы они легко укладывались в голове начинающего датасайнтеста. <br/>
<br/>
Возвращаемся к примеру. Представим, что директор банка решил выдать кредит всем нуждающимся, несмотря на то, что алгоритм подсказывал не выдавать его Леше. И вот прошло достаточно времени и нам стало известно кто из трех героев погасил кредит, а кто нет. Что и следовало ожидать: Вася и Федя погасили кредит, а Леша — нет. Теперь давайте представим, что этот результат будет для нас новой обучающей выборкой и, при этом у нас как будто исчезли все данные о факторах, влияющих на вероятность погашения кредита (зарплата заемщика, размер ежемесячного платежа). Тогда интуитивно мы можем полагать, что каждый третий заемщик не возвращает банку кредит или другими словами вероятность возврата кредита следующим заемщиком <img src="https://habrastorage.org/getpro/habr/formulas/e64/afb/a2b/e64afba2b591c3b84beebfc496e12c51.svg" alt="$p=\frac{2}{3}$" data-tex="inline"/>. Этому интуитивному предположению есть теоретическое подтверждение и основывается оно на <i>методе максимального правдоподобия</i>, часто в литературе его называют <i>принципом максимального правдоподобия</i>.<br/>
<br/>
Для начала познакомимся с понятийным аппаратом.<br/>
<br/>
<i>Правдоподобие выборки</i> — это вероятность получения именно такой выборки, получения именно таких наблюдений / результатов, т.е. произведение вероятностей получения каждого из результатов выборки (например, погашен или не погашен кредит Васей, Федей и Лешей одновременно). <br/>
<br/>
<i>Функция правдоподобия</i> связывает правдоподобие выборки со значениями параметров распределения. <br/>
<br/>
В нашем случае, обучающая выборка представляет собой обобщённую схему Бернулли, в которой случайная величина принимает всего два значения: <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/>. Следовательно, правдоподобие выборки можно записать как функцию правдоподобия от параметра <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> следующим образом:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/d0b/857/b4e/d0b857b4ee991737b3ec7dbd1407cacb.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) = \prod\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)} \mkern 5mu = \mkern 5mu p^1(1-p)^{1-1} \centerdot p^1(1-p)^{1-1} \centerdot p^0(1-p)^{1-0} \mkern 5mu = $" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/edf/fd0/f08/edffd0f0825aef6a235b500fb1b87584.svg" alt="$ = \mkern 5mu p \centerdot p \centerdot (1-p) \mkern 5mu = \mkern 5mu p^2(1-p)$" data-tex="inline"/><br/>
<br/>
Вышеуказанную запись можно интерпретировать так. Совместная вероятность того, что Вася и Федя погасят кредит равна <img src="https://habrastorage.org/getpro/habr/formulas/ad1/c0a/9f6/ad1c0a9f6ac079079f55104222ff7a13.svg" alt="$p \centerdot p = p^2$" data-tex="inline"/>, вероятность того что Леша НЕ погасит кредит равна <img src="https://habrastorage.org/getpro/habr/formulas/d47/c89/4c4/d47c894c4276b3f3b8b5fe9158ab0cfe.svg" alt="$1-p$" data-tex="inline"/> (так как имело место именно НЕ погашение кредита), следовательно совместная вероятность всех трех событий равна <img src="https://habrastorage.org/getpro/habr/formulas/daf/63d/647/daf63d6479f73e4d3402348866d62dbf.svg" alt="$p^2(1-p)$" data-tex="inline"/>.<br/>
<br/>
<i>Метод максимального правдоподобия</i> — это метод оценки неизвестного параметра путём максимизации <i>функции правдоподобия</i>. В нашем случае требуется найти такое значение <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>, при котором <img src="https://habrastorage.org/getpro/habr/formulas/fb3/a6d/4e4/fb3a6d4e4b9ab34c577d6e5ddc7cb395.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) = p^2(1-p)$" data-tex="inline"/> достигает максимума. <br/>
<br/>
Откуда собственно идея – искать значение неизвестного параметра, при котором функция правдоподобия достигает максимума? Истоки идеи проистекают из представления о том, что выборка – это единственный, доступный нам, источник знания о генеральной совокупности. Все, что нам известно о генеральной совокупности, представлено в выборке. Поэтому, все, что мы можем сказать, так это то, что выборка – это наиболее точное отражение генеральной совокупности, доступное нам. Следовательно, нам требуется найти такой параметр, при котором имеющаяся выборка становится наиболее вероятной.<br/>
<br/>
Очевидно, мы имеем дело с оптимизационной задачей, в которой требуется найти точку экстремума функции. Для нахождения точки экстремума необходимо рассмотреть условие первого порядка, то есть приравнять производную функции к нулю и решить уравнение относительно искомого параметра. Однако поиски производной произведения большого количества множителей могут оказаться делом затяжным, чтобы этого избежать существует специальный прием — переход к логарифму <i>функции правдоподобия</i>. Почему возможен такой переход? Обратим внимание на то, что мы ищем не сам экстремум функции<img src="https://habrastorage.org/getpro/habr/formulas/f8a/1c5/0ed/f8a1c50ed39505a982ca83ce75812904.svg" alt="$ P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p)$" data-tex="inline"/>, а точку экстремума, то есть то значение неизвестного параметра <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>, при котором <img src="https://habrastorage.org/getpro/habr/formulas/f8a/1c5/0ed/f8a1c50ed39505a982ca83ce75812904.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p)$" data-tex="inline"/> достигает максимума. При переходе к логарифму точка экстремума не меняется (хотя сам экстремум будет отличаться), так как логарифм — монотонная функция.<br/>
<br/>
Давайте, в соответствии с вышеизложенным, продолжим развивать наш пример с кредитами у Васи, Феди и Леши. Для начала перейдем к <i>логарифму функции правдоподобия</i>:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/f8e/ca7/d90/f8eca7d90ef3968c1680a1be4dc64103.svg" alt="$logP(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) \mkern 5mu = \mkern 5mu logp^2(1-p) \mkern 5mu = \mkern 5mu 2logp + log(1-p)$" data-tex="inline"/><br/>
<br/>
Теперь мы можем с легкостью продифференцировать выражение по <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/139/181/ad0/139181ad0acdf2d6d84dcf662097019a.svg" alt="$\frac{\partial logP(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p)}{\partial p} \mkern 5mu = \mkern 5mu \frac{\partial}{\partial p} (2logp + log(1-p)) \mkern 5mu = \mkern 5mu \frac{2}{p} - \frac{1}{1-p}$" data-tex="inline"/><br/>
<br/>
И наконец, рассмотрим условие первого порядка — приравняем производную функции к нулю:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/832/fa7/c30/832fa7c3084c0110a5e3d7621631a1fc.svg" alt="$\frac{2}{p} - \frac{1}{1-p} = 0 \mkern 5mu \Longrightarrow \mkern 5mu \frac{2}{p} = \frac{1}{1-p} \mkern 5mu \Longrightarrow \mkern 5mu 2(1-p) = p \mkern 5mu \Longrightarrow \mkern 5mu p = \frac{2}{3}$" data-tex="inline"/><br/>
<br/>
Таким образом, наша интуитивная оценка вероятности погашения кредита <img src="https://habrastorage.org/getpro/habr/formulas/e64/afb/a2b/e64afba2b591c3b84beebfc496e12c51.svg" alt="$p = \frac{2}{3}$" data-tex="inline"/> была теоретически обоснована.<br/>
<br/>
Отлично, но что нам теперь делать с такой информацией? Если мы будем считать, что каждый третий заемщик не вернет банку деньги, то последний неизбежно разорится. Так-то оно так, да только при оценке вероятности погашения кредита равной <img src="https://habrastorage.org/getpro/habr/formulas/919/a65/b66/919a65b6676bcd796279a8aac6163a7a.svg" alt="$\frac{2}{3}$" data-tex="inline"/> мы не учли факторы, влияющие на возврат кредита: заработная плата заемщика и размер ежемесячного платежа. Вспомним, что ранее мы рассчитали вероятность возврата кредита каждым клиентом с учетом этих самых факторов. Логично, что и вероятности у нас получились отличные от константы равной <img src="https://habrastorage.org/getpro/habr/formulas/919/a65/b66/919a65b6676bcd796279a8aac6163a7a.svg" alt="$\frac{2}{3}$" data-tex="inline"/>.<br/>
<br/>
Давайте определим правдоподобие выборок:<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Код для расчетов правдоподобий выборок</b>
                        <div class="spoiler_text"><pre><code class="python">from functools import reduce

def likelihood(y,p):
    line_true_proba = []
    for i in range(len(y)):
        ltp_i = p[i]**y[i]*(1-p[i])**(1-y[i])
        line_true_proba.append(ltp_i)
    likelihood = []
    return reduce(lambda a, b: a*b, line_true_proba)
        
    
y = [1.0,1.0,0.0]
p_log_response = df['Probability']
const = 2.0/3.0
p_const = [const, const, const]


print 'Правдоподобие выборки при константном значении p=2/3:', round(likelihood(y,p_const),3)

print '****************************************************************************************************'

print 'Правдоподобие выборки при расчетном значении p:', round(likelihood(y,p_log_response),3)</code></pre><br/>
</div>
                    </div><br/>
<i>Правдоподобие выборки при константном значении <img src="https://habrastorage.org/getpro/habr/formulas/e64/afb/a2b/e64afba2b591c3b84beebfc496e12c51.svg" alt="$p=\frac{2}{3}$" data-tex="inline"/>:</i><br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/e47/b36/a76/e47b36a76b99b13313aff0043d484c77.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) \mkern 5mu = \mkern 5mu p^2(1-p) \mkern 5mu = \mkern 5mu \frac{2}{3}^2(1-\frac{2}{3}) \mkern 5mu \approx \mkern 5mu 0.148 $" data-tex="inline"/><br/>
<br/>
<i>Правдоподобие выборки при расчете вероятности погашения кредита с учетом факторов <img src="https://habrastorage.org/getpro/habr/formulas/cca/29f/b6c/cca29fb6c52655a8f94f7bbe703f11c7.svg" alt="$\vec{x}$" data-tex="inline"/>:</i><br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/72f/090/8f0/72f0908f0f53ffc3a54f80d75d3fb568.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) = \prod\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)} \mkern 5mu = \mkern 5mu p_1^1(1-p_1)^{1-1} \centerdot p_2^1(1-p_2)^{1-1} \centerdot p_3^0(1-p_3)^{1-0} \mkern 5mu = $" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/27f/4f6/6c3/27f4f66c312aa01b7a3501d94baa0c49.svg" alt="$ = \mkern 5mu p_1 \centerdot p_2 \centerdot (1-p_3) \mkern 5mu = \mkern 5mu 0.99 \centerdot 0.73 \centerdot (1-0.45) \mkern 5mu \approx \mkern 5mu 0.397$" data-tex="inline"/><br/>
<br/>
Правдоподобие выборки с вероятностью, посчитанной в зависимости от факторов оказалось выше правдоподобия при константном значении вероятности. О чем это говорит? Это говорит о том, что знания о факторах позволили подобрать более точно вероятность погашения кредита для каждого клиента. Поэтому, при выдаче очередного кредита, правильнее будет использовать, предложенную в конце 3-го раздела статьи, модель оценки вероятности погашения задолженности. <br/>
<br/>
Но тогда, если нам требуется максимизировать <i>функцию правдоподобия выборки</i>, то почему бы не использовать какой-нибудь алгоритм, который будет выдавать вероятности для Васи, Феди и Леши, например, равными 0.99, 0.99 и 0.01 соответственно. Возможно такой алгоритм и хорошо себя проявит на обучающей выборке, так как приблизит значение правдоподобия выборки к <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/>, но, во-первых, у такого алгоритма будут, скорее всего трудности с обобщающей способностью, во-вторых, этот алгоритм будет точно не линейным. И если, методы борьбы с переобучением (равно слабая обобщающая способность) явно не входят в план этой статьи, то по второму пункту давайте пройдемся подробнее. Для этого, достаточно ответить на простой вопрос. Может ли вероятность погашения кредита Васей и Федей быть одинаковой с учетом известных нам факторов? С точки зрения здравой логики конечно же нет, не может. Так на погашение кредита Вася будет отдавать 2.5% своей зарплаты в месяц, а Федя — почти 27,8%. Также на графике 2 «Классификация клиентов» мы видим, что Вася находится значительно дальше от линии, разделяющей классы, чем Федя. Ну и наконец, мы знаем, что функция <img src="https://habrastorage.org/getpro/habr/formulas/ee0/c6f/fe8/ee0c6ffe8a8600fd1cbf065d96aef5ee.svg" alt="$f(w,x) = w_0 + w_1x_1 + w_2x_2$" data-tex="inline"/> для Васи и Феди принимает различные значения: 4.24 для Васи и 1.0 для Феди. Вот если бы Федя, например, зарабатывал на порядок больше или кредит поменьше просил, то тогда вероятности погашения кредита у Васи и Феди были бы схожими. Другими словами, линейную зависимость не обманешь. И если бы мы действительно рассчитали коэффициенты <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>, а не взяли их с потолка, то могли бы смело заявить, что наши значения <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/> лучше всего позволяют оценить вероятность погашения кредита каждым заемщиком, но так как мы условились считать, что определение коэффициентов <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/> было проведено по всем правилам, то мы так и будем считать — наши коэффициенты позволяют дать лучшую оценку вероятности :)<br/>
<br/>
Однако мы отвлеклись. В этом разделе нам надо разобраться как определяется вектор весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>, который необходим для оценки вероятности возврата кредита каждым заемщиком. <br/>
<br/>
Кратко резюмируем, с каким арсеналом мы выступаем на поиски коэффициентов <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>:<br/>
<br/>
1. Мы предполагаем, что зависимость между целевой переменной (прогнозным значением) и фактором, оказывающим влияние на результат — линейная. По этой причине применяется <i>функция линейной регрессии</i> вида <img src="https://habrastorage.org/getpro/habr/formulas/d9e/f57/1ce/d9ef571ce10aee3f03bdbda6593efa25.svg" alt="$f(w,x) = \vec{w}^TX$" data-tex="inline"/>, линия которого делит объекты (клиентов) на классы <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> (клиенты, способные погасить кредит и не способные). В нашем случае уравнение имеет вид <img src="https://habrastorage.org/getpro/habr/formulas/ee0/c6f/fe8/ee0c6ffe8a8600fd1cbf065d96aef5ee.svg" alt="$f(w,x) = w_0 + w_1x_1 + w_2x_2$" data-tex="inline"/>.<br/>
<br/>
2. Мы используем <i>функцию обратного логит-преобразования</i> вида <img src="https://habrastorage.org/getpro/habr/formulas/6c6/dea/0d6/6c6dea0d6895ca8fd36155c626096403.svg" alt="$p_+ = \frac{1}{1+e^{-\vec{w}^T\vec{x}}} = \sigma(\vec{w}^T\vec{x})$" data-tex="inline"/> для определения вероятности принадлежности объекта к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>.<br/>
<br/>
3. Мы рассматриваем нашу обучающую выборку как реализацию обобщенной <i>схемы Бернулли</i>, то есть для каждого объекта генерируется случайная величина, которая с вероятностью <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> (своей для каждого объекта) принимает значение 1 и с вероятностью <img src="https://habrastorage.org/getpro/habr/formulas/c60/0eb/78d/c600eb78d0627ef7e91964968ce726ab.svg" alt="$(1–p)$" data-tex="inline"/> – 0.<br/>
<br/>
4. Мы знаем, что нам требуется максимизировать <i>функцию правдоподобия выборки</i> с учетом принятых факторов для того, чтобы имеющаяся выборка стала наиболее правдоподобной. Другими словами, нам нужно подобрать такие параметры, при которых выборка будет наиболее правдоподобной. В нашем случае подбираемый параметр — это вероятность погашения кредита <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>, которая в свою очередь зависит от неизвестных коэффициентов <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>. Значит нам требуется найти такой вектор весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/>, при котором правдоподобие выборки будет максимальным.<br/>
<br/>
5. Мы знаем, что для максимизации <i>функции правдоподобия выборки</i> можно использовать <i>метод максимального правдоподобия</i>. И мы знаем все хитрые приемы для работы с этим методом.<br/>
<br/>
Вот такая многоходовочка получается :)<br/>
<br/>
А теперь вспомним, что в самом начале статьи мы хотели вывести два вида функции потерь <i>Logistic Loss</i> в зависимости от того как обозначаются классы объектов. Так повелось, что в задачах классификации с двумя классами, классы обозначают как <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/>. В зависимости от обозначения, на выходе будет соответствующая функция потерь.<br/>
<br/>
<h3>Случай 1. Классификация объектов на <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/></h3><br/>
Раннее, при определении правдоподобия выборки, в котором вероятность погашения задолженности заемщиком рассчитывалась исходя из факторов и заданных коэффициентов <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>, мы применили формулу:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/ff3/c27/3c6/ff3c273c683dbcd3c7b00d2a071d6a7c.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu p) = \prod\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)}$" data-tex="inline"/><br/>
<br/>
На самом деле <img src="https://habrastorage.org/getpro/habr/formulas/08b/a9c/561/08ba9c56140cf603308f9b84a26dc818.svg" alt="$p_i$" data-tex="inline"/> — это значение <i>функции логистического отклика</i> <img src="https://habrastorage.org/getpro/habr/formulas/6c6/dea/0d6/6c6dea0d6895ca8fd36155c626096403.svg" alt="$p_+ = \frac{1}{1+e^{-\vec{w}^T\vec{x}}} = \sigma(\vec{w}^T\vec{x})$" data-tex="inline"/> при заданном векторе весов <img src="https://habrastorage.org/getpro/habr/formulas/734/c62/0a1/734c620a1b0b841a33c195da2b9eea42.svg" alt="$\vec{w}$" data-tex="inline"/><br/>
<br/>
Тогда нам ничто не мешает записать функцию правдоподобия выборки так:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/d07/f1d/a80/d07f1da809e6567bb1d0c45ee267aef7.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu \sigma(\vec{w}^TX)) \mkern 5mu = \mkern 5mu \prod\limits_{i=1}^n \sigma(\vec{w}^T\vec{x_i})^{y_i} \mkern 10mu (1-\sigma(\vec{w}^T\vec{x_i})^{(1-y_i)} \mkern 10mu \rightarrow \mkern 10mu max$" data-tex="display"/></p><br/>
<br/>
Бывает так, что иногда, некоторым начинающим аналитикам сложно сходу понять, как эта функция работает. Давайте рассмотрим 4 коротких примера, которые все прояснят:<br/>
<br/>
<b>1. </b>Если <img src="https://habrastorage.org/getpro/habr/formulas/577/682/05c/57768205c03a5547a4d44277f9c9d441.svg" alt="$y_i = +1$" data-tex="inline"/> (т.е. в соответствии с обучающей выборкой объект относится к классу +1), а наш алгоритм <img src="https://habrastorage.org/getpro/habr/formulas/eb8/e5d/bae/eb8e5dbae515dac15b124967e822d9b9.svg" alt="$\sigma(\vec{w}^TX))$" data-tex="inline"/> определяет вероятность отнесения объекта к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> равной 0.9, то вот этот кусочек правдоподобия выборки будет рассчитываться так:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/50b/e11/495/50be114953cd6d5bc76bbb62189f8b1b.svg" alt="$0.9^1 \centerdot (1-0.9)^{(1-1)}= 0.9^1 \centerdot 0.1^0 = 0.9$" data-tex="inline"/><br/>
<br/>
<b>2.</b> Если <img src="https://habrastorage.org/getpro/habr/formulas/577/682/05c/57768205c03a5547a4d44277f9c9d441.svg" alt="$y_i = +1$" data-tex="inline"/>, а <img src="https://habrastorage.org/getpro/habr/formulas/f2d/4d0/64a/f2d4d064aa2bf94950efb5b08c371248.svg" alt="$\sigma(\vec{w}^TX)) = 0.1$" data-tex="inline"/>, то расчет будет таким:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/f5e/477/412/f5e477412164fb26f86f1919a3280d08.svg" alt="$0.1^1 \centerdot (1-0.1)^{(1-1)}= 0.1^1 \centerdot 0.9^0 = 0.1$" data-tex="inline"/><br/>
<br/>
<b>3. </b>Если <img src="https://habrastorage.org/getpro/habr/formulas/961/5a3/c22/9615a3c22f2f2616e78ffa70509cb3aa.svg" alt="$y_i = 0$" data-tex="inline"/>, а <img src="https://habrastorage.org/getpro/habr/formulas/f2d/4d0/64a/f2d4d064aa2bf94950efb5b08c371248.svg" alt="$\sigma(\vec{w}^TX)) = 0.1$" data-tex="inline"/>, то расчет будет таким:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/784/337/a20/784337a20607f4c11e39bdf873b1136a.svg" alt="$0.1^0 \centerdot (1-0.1)^{(1-0)}= 0.1^0 \centerdot 0.9^1 = 0.9$" data-tex="inline"/><br/>
<br/>
<b>4.</b> Если <img src="https://habrastorage.org/getpro/habr/formulas/961/5a3/c22/9615a3c22f2f2616e78ffa70509cb3aa.svg" alt="$y_i = 0$" data-tex="inline"/>, а <img src="https://habrastorage.org/getpro/habr/formulas/0cf/b19/be5/0cfb19be54f9e85b2b01e516230de60c.svg" alt="$\sigma(\vec{w}^TX)) = 0.9$" data-tex="inline"/>, то расчет будет таким:<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/b2d/f21/037/b2df210378053a29907debcb8e4594e9.svg" alt="$0.9^0 \centerdot (1-0.9)^{(1-0)}= 0.9^0 \centerdot 0.1^1 = 0.1$" data-tex="inline"/><br/>
<br/>
Очевидно, что функция правдоподобия будет максимизироваться в случаях 1 и 3 или в общем случае — при правильно отгаданных значениях вероятностей отнесения объекта к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>.<br/>
<br/>
В связи с тем, что при определении вероятности отнесения объекта к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> нам не известны только коэффициенты <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>, то мы их и будем искать. Как и говорилось выше, это задача оптимизации, в которой для начала нам требуется найти производную от функции правдоподобия по вектору весов <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>. Однако предварительно имеет смысл упростить себе задачу: производную будем искать от логарифма <i>функции правдоподобия</i>.<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/6cd/3e7/a4e/6cd3e7a4e1762efb4733a1ef7d0047de.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n(-y_i \mkern 2mu log_e \mkern 5mu \sigma(\vec{w}^T \vec{x_i}) - (1-y_i) \mkern 2mu log_e \mkern 5mu (1 - \sigma(\vec{w}^T \vec{x_i})) ) \rightarrow min$" data-tex="display"/></p><br/>
 <br/>
Почему после логарифмирования, в <i>функции логистической ошибки</i>, мы поменяли знак с <img src="https://habrastorage.org/getpro/habr/formulas/ae4/dc5/c6f/ae4dc5c6fd4ec28ba4b81a2ec09d88b9.svg" alt="$+$" data-tex="inline"/> на <img src="https://habrastorage.org/getpro/habr/formulas/d3d/f50/b83/d3df50b83f85c2e599b5a46b9d893c5e.svg" alt="$-$" data-tex="inline"/>. Все просто, так как в задачах оценки качества модели принято минимизировать значение функции, то мы умножили правую часть выражения на <img src="https://habrastorage.org/getpro/habr/formulas/d3d/f50/b83/d3df50b83f85c2e599b5a46b9d893c5e.svg" alt="$-$" data-tex="inline"/> и соответственно вместо максимизации, теперь минимизируем функцию.<br/>
<br/>
Собственно, сейчас, на ваших глазах была много страдальчески выведена функция потерь — <i>Logistic Loss</i> для обучающей выборки с двумя классами: <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/>.<br/>
<br/>
Теперь, для нахождения коэффициентов, нам потребуется всего лишь найти производную <i>функции логистической ошибки</i> и далее, используя численные методы оптимизации, такие как градиентный спуск или стохастический градиентный спуск, подобрать наиболее оптимальные коэффициенты <img src="https://habrastorage.org/getpro/habr/formulas/1d0/034/a09/1d0034a09108db7af7cf42ea23a91ecd.svg" alt="$w$" data-tex="inline"/>. Но, учитывая, уже не малый объем статьи, предлагается провести дифференцирование самостоятельно или, быть может, это будет темой для следующей статьи с большим количеством арифметики без столь подробных примеров.<br/>
<br/>
<h3>Случай 2. Классификация объектов на <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/></h3><br/>
Подход здесь будет такой же, как и с классами <img src="https://habrastorage.org/getpro/habr/formulas/3e4/c77/a6e/3e4c77a6e7c579a778fa84a18b6f4be0.svg" alt="$1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/f9c/3c8/e48/f9c3c8e488ead4696749012f5ece6d13.svg" alt="$0$" data-tex="inline"/>, но сама дорожка к выводу функции потерь <i>Logistic Loss</i>, будет более витиеватой. Приступаем. Будем для функции правдоподобия использовать оператор <i>«если..., то...»</i>. То есть, если <img src="https://habrastorage.org/getpro/habr/formulas/bf8/3b5/32c/bf83b532cd867d34004f8eded8c5c79a.svg" alt="$i$" data-tex="inline"/>-ый объект относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>, то для расчета правдоподобия выборки используем вероятность <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>, если объект относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/>, то в правдоподобие подставляем <img src="https://habrastorage.org/getpro/habr/formulas/fd1/184/5be/fd11845becb97f0b8b77b8b6e081ae3f.svg" alt="$(1-p)$" data-tex="inline"/>. Вот так выглядит функция правдоподобия:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/4a1/375/d87/4a1375d876abb71c1dd376a63d13c727.svg" alt="$P(\mkern 5mu \vec{y} \mkern 5mu |\mkern 5mu \sigma(\vec{w}^TX)) \mkern 5mu = \mkern 5mu \prod\limits_{i=1}^n \sigma(\vec{w}^T\vec{x_i})^{[y_i=+1]} \mkern 10mu (1-\sigma(\vec{w}^T\vec{x_i})^{[y_i=-1])} \mkern 10mu \rightarrow \mkern 10mu max$" data-tex="display"/></p><br/>
<br/>
На пальцах распишем как это работает. Рассмотрим 4 случая:<br/>
<br/>
<b>1. </b>Если <img src="https://habrastorage.org/getpro/habr/formulas/577/682/05c/57768205c03a5547a4d44277f9c9d441.svg" alt="$y_i=+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/569/d14/c6b/569d14c6b282aa74ae81d7e57e25205d.svg" alt="$\sigma(\vec{w}^T\vec{x_i})=0.9$" data-tex="inline"/>, то в правдоподобие выборки «пойдет» <img src="https://habrastorage.org/getpro/habr/formulas/f82/7d8/2db/f827d82db4267e554348e2466d45bba6.svg" alt="$0.9$" data-tex="inline"/><br/>
<br/>
<b>2.</b> Если <img src="https://habrastorage.org/getpro/habr/formulas/577/682/05c/57768205c03a5547a4d44277f9c9d441.svg" alt="$y_i=+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/482/d62/b49/482d62b4937323f4105296ea8c16acef.svg" alt="$\sigma(\vec{w}^T\vec{x_i})=0.1$" data-tex="inline"/>, то в правдоподобие выборки «пойдет» <img src="https://habrastorage.org/getpro/habr/formulas/b5d/f1c/a28/b5df1ca28f5177703028579f63ece0a3.svg" alt="$0.1$" data-tex="inline"/><br/>
<br/>
<b>3.</b> Если <img src="https://habrastorage.org/getpro/habr/formulas/42a/ee5/5a3/42aee55a3d38b48198849d201571fec7.svg" alt="$y_i=-1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/482/d62/b49/482d62b4937323f4105296ea8c16acef.svg" alt="$\sigma(\vec{w}^T\vec{x_i})=0.1$" data-tex="inline"/>, то в правдоподобие выборки «пойдет» <img src="https://habrastorage.org/getpro/habr/formulas/631/c81/b26/631c81b26a64fc66071635fc4d148e83.svg" alt="$1-0.1=0.9$" data-tex="inline"/><br/>
<br/>
<b>4.</b> Если <img src="https://habrastorage.org/getpro/habr/formulas/42a/ee5/5a3/42aee55a3d38b48198849d201571fec7.svg" alt="$y_i=-1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/569/d14/c6b/569d14c6b282aa74ae81d7e57e25205d.svg" alt="$\sigma(\vec{w}^T\vec{x_i})=0.9$" data-tex="inline"/>, то в правдоподобие выборки «пойдет» <img src="https://habrastorage.org/getpro/habr/formulas/c78/83a/44f/c7883a44f4318bc1e3efbc58d60ae578.svg" alt="$1-0.9=0.1$" data-tex="inline"/><br/>
<br/>
Очевидно, что в 1 и 3 случае, когда вероятности были правильно определены алгоритмом, <i>функция правдоподобия</i> будет максимизироваться, то есть именно это мы и хотели получить. Однако, такой подход достаточно громоздок и далее мы рассмотрим более компактную запись. Но для начала, логарифмируем функцию правдоподобия с заменой знака, так как теперь мы будем минимизировать ее.<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/130/e8f/691/130e8f691883e01464d6cff33b3855b8.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n(-[y_i=+1] \mkern 2mu log_e \mkern 5mu \sigma(\vec{w}^T \vec{x_i}) - [y_i=-1] \mkern 2mu log_e \mkern 5mu (1 - \sigma(\vec{w}^T \vec{x_i})) ) \rightarrow min$" data-tex="display"/></p><br/>
 <br/>
Подставим вместо <img src="https://habrastorage.org/getpro/habr/formulas/1ad/a5b/74b/1ada5b74b1742762c61122c55c12278d.svg" alt="$\sigma(\vec{w}^T \vec{x_i})$" data-tex="inline"/> выражение <img src="https://habrastorage.org/getpro/habr/formulas/12e/d0f/ce9/12ed0fce95916e6d30c11224edeedb2f.svg" alt="$\frac{1}{1+e^{-\vec{w}^T\vec{x_i}}}$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/c2c/0ab/36e/c2c0ab36e7845ed6bc08f3bfa7f7a6f5.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n(-[y_i=+1] \mkern 2mu log_e \mkern 5mu (\frac{1}{1+e^{-\vec{w}^T\vec{x_i}}}) - [y_i=-1] \mkern 2mu log_e \mkern 5mu (1 - \frac{1}{1+e^{-\vec{w}^T\vec{x_i}}})) \rightarrow min$" data-tex="display"/></p><br/>
 <br/>
Упростим правое слагаемое под логарифмом, используя простые арифметические приемы и получим:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/c5e/32f/f29/c5e32ff297d5114261c85aa8b00d74e4.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n(-[y_i=+1] \mkern 2mu log_e \mkern 5mu (\frac{1}{1+e^{-\vec{w}^T\vec{x_i}}}) - [y_i=-1] \mkern 2mu log_e \mkern 5mu (\frac{1}{1+e^{\vec{w}^T\vec{x_i}}})) \rightarrow min$" data-tex="display"/></p><br/>
 <br/>
А теперь настало время избавиться от оператора <i>«если..., то...»</i>. Заметим, что когда объект <img src="https://habrastorage.org/getpro/habr/formulas/98f/639/4b2/98f6394b2bd98b852bb0895b97d55e9f.svg" alt="$y_i$" data-tex="inline"/> относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/>, то в выражении под логарифмом, в знаменателе, <img src="https://habrastorage.org/getpro/habr/formulas/5ca/4b8/ca1/5ca4b8ca180f7495da819508f8afce6e.svg" alt="$e$" data-tex="inline"/> возводится в степень <img src="https://habrastorage.org/getpro/habr/formulas/2ef/fe9/b2f/2effe9b2fa746e71bccdc797bd588ee2.svg" alt="$-\vec{w}^T\vec{x_i}$" data-tex="inline"/>, если объект относится к классу <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/>, то $e$ возводится в степень <img src="https://habrastorage.org/getpro/habr/formulas/cd2/d35/acf/cd2d35acf1773be3215db6fd6e748ec9.svg" alt="$+\vec{w}^T\vec{x_i}$" data-tex="inline"/>. Следовательно запись степени можно упростить — объединить оба случая в один: <img src="https://habrastorage.org/getpro/habr/formulas/938/9c1/2ac/9389c12ac3c73b94e1a58ee72b0a2f4b.svg" alt="$-y_i\vec{w}^T\vec{x_i}$" data-tex="inline"/>. Тогда <i>функция логистической ошибки</i> примет вид:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/870/10b/55a/87010b55ab3e5edfcdce9d64fcd39532.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n- \mkern 2mu log_e \mkern 5mu (\frac{1}{1+e^{-y_i\vec{w}^T\vec{x_i}}} ) \rightarrow min$" data-tex="display"/></p><br/>
<br/>
В соответствии с правилами логарифмирования, перевернем дробь и вынесем знак "<img src="https://habrastorage.org/getpro/habr/formulas/d3d/f50/b83/d3df50b83f85c2e599b5a46b9d893c5e.svg" alt="$-$" data-tex="inline"/>" (минус) за логарифм, получим:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/d6e/0b4/554/d6e0b4554b2d543ca71a394156c386b1.svg" alt="$L_{log}(X,\vec{y},\vec{w}) = \sum\limits_{i=1}^n \mkern 2mu log_e \mkern 5mu (1+e^{-y_i\vec{w}^T\vec{x_i}}) \rightarrow min$" data-tex="display"/></p><br/>
<br/>
Перед вами функция потерь <i>logistic Loss</i>, которая применяется в обучающей выборке с объектами относимых к классам: <img src="https://habrastorage.org/getpro/habr/formulas/9d1/49e/a8e/9d149ea8ef8692eb106a55ce5af36ccd.svg" alt="$+1$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/d06/719/edc/d06719edc69908e7467f7e6189302b74.svg" alt="$-1$" data-tex="inline"/>. <br/>
<br/>
Что ж, на этом моменте я откланиваюсь и мы завершаем статью.<br/>
<br/>
<i><a href="https://habr.com/ru/post/479398/"><img src="https://habrastorage.org/getpro/habr/formulas/1ea/f1d/7cc/1eaf1d7cc593750347f384d8d73d69a5.svg" alt="$\leftarrow$" data-tex="inline"/></a> Предыдущая работа автора — «Приводим уравнение линейной регрессии в матричный вид»</i><br/>
<br/>
<h2>Вспомогательные материалы</h2><br/>
<h3>1. Литература</h3><br/>
1) Прикладной регрессионный анализ / Н. Дрейпер, Г. Смит – 2-е изд. – М.: Финансы и статистика, 1986 (перевод с английского)<br/>
<br/>
2) Теория вероятностей и математическая статистика / В.Е. Гмурман — 9-е изд. — М.: Высшая школа, 2003<br/>
<br/>
3) Теория вероятностей / Н.И. Чернова — Новосибирск: Новосибирский государственный университет, 2007<br/>
<br/>
4) Бизнес-аналитика: от данных к знаниям / Паклин Н. Б., Орешков В. И. — 2-е изд. — Санкт-Петербург: Питер, 2013<br/>
<br/>
5) Data Science Наука о данных с нуля / Джоэл Грас — Санкт-Петербург: БХВ Петербург, 2017<br/>
<br/>
6) Практическая статистика для специалистов Data Science / П.Брюс, Э.Брюс — Санкт-Петербург: БХВ Петербург, 2018<br/>
<br/>
<h3>2. Лекции, курсы (видео)</h3><br/>
1) <a href="https://www.youtube.com/watch?v=2iRIqkm1mug" rel="nofollow">Суть метода максимального правдоподобия, Борис Демешев</a><br/>
<br/>
2) <a href="https://www.youtube.com/watch?v=9CeB32vxM0A" rel="nofollow">Метод максимального правдоподобия в непрерывном случае, Борис Демешев</a><br/>
<br/>
3) <a href="https://www.youtube.com/watch?v=NO4KSNbsXZE" rel="nofollow">Логистическая регрессия. Открытый курс ODS, Yury Kashnitsky</a><br/>
<br/>
4) <a href="https://www.youtube.com/watch?v=PrsLyrz7Zlw&amp;list=PLEqoHzpnmTfDwuwrFHWVHdr1-qJsfqCUX&amp;index=3" rel="nofollow">Лекция 4, Евгений Соколов (с 47 минуты видео)</a><br/>
<br/>
5) <a href="https://www.coursera.org/lecture/vvedenie-mashinnoe-obuchenie/loghistichieskaia-rieghriessiia-8G3Xu" rel="nofollow">Логистическая регрессия, Вячеслав Воронцов</a><br/>
<br/>
<h3>3. Интернет-источники</h3><br/>
1) <a href="https://habr.com/ru/company/ods/blog/323890/">Линейные модели классификации и регрессии</a><br/>
<br/>
2) <a href="https://habr.com/ru/company/io/blog/265007/">Как легко понять логистическую регрессию</a><br/>
<br/>
3) <a href="https://dyakonov.org/2018/03/12/%D0%BB%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F-%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B8/" rel="nofollow">Логистическая функция ошибки</a><br/>
<br/>
4) <a href="http://mathprofi.ru/nezavisimye_ispytanija_i_formula_bernulli.html" rel="nofollow">Независимые испытания и формула Бернули</a><br/>
<br/>
5) <a href="https://www.hse.ru/data/2012/11/21/1248365473/%D0%9C%D0%9C%D0%9F%20%D0%B4%D0%BB%D1%8F%202%20%D0%BA%D1%83%D1%80%D1%81%D0%B0%20%D0%BF%D0%BE%D0%BB%D0%B8%D1%82%D0%BE%D0%BB%D0%BE%D0%B3%D0%BE%D0%B2%20(%D0%BF%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5%20-%20%D1%87%D1%8C%D1%8F-%D1%82%D0%BE%20%D0%BC%D0%B0%D1%82%D1%8C).pdf" rel="nofollow">Баллада о ММП</a><br/>
<br/>
6) <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D1%80%D0%B0%D0%B2%D0%B4%D0%BE%D0%BF%D0%BE%D0%B4%D0%BE%D0%B1%D0%B8%D1%8F" rel="nofollow">Метод максимального правдоподобия</a><br/>
<br/>
7) <a href="https://ru.onlinemschool.com/math/formula/logarithm_formula/" rel="nofollow">Формулы и свойства логарифмов</a><br/>
<br/>
8) <a href="https://zero2hero.org/article/math/34-eksponenta-i-chislo-e-prosto-i-ponyatno" rel="nofollow">Почему число <img src="https://habrastorage.org/getpro/habr/formulas/5ca/4b8/ca1/5ca4b8ca180f7495da819508f8afce6e.svg" alt="$e$" data-tex="inline"/>?</a><br/>
<br/>
<a href="https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B9_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80" rel="nofollow">9) Линейный классификатор</a><br/>
<br/>
9) <a href="https://github.com/AlexanderPetrenko83/Articles/tree/master/20200128_Logistic_Regression" rel="nofollow">Jupyter notebook на гитхабе</a></div></div></div> <!----> <!----></div> <!----> <!----></div> <!----> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%B0%D1%87%D0%B8%D0%BD%D0%B0%D1%8E%D1%89%D0%B8%D1%85%5D" class="tm-tags-list__link">анализ данных для начинающих</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B9%20%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80%5D" class="tm-tags-list__link">линейный классификатор</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BB%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D1%80%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F%5D" class="tm-tags-list__link">логистическая регрессия</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%B0%D0%B2%D0%B4%D0%BE%D0%BF%D0%BE%D0%B4%D0%BE%D0%B1%D0%B8%D0%B5%5D" class="tm-tags-list__link">правдоподобие</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%20%D0%BF%D0%BE%D1%82%D0%B5%D1%80%D1%8C%20%27Logistic%20Loss%27%5D" class="tm-tags-list__link">функция потерь 'Logistic Loss'</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/python/" class="tm-hubs-list__link">Python</a></li><li class="tm-separated-list__item"><a href="/ru/hub/maths/" class="tm-hubs-list__link">Математика</a></li><li class="tm-separated-list__item"><a href="/ru/hub/machine_learning/" class="tm-hubs-list__link">Машинное обучение</a></li><li class="tm-separated-list__item"><a href="/ru/hub/study/" class="tm-hubs-list__link">Учебный процесс в IT</a></li><li class="tm-separated-list__item"><a href="/ru/hub/artificial_intelligence/" class="tm-hubs-list__link">Искусственный интеллект</a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 10: ↑10 и ↓0</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 10: ↑10 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+10</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    144
  </span></button> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/articles/485872/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      20
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></div></div>  <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/AlexanderPetrenko/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/827/c53/968/827c5396819ba5bce84d403bb214ca99.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 21 голос " class="tm-counter-container tm-karma tm-karma"><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_positive">
      15
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <div title="Рейтинг пользователя" class="tm-counter-container"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        0
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">Александр Петренко</span> <a href="/ru/users/AlexanderPetrenko/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @AlexanderPetrenko
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Машинное обучение</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://instagram.com/petrenko3304/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Instagram
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-adfox-banner__container tm-page-article__banner"><!----> <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div></div> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/articles/485872/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 20 
    </span></a> <!----></div></div></div>  <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!----></div> <div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-article-cards"><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div></div> <!----> <!----> <!----> <!----></div> <!----></div></div> <!----></section> <div><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div> <div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div> <div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div></div></div></div> <!----> <!----> <!----> <!----> <!----></div></div> <div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-courses"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__company-avatar"></div> <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__company-avatar"></div> <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__company-avatar"></div> <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__company-avatar"></div> <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__company-avatar"></div> <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top"><!----> <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Истории</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-equal"><div class="tm-stories-empty"><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div></div> <!----></div> <!----></section> <section data-async-called="true" class="tm-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Работа</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/django_razrabotchik" target="_blank" class="tm-vacancies-block__vacancy-title">
        Django разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        55
    вакансий
      </div></div><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/data_scientist" target="_blank" class="tm-vacancies-block__vacancy-title">
        Data Scientist
      </a> <div class="tm-vacancies-block__vacancies-count">
        160
    вакансий
      </div></div><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/programmist_python" target="_blank" class="tm-vacancies-block__vacancy-title">
        Python разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        149
    вакансий
      </div></div></div> <footer class="tm-block__footer"><a href="https://career.habr.com/catalog" class="tm-block-extralink">
      Все вакансии
    </a></footer></section> <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom"><!----> <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div></div></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/articles/485872/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/articles/485872/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Статьи
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/specials/" class="footer-menu__item-link">
                Спецпроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"485872":{"id":"485872","timePublished":"2020-01-28T10:32:47+00:00","isCorporative":false,"lang":"ru","titleHtml":"Пережевывая логистическую регрессию","leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgz\u002Fx1\u002Foz\u002Fgzx1ozgcc-evcxyxrjjefqfetja.jpeg\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этой статье, мы будем разбирать теоретические выкладки преобразования \u003Ci\u003Eфункции линейной регрессии\u003C\u002Fi\u003E в \u003Ci\u003Eфункцию обратного логит-преобразования (иначе говорят, функцию логистического отклика)\u003C\u002Fi\u003E. Затем, воспользовавшись арсеналом \u003Ci\u003Eметода максимального правдоподобия\u003C\u002Fi\u003E, в соответствии с моделью логистической регрессии, выведем функцию потерь \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E, или другими словами, мы определим функцию, с помощью которой в модели логистической регрессии подбираются параметры вектора весов \u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u003E\u003C\u002Fmath\u003E.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПлан статьи:\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EПовторим о прямолинейной зависимости между двумя переменными\u003C\u002Fli\u003E\r\n\u003Cli\u003EВыявим необходимость преобразования \u003Ci\u003Eфункции линейной регрессии\u003C\u002Fi\u003E \u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F585\u002Fef6\u002Fe3a\u002F585ef6e3a3cddcd7fc7f3a2066a186b5.svg\" alt=\"$ f(w,x_i) = \\vec{w}^T \\vec{x_i}$\" data-tex=\"inline\"\u003E\u003C\u002Fmath\u003E в \u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E \u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe80\u002Fd81\u002F93d\u002Fe80d8193d49469dee69b5a8c4bf8b6ec.svg\" alt=\"$\\sigma(\\vec{w}^T \\vec{x_i}) = \\frac{1}{1+e^{-\\vec{w}^T \\vec{x_i}}}$\" data-tex=\"inline\"\u003E\u003C\u002Fmath\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EПроведем преобразования и выведем \u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EПопытаемся понять, чем плох метод наименьших квадратов при подборе параметров \u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u003E\u003C\u002Fmath\u003E функции \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EИспользуем \u003Ci\u003Eметод максимального правдоподобия\u003C\u002Fi\u003E для определения \u003Ci\u003Eфункции подбора параметров\u003C\u002Fi\u003E \u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u003E\u003C\u002Fmath\u003E:\u003Cbr\u003E\r\n \u003Cbr\u003E\r\n 5.1. Случай 1: функция \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E для объектов с обозначением классов \u003Cb\u003E0\u003C\u002Fb\u003E и \u003Cb\u003E1\u003C\u002Fb\u003E:\u003Cbr\u003E\r\n \u003Cbr\u003E\r\n \u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6cd\u002F3e7\u002Fa4e\u002F6cd3e7a4e1762efb4733a1ef7d0047de.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-y_i \\mkern 2mu log_e \\mkern 5mu \\sigma(\\vec{w}^T \\vec{x_i}) - (1-y_i) \\mkern 2mu log_e \\mkern 5mu (1 - \\sigma(\\vec{w}^T \\vec{x_i})) ) \\rightarrow min$\" data-tex=\"display\"\u003E\u003C\u002Fmath\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n \u003Cbr\u003E\r\n 5.2. Случай 2: функция \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E для объектов с обозначением классов \u003Cb\u003E-1\u003C\u002Fb\u003E и \u003Cb\u003E+1\u003C\u002Fb\u003E:\u003Cbr\u003E\r\n \u003Cbr\u003E\r\n \u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cmath\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6e\u002F0b4\u002F554\u002Fd6e0b4554b2d543ca71a394156c386b1.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n \\mkern 2mu log_e \\mkern 5mu (1+e^{-y_i\\vec{w}^T\\vec{x_i}}) \\rightarrow min$\" data-tex=\"display\"\u003E\u003C\u002Fmath\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2185797","alias":"AlexanderPetrenko","fullname":"Александр Петренко","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F827\u002Fc53\u002F968\u002F827c5396819ba5bce84d403bb214ca99.jpg","speciality":"Машинное обучение","scoreStats":{"score":15,"votesCount":21},"rating":0,"relatedData":null,"contacts":[{"title":"Instagram","url":"https:\u002F\u002Finstagram.com\u002Fpetrenko3304\u002F","value":"petrenko3304","siteTitle":null,"favicon":null}],"authorContacts":[{"title":"Instagram","url":"https:\u002F\u002Finstagram.com\u002Fpetrenko3304\u002F","value":"petrenko3304","siteTitle":null,"favicon":null}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":20,"favoritesCount":144,"readingCount":35538,"score":10,"votesCount":10,"votesCountPlus":10,"votesCountMinus":0},"hubs":[{"id":"340","alias":"python","type":"collective","title":"Python","titleHtml":"Python","isProfiled":true,"relatedData":null},{"id":"17812","alias":"maths","type":"collective","title":"Математика","titleHtml":"Математика","isProfiled":true,"relatedData":null},{"id":"19439","alias":"machine_learning","type":"collective","title":"Машинное обучение","titleHtml":"Машинное обучение","isProfiled":true,"relatedData":null},{"id":"20696","alias":"study","type":"collective","title":"Учебный процесс в IT","titleHtml":"Учебный процесс в IT","isProfiled":false,"relatedData":null},{"id":"21922","alias":"artificial_intelligence","type":"collective","title":"Искусственный интеллект","titleHtml":"Искусственный интеллект","isProfiled":false,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент","titleHtml":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп","titleHtml":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fgz\u002Fx1\u002Foz\u002Fgzx1ozgcc-evcxyxrjjefqfetja.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgz\u002Fx1\u002Foz\u002Fgzx1ozgcc-evcxyxrjjefqfetja.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этой статье, мы будем разбирать теоретические выкладки преобразования \u003Ci\u003Eфункции линейной регрессии\u003C\u002Fi\u003E в \u003Ci\u003Eфункцию обратного логит-преобразования (иначе говорят, функцию логистического отклика)\u003C\u002Fi\u003E. Затем, воспользовавшись арсеналом \u003Ci\u003Eметода максимального правдоподобия\u003C\u002Fi\u003E, в соответствии с моделью логистической регрессии, выведем функцию потерь \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E, или другими словами, мы определим функцию, с помощью которой в модели логистической регрессии подбираются параметры вектора весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПлан статьи:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EПовторим о прямолинейной зависимости между двумя переменными\u003C\u002Fli\u003E\r\n\u003Cli\u003EВыявим необходимость преобразования \u003Ci\u003Eфункции линейной регрессии\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F585\u002Fef6\u002Fe3a\u002F585ef6e3a3cddcd7fc7f3a2066a186b5.svg\" alt=\"$ f(w,x_i) = \\vec{w}^T \\vec{x_i}$\" data-tex=\"inline\"\u002F\u003E в \u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe80\u002Fd81\u002F93d\u002Fe80d8193d49469dee69b5a8c4bf8b6ec.svg\" alt=\"$\\sigma(\\vec{w}^T \\vec{x_i}) = \\frac{1}{1+e^{-\\vec{w}^T \\vec{x_i}}}$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EПроведем преобразования и выведем \u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EПопытаемся понять, чем плох метод наименьших квадратов при подборе параметров \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E функции \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EИспользуем \u003Ci\u003Eметод максимального правдоподобия\u003C\u002Fi\u003E для определения \u003Ci\u003Eфункции подбора параметров\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n 5.1. Случай 1: функция \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E для объектов с обозначением классов \u003Cb\u003E0\u003C\u002Fb\u003E и \u003Cb\u003E1\u003C\u002Fb\u003E:\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n \u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6cd\u002F3e7\u002Fa4e\u002F6cd3e7a4e1762efb4733a1ef7d0047de.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-y_i \\mkern 2mu log_e \\mkern 5mu \\sigma(\\vec{w}^T \\vec{x_i}) - (1-y_i) \\mkern 2mu log_e \\mkern 5mu (1 - \\sigma(\\vec{w}^T \\vec{x_i})) ) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n 5.2. Случай 2: функция \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E для объектов с обозначением классов \u003Cb\u003E-1\u003C\u002Fb\u003E и \u003Cb\u003E+1\u003C\u002Fb\u003E:\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n \u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6e\u002F0b4\u002F554\u002Fd6e0b4554b2d543ca71a394156c386b1.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n \\mkern 2mu log_e \\mkern 5mu (1+e^{-y_i\\vec{w}^T\\vec{x_i}}) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nСтатья изобилует простыми примерами, в которых все расчеты легко произвести устно или на бумаге, в некоторых случаях может потребоваться калькулятор. Так что подготовьтесь :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДанная статья в большей мере рассчитана на датасайнтистов с начальным уровнем познаний в основах машинного обучения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ статье также будет приведен код для отрисовки графиков и расчетов. Весь код написан на языке \u003Ci\u003Epython 2.7\u003C\u002Fi\u003E. Заранее поясню о «новизне» используемой версии — таково одно из условий прохождения известного курса от \u003Ci\u003EЯндекса\u003C\u002Fi\u003E на не менее известной интернет-площадке онлайн образования \u003Ci\u003ECoursera\u003C\u002Fi\u003E, и, как можно предположить, материал подготовлен по мотивам этого курса.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003E01. Прямолинейная зависимость\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nВполне резонно задать вопрос — причем здесь прямолинейная зависимость и логистическая регрессия?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсе просто! Логистическая регрессия представляет собой одну из моделей, которые относятся к линейному классификатору. Простыми словами, задачей линейного классификатора является предсказание целевых значений \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9b3\u002F4c4\u002Fda5\u002F9b34c4da5c757d4982bbd1b6f2e8998a.svg\" alt=\"$y$\" data-tex=\"inline\"\u002F\u003E от переменных (регрессоров) \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6d6\u002Fa4f\u002F78f\u002F6d6a4f78fbacd6edecc018ce8ad3e364.svg\" alt=\"$X$\" data-tex=\"inline\"\u002F\u003E. При этом считается, что зависимость между признаками \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6d6\u002Fa4f\u002F78f\u002F6d6a4f78fbacd6edecc018ce8ad3e364.svg\" alt=\"$X$\" data-tex=\"inline\"\u002F\u003E и целевыми значениями \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9b3\u002F4c4\u002Fda5\u002F9b34c4da5c757d4982bbd1b6f2e8998a.svg\" alt=\"$y$\" data-tex=\"inline\"\u002F\u003E линейная. Отсюда собственно и название классификатора — линейный. Если очень грубо обобщить, то в основе модели логистической регрессии лежит предположение о наличии линейной зависимости между признаками \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6d6\u002Fa4f\u002F78f\u002F6d6a4f78fbacd6edecc018ce8ad3e364.svg\" alt=\"$X$\" data-tex=\"inline\"\u002F\u003E и целевыми значениями \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9b3\u002F4c4\u002Fda5\u002F9b34c4da5c757d4982bbd1b6f2e8998a.svg\" alt=\"$y$\" data-tex=\"inline\"\u002F\u003E. Вот она — связь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ студии первый пример, и он, правильно, о прямолинейной зависимости исследуемых величин. В процессе подготовки статьи наткнулся на пример, набивший уже многим оскомину — зависимость силы тока от напряжения \u003Ci\u003E(«Прикладной регрессионный анализ», Н.Дрейпер, Г.Смит)\u003C\u002Fi\u003E. Здесь мы его тоже рассмотрим. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ соответствии с \u003Ci\u003Eзаконом Ома:\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc6e\u002F9ce\u002F6fa\u002Fc6e9ce6fa3ec33e39afdda03e5559c67.svg\" alt=\"$I = U\u002FR$\" data-tex=\"inline\"\u002F\u003E, где \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F64b\u002Feb7\u002F37a\u002F64beb737a23fb5cb0a455f0e9213f2a4.svg\" alt=\"$I$\" data-tex=\"inline\"\u002F\u003E — сила тока, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd07\u002Fcc5\u002Fb26\u002Fd07cc5b26db621faab45e0e0b54ede62.svg\" alt=\"$U$\" data-tex=\"inline\"\u002F\u003E — напряжение, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb81\u002Fa7c\u002F1e9\u002Fb81a7c1e9676b36cc02ddeea5d5f6e51.svg\" alt=\"$R$\" data-tex=\"inline\"\u002F\u003E — сопротивление. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли бы мы не знали \u003Ci\u003Eзакон Ома\u003C\u002Fi\u003E, то могли бы найти зависимость эмпирически, изменяя \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd07\u002Fcc5\u002Fb26\u002Fd07cc5b26db621faab45e0e0b54ede62.svg\" alt=\"$U$\" data-tex=\"inline\"\u002F\u003E и измеряя \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F64b\u002Feb7\u002F37a\u002F64beb737a23fb5cb0a455f0e9213f2a4.svg\" alt=\"$I$\" data-tex=\"inline\"\u002F\u003E, поддерживая при этом \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb81\u002Fa7c\u002F1e9\u002Fb81a7c1e9676b36cc02ddeea5d5f6e51.svg\" alt=\"$R$\" data-tex=\"inline\"\u002F\u003E фиксированным. Тогда мы бы увидели, что график зависимости \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F64b\u002Feb7\u002F37a\u002F64beb737a23fb5cb0a455f0e9213f2a4.svg\" alt=\"$I$\" data-tex=\"inline\"\u002F\u003E от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd07\u002Fcc5\u002Fb26\u002Fd07cc5b26db621faab45e0e0b54ede62.svg\" alt=\"$U$\" data-tex=\"inline\"\u002F\u003E дает более или менее прямую линию, проходящую через начало координат. Мы сказали «более или менее», так как, хотя зависимость фактически точная, наши измерения могут содержать малые ошибки, и поэтому точки на графике, возможно не попадут строго на линию, а будут разбросаны вокруг нее случайным образом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nГрафик 1 «Зависимость \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F64b\u002Feb7\u002F37a\u002F64beb737a23fb5cb0a455f0e9213f2a4.svg\" alt=\"$I$\" data-tex=\"inline\"\u002F\u003E от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd07\u002Fcc5\u002Fb26\u002Fd07cc5b26db621faab45e0e0b54ede62.svg\" alt=\"$U$\" data-tex=\"inline\"\u002F\u003E»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fis\u002Fxw\u002F0m\u002Fisxw0mnnbx1iowlms-cim4nekzs.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fis\u002Fxw\u002F0m\u002Fisxw0mnnbx1iowlms-cim4nekzs.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод отрисовки графика\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport numpy as np\n\nimport random\n\nR = 13.75\n\nx_line = np.arange(0,220,1)\ny_line = []\nfor i in x_line:\n    y_line.append(i\u002FR)\n    \ny_dot = []\nfor i in y_line:\n    y_dot.append(i+random.uniform(-0.9,0.9))\n\n\nfig, axes = plt.subplots(figsize = (14,6), dpi = 80)\nplt.plot(x_line,y_line,color = 'purple',lw = 3, label = 'I = U\u002FR')\nplt.scatter(x_line,y_dot,color = 'red', label = 'Actual results')\nplt.xlabel('I', size = 16)\nplt.ylabel('U', size = 16)\nplt.legend(prop = {'size': 14})\nplt.show()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2\u003E02. Необходимость преобразований уравнения линейной регрессии\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nРассмотрим очередной пример. Представим, что мы работаем в банке и перед нами задача определить вероятность возврата кредита заемщиком в зависимости от некоторых факторов. Для упрощения задачи, рассмотрим только два фактора: месячная зарплата заемщика и месячный размер платежа на погашение кредита. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗадача очень условная, но на этом примере мы сможем понять, почему для ее решения недостаточно применения \u003Ci\u003Eфункции линейной регрессии\u003C\u002Fi\u003E, а также узнаем какие преобразования с функцией требуется провести.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозвращаемся к примеру. Понятно, что чем выше зарплата, тем больше заемщик сможет ежемесячно направлять на погашение кредита. При этом, для определенного диапазона зарплат эта зависимость будет вполне себе линейная. Например, возьмем диапазон зарплат от 60.000Р до 200.000Р и предположим, что в указанном диапазоне заработных плат, зависимость размера ежемесячного платежа от размера заработной платы — линейная. Допустим, для указанного диапазона размера заработных плат было выявлено, что соотношение зарплаты к платежу не может опускаться ниже 3 и еще у заемщика должно оставаться в запасе 5.000Р. И только в таком случае, мы будем считать, что заемщик вернет кредит банку. Тогда, уравнение линейной регрессии примет вид:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbc0\u002F520\u002F56d\u002Fbc052056d1d8b3737378422e61c0b96a.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}, $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nгде \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d6\u002Ffc6\u002F8e9\u002F1d6fc68e93e5b2fb640d3c5ba30838b4.svg\" alt=\"$w_0 = -5.000$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb9a\u002F683\u002Fb5b\u002Fb9a683b5bb695de57126e5db4ebb7436.svg\" alt=\"$w_1 = 1$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4d5\u002F24b\u002F21f\u002F4d524b21f2020047e2d340a59f17ccba.svg\" alt=\"$w_2 = -3$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F0df\u002F530\u002Ffff\u002F0df530ffff8762f5174e6539bc64ddc4.svg\" alt=\"$x_{i1}$\" data-tex=\"inline\"\u002F\u003E — \u003Ci\u003Eзарплата\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbf8\u002F3b5\u002F32c\u002Fbf83b532cd867d34004f8eded8c5c79a.svg\" alt=\"$i$\" data-tex=\"inline\"\u002F\u003E-го заемщика, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F941\u002Fd95\u002F780\u002F941d95780d8800fd32e758b586120101.svg\" alt=\"$x_{i2}$\" data-tex=\"inline\"\u002F\u003E — \u003Ci\u003Eплатеж по кредиту\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbf8\u002F3b5\u002F32c\u002Fbf83b532cd867d34004f8eded8c5c79a.svg\" alt=\"$i$\" data-tex=\"inline\"\u002F\u003E-го заемщика. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПодставляя в уравнение зарплату и платеж по кредиту с фиксированными параметрами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E можно принять решение о выдаче или отказе кредита. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗабегая вперед, отметим, что, при заданных параметрах \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E \u003Ci\u003Eфункция линейной регрессии\u003C\u002Fi\u003E, применяемая в \u003Ci\u003Eфункции логистичиеского отклика\u003C\u002Fi\u003E будет выдавать большие значения, которые затруднят проведение расчетов по определению вероятностей погашения кредита. Поэтому, предлагается уменьшить наши коэффициенты, скажем так, в 25.000 раз. От этого преобразования в коэффициентах, решение о выдачи кредита не изменится. Запомним этот момент на будущее, а сейчас чтобы было еще понятнее, о чем речь, рассмотрим ситуация с тремя потенциальными заемщиками.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаблица 1 «Потенциальные заемщики»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F6u\u002Fmu\u002Fvk\u002F6umuvkl-ulskbew1eptm9azq-ns.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F6u\u002Fmu\u002Fvk\u002F6umuvkl-ulskbew1eptm9azq-ns.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для формирования таблицы\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport pandas as pd\n\nr = 25000.0\nw_0 = -5000.0\u002Fr\nw_1 = 1.0\u002Fr\nw_2 = -3.0\u002Fr\n\ndata = {'The borrower':np.array(['Vasya', 'Fedya', 'Lesha']), \n        'Salary':np.array([120000,180000,210000]),\n       'Payment':np.array([3000,50000,70000])}\n\ndf = pd.DataFrame(data)\n\ndf['f(w,x)'] = w_0 + df['Salary']*w_1 + df['Payment']*w_2\n\ndecision = []\nfor i in df['f(w,x)']:\n    if i \u003E 0:\n        dec = 'Approved'\n        decision.append(dec)\n    else:\n        dec = 'Refusal'\n        decision.append(dec)\n        \ndf['Decision'] = decision\n\ndf[['The borrower', 'Salary', 'Payment', 'f(w,x)', 'Decision']]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВ соответствии с данными таблицы, Вася при зарплате в 120.000Р хочет получить такой кредит, чтобы ежемесячного гасить его по 3.000Р. Нами было определено, что для одобрения кредита, размер заработной платы Васи должен превышать в три раза размер платежа, и чтобы еще оставалось 5.000Р. Этому требованию Вася удовлетворяет: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc8a\u002F7a1\u002Fd6e\u002Fc8a7a1d6ed0bb61476e853b184c1ae34.svg\" alt=\"$120.000-3 * 3.000-5.000 = 106.000$\" data-tex=\"inline\"\u002F\u003E. Остается даже 106.000Р. Несмотря на то, что при расчете \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E мы уменьшили коэффициенты \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E в 25.000 раз, результат получили тот же — кредит может быть одобрен. Федя тоже получит кредит, а вот Леше, несмотря на то, что он получает больше всех, придется поумерить свои аппетиты.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНарисуем график по такому случаю.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nГрафик 2 «Классификация заемщиков»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fd5\u002Fmt\u002Fvp\u002Fd5mtvp3cdodptyrglkqkjumcz4c.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fd5\u002Fmt\u002Fvp\u002Fd5mtvp3cdodptyrglkqkjumcz4c.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для отрисовки графика\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Esalary = np.arange(60000,240000,20000)\npayment = (-w_0-w_1*salary)\u002Fw_2\n\n\nfig, axes = plt.subplots(figsize = (14,6), dpi = 80)\nplt.plot(salary, payment, color = 'grey', lw = 2, label = '$f(w,x_i)=w_0 + w_1x_{i1} + w_2x_{i2}$')\nplt.plot(df[df['Decision'] == 'Approved']['Salary'], df[df['Decision'] == 'Approved']['Payment'], \n         'o', color ='green', markersize = 12, label = 'Decision - Loan approved')\nplt.plot(df[df['Decision'] == 'Refusal']['Salary'], df[df['Decision'] == 'Refusal']['Payment'], \n         's', color = 'red', markersize = 12, label = 'Decision - Loan refusal')\nplt.xlabel('Salary', size = 16)\nplt.ylabel('Payment', size = 16)\nplt.legend(prop = {'size': 14})\nplt.show()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nИтак, наша прямая, построенная в соответствии с функцией \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E, отделяет «плохих» заемщиков от «хороших». Те заемщики, у кого желания не совпадают с возможностями находятся выше прямой (Леша), те же, кто способен согласно параметрам нашей модели, вернуть кредит, находятся под прямой (Вася и Федя). Иначе можно сказать так — наша прямая разделяет заемщиков на два класса. Обозначим их следующим образом: к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E отнесем тех заемщиков, которые скорее всего вернут кредит, к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E отнесем тех заемщиков, которые скорее всего не смогут вернуть кредит. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОбобщим выводы из этого простенького примера. Возьмем точку \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F83a\u002F09b\u002F484\u002F83a09b484baf09b29374b626743ee4de.svg\" alt=\"$M(x_1,x_2)$\" data-tex=\"inline\"\u002F\u003E и, подставляя координаты точки в соответствующее уравнение прямой \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E, рассмотрим три варианта:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EЕсли точка находится под прямой, и мы относим ее к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E, то значение функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E будет положительным от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb0b\u002F232\u002Ff34\u002Fb0b232f343595119559cf1186dd5f4a7.svg\" alt=\"$+\\infty$\" data-tex=\"inline\"\u002F\u003E. Значит мы можем считать, что вероятность погашения кредита, находится в пределах \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe52\u002Fd01\u002F8f8\u002Fe52d018f87e1844bc2e714af79f0cdf0.svg\" alt=\"$(0.5,1]$\" data-tex=\"inline\"\u002F\u003E. Чем больше значение функции, тем выше вероятность.\u003C\u002Fli\u003E\r\n\u003Cli\u003EЕсли точка находится над прямой и мы относим ее к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E, то значение функции будет отрицательным от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6d\u002F1e2\u002Fab7\u002Fd6d1e2ab791a06785be738fe3a3a4f9d.svg\" alt=\"$-\\infty$\" data-tex=\"inline\"\u002F\u003E. Тогда мы будем считать, что вероятность погашения задолженности находится в пределах \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd11\u002F82d\u002Fcbe\u002Fd1182dcbec38620f7bdfad6d7a8529ab.svg\" alt=\"$[0,0.5)$\" data-tex=\"inline\"\u002F\u003E и, чем больше по модулю значение функции, тем выше наша уверенность.\u003C\u002Fli\u003E\r\n\u003Cli\u003EТочка находится на прямой, на границе между двумя классами. В таком случае значение функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E будет равно \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E и вероятность погашения кредита равна \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff68\u002F2d0\u002F19e\u002Ff682d019e8fd1f11da97e75f9863c232.svg\" alt=\"$0.5$\" data-tex=\"inline\"\u002F\u003E.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nТеперь, представим, что у нас не два фактора, а десятки, заемщиков не три, а тысячи. Тогда вместо прямой у нас будет \u003Ci\u003Em-мерная\u003C\u002Fi\u003E плоскость и коэффициенты \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E у нас будут взяты не с потолка, а выведены по всем правилам, да на основе накопленных данных о заемщиках, вернувших или не вернувших кредит. И действительно, заметьте, мы сейчас отбираем заемщиков при уже известных коэффициентах \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E. На самом же деле, задача модели логистической регрессии как раз и состоит в том, чтобы определить параметры \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E, при которых значение функции потерь \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E будет стремиться к минимальному. Но о том, как рассчитывается вектор \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E, мы еще узнаем в 5-м разделе статьи. А пока возвращаемся на землю обетованную — к нашему банкиру и трем его клиентам.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБлагодаря функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E мы знаем кому можно дать кредит, а кому нужно отказать. Но с такой информацией к директору идти нельзя, ведь от нас хотели получить вероятность возврата кредита каждым заемщиком. Что делать? Ответ простой — нам нужно как-то преобразовать функцию \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E, значения которой лежат в диапазоне \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F80b\u002F03c\u002Fcfd\u002F80b03ccfdd0e8cb84e222715755ccf26.svg\" alt=\"$(-\\infty,+\\infty)$\" data-tex=\"inline\"\u002F\u003E на функцию, значения которой будут лежать в диапазоне \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa5d\u002F538\u002Ff83\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\" alt=\"$[0,1]$\" data-tex=\"inline\"\u002F\u003E. И такая функция существует, ее называют \u003Ci\u003Eфункцией логистического отклика или обратного-логит преобразования\u003C\u002Fi\u003E. Знакомьтесь: \u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe80\u002Fd81\u002F93d\u002Fe80d8193d49469dee69b5a8c4bf8b6ec.svg\" alt=\"$\\sigma(\\vec{w}^T \\vec{x_i}) = \\frac{1}{1+e^{-\\vec{w}^T \\vec{x_i}}}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nПосмотрим по шагам как получается \u003Ci\u003Eфункция логистического отклика\u003C\u002Fi\u003E. Отметим, что шагать мы будем в обратную сторону, т.е. мы предположим, что нам известно значение вероятности, которое лежит в пределах от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E и далее мы будем «раскручивать» это значение на всю область чисел от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6d\u002F1e2\u002Fab7\u002Fd6d1e2ab791a06785be738fe3a3a4f9d.svg\" alt=\"$-\\infty$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb0b\u002F232\u002Ff34\u002Fb0b232f343595119559cf1186dd5f4a7.svg\" alt=\"$+\\infty$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003E03. Выводим функцию логистического отклика\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EШаг 1. Переведем значения вероятности в диапазон \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1f1\u002F806\u002Fcaa\u002F1f1806caa396ad814c5cbae44638a38f.svg\" alt=\"$[0,+\\infty)$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа время трансформации функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F77c\u002F86b\u002F417\u002F77c86b4173bc0406c4de95039461df33.svg\" alt=\"$f(w,x_i) = w_0 + w_1x_{i1} + w_2x_{i2}$\" data-tex=\"inline\"\u002F\u003E в \u003Ci\u003E\u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3d4\u002F4dd\u002Fae7\u002F3d44ddae7c3d13b9dd873c4a1e09491b.svg\" alt=\"$\\sigma(\\vec{w}^T \\vec{x_i}) = \\frac{1}{1+e^{\\vec{w}^T \\vec{x_i}}}$\" data-tex=\"inline\"\u002F\u003E мы оставим в покое нашего кредитного аналитика, а вместо этого пройдемся по букмекерским конторам. Нет, конечно, ставки делать мы не будем, все что нас там интересует, так это смысл выражения, например, шанс 4 к 1. Шансы, знакомые всем делающим ставки игрокам, являются соотношением «успехов» к «неуспехам». С точки зрения вероятностей, шансы — это вероятность наступления события, деленная на вероятность того, что событие не произойдет. Запишем формулу шанса наступления события \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F91c\u002F34b\u002F351\u002F91c34b351d7bb8df08e960b4cdc79b16.svg\" alt=\"$(odds_+)$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F53f\u002F440\u002F8d3\u002F53f4408d3030531b75daef03c76269a0.svg\" alt=\"$odds_+ = \\frac{p_+}{1-p_+}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n, где \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcc6\u002Ff03\u002F35e\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\" alt=\"$p_+$\" data-tex=\"inline\"\u002F\u003E — вероятность наступления события, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff5c\u002Fdcd\u002F662\u002Ff5cdcd662a6590cdf971e57494ad123e.svg\" alt=\"$(1-p_+)$\" data-tex=\"inline\"\u002F\u003E — вероятность НЕ наступления события\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапример, если вероятность того, что молодой, сильный и резвый конь по прозвищу «Ветерок» обойдет на скачках старую и дряблую старушку по кличке «Матильда» равняется \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fca8\u002F978\u002Fec5\u002Fca8978ec597af63524046a377099d3e3.svg\" alt=\"$0.8$\" data-tex=\"inline\"\u002F\u003E, то шансы на успех «Ветерка» составят \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F578\u002F281\u002Fd89\u002F578281d8997e0a562a02dd61422d408e.svg\" alt=\"$4$\" data-tex=\"inline\"\u002F\u003E к \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc61\u002F27e\u002Fd7b\u002Fc6127ed7b7116b2c9a29e8e238568254.svg\" alt=\"$(0.8\u002F(1-0.8))$\" data-tex=\"inline\"\u002F\u003E и наоборот, зная шансы, нам не составит труда вычислить вероятность \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcc6\u002Ff03\u002F35e\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\" alt=\"$p_+$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe94\u002F750\u002F131\u002Fe9475013121faba30996b549a41012e4.svg\" alt=\"$\\frac{p_+}{1-p_+} = 4 \\mkern 15mu \\Longrightarrow \\mkern 15mu p_+=4(1-p_+) \\mkern 15mu \\Longrightarrow \\mkern 15mu 5p_+=4 \\mkern 15mu \\Longrightarrow \\mkern 15mu p_+=0.8 $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаким образом, мы научились «переводить» вероятность в шансы, которые принимают значения от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb0b\u002F232\u002Ff34\u002Fb0b232f343595119559cf1186dd5f4a7.svg\" alt=\"$+\\infty$\" data-tex=\"inline\"\u002F\u003E. Сделаем еще один шаг и научимся «переводить» вероятность на всю числовую прямую от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6d\u002F1e2\u002Fab7\u002Fd6d1e2ab791a06785be738fe3a3a4f9d.svg\" alt=\"$-\\infty$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb0b\u002F232\u002Ff34\u002Fb0b232f343595119559cf1186dd5f4a7.svg\" alt=\"$+\\infty$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EШаг 2. Переведем значения вероятности в диапазон \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F80b\u002F03c\u002Fcfd\u002F80b03ccfdd0e8cb84e222715755ccf26.svg\" alt=\"$(-\\infty,+\\infty)$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nШаг этот очень простой — прологарифмируем шансы по основанию числа Эйлера \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5ca\u002F4b8\u002Fca1\u002F5ca4b8ca180f7495da819508f8afce6e.svg\" alt=\"$e$\" data-tex=\"inline\"\u002F\u003E и получим:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3b2\u002F5f5\u002F4ec\u002F3b25f54ec24ac9790536a5bfcdb7dcbd.svg\" alt=\"$f(w,x_i)=\\vec{w}^T\\vec{x}=ln(odds_+)$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь мы знаем, что если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc7e\u002F327\u002Fed9\u002Fc7e327ed9d8fd93eb5907c962f2f0328.svg\" alt=\"$p_+=0.8$\" data-tex=\"inline\"\u002F\u003E, то вычислить значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E будет очень просто и, более того, оно должно быть положительным: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d2\u002F7d3\u002Fbdb\u002F1d27d3bdb1b03bf2039cce88af50c550.svg\" alt=\"$f(w,x_i)=ln(odds_+)=ln(0.8\u002F0.2)=ln(4) \\approx +1.38629$\" data-tex=\"inline\"\u002F\u003E. Так и есть.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРади любопытства проверим, что если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd2c\u002Fbf7\u002F357\u002Fd2cbf7357ab08df200b02965bbb4ab7d.svg\" alt=\"$p_+=0.2$\" data-tex=\"inline\"\u002F\u003E, тогда мы ожидаем увидеть отрицательное значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E. Проверяем: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc6d\u002F3a5\u002Fe80\u002Fc6d3a5e8054aff891d32c89f4ee0c644.svg\" alt=\"$f(w,x_i)=ln(0.2\u002F0.8)=ln(0.25) \\approx -1.38629$\" data-tex=\"inline\"\u002F\u003E. Все верно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь мы знаем как перевести значение вероятности от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E на всю числовую прямую от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6d\u002F1e2\u002Fab7\u002Fd6d1e2ab791a06785be738fe3a3a4f9d.svg\" alt=\"$-\\infty$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb0b\u002F232\u002Ff34\u002Fb0b232f343595119559cf1186dd5f4a7.svg\" alt=\"$+\\infty$\" data-tex=\"inline\"\u002F\u003E. В следующем шаге сделаем все наоборот.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА пока, отметим, что в соответствии с правилами логарифмирования, зная значение функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E, можно вычислить шансы: \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F833\u002F9ae\u002F0b9\u002F8339ae0b9d7645bc12a507a4ac54cf5d.svg\" alt=\"$odds_+ = e^{f(w,x_i)} = e^{\\vec{w}^T\\vec{x}}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭтот способ определения шансов нам пригодится на следующем шаге.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EШаг 3. Выведем формулу для определения \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcc6\u002Ff03\u002F35e\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\" alt=\"$p_+$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nИтак, мы научились, зная \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcc6\u002Ff03\u002F35e\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\" alt=\"$p_+$\" data-tex=\"inline\"\u002F\u003E, находить значения функции \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E. Однако, на самом деле нам нужно все с точностью до наоборот — зная значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E находить \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcc6\u002Ff03\u002F35e\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\" alt=\"$p_+$\" data-tex=\"inline\"\u002F\u003E. Для этого обратимся к такому понятию как обратная функция шансов, в соответствии с которой:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F998\u002Fca3\u002F299\u002F998ca3299c7f4129d6975ea34d17809a.svg\" alt=\"$p_+ = \\frac{odds_+}{1+odds_+} $\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ статье мы не будем выводить вышеобозначенную формулу, но проверим на цифрах из примера выше. Мы знаем, что при шансах равными 4 к 1 (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff0f\u002Fe94\u002F423\u002Ff0fe944236e68f60b16034803d6f1823.svg\" alt=\"$odds_+=4$\" data-tex=\"inline\"\u002F\u003E), вероятность наступления события равна 0.8 (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc7e\u002F327\u002Fed9\u002Fc7e327ed9d8fd93eb5907c962f2f0328.svg\" alt=\"$p_+=0.8$\" data-tex=\"inline\"\u002F\u003E). Сделаем подстановку: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F84e\u002F9ac\u002F43b\u002F84e9ac43b312c23b9b1f4df072eef404.svg\" alt=\"$p_+=\\frac{4}{1+4}=0.8$\" data-tex=\"inline\"\u002F\u003E. Это совпадает с нашими вычислениями, проведенными ранее. Двигаемся далее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа прошлом шаге мы вывели, что \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F8a4\u002F3e6\u002Fbe5\u002F8a43e6be57441a31f74f074ea308af36.svg\" alt=\"$odds_+ = e^{\\vec{w}^T\\vec{x}}$\" data-tex=\"inline\"\u002F\u003E, а значит можно сделать замену в обратной функции шансов. Получим:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa63\u002Fd3d\u002F38a\u002Fa63d3d38ab1e837cefce61df83c7462e.svg\" alt=\"$p_+ = \\frac{e^{\\vec{w}^T\\vec{x}}}{1+e^{\\vec{w}^T\\vec{x}}}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРазделим и числитель и знаменатель на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F581\u002Fdfc\u002F94f\u002F581dfc94f691212b843d5ca4ceb6cd9e.svg\" alt=\"$e^{\\vec{w}^T\\vec{x}}$\" data-tex=\"inline\"\u002F\u003E, тогда:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6c6\u002Fdea\u002F0d6\u002F6c6dea0d6895ca8fd36155c626096403.svg\" alt=\"$p_+ = \\frac{1}{1+e^{-\\vec{w}^T\\vec{x}}} = \\sigma(\\vec{w}^T\\vec{x})$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа всякий пожарный, дабы убедиться, что мы нигде не ошиблись, сделаем еще одну небольшую проверку. На шаге 2, мы для \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc7e\u002F327\u002Fed9\u002Fc7e327ed9d8fd93eb5907c962f2f0328.svg\" alt=\"$p_+=0.8$\" data-tex=\"inline\"\u002F\u003E определили, что \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa12\u002F825\u002F840\u002Fa128258409b83f835e4ec02da427bfcf.svg\" alt=\"$f(w,x_i) \\approx +1.38629$\" data-tex=\"inline\"\u002F\u003E. Тогда, подставив значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E в функцию логистического отклика, мы ожидаем получить \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc7e\u002F327\u002Fed9\u002Fc7e327ed9d8fd93eb5907c962f2f0328.svg\" alt=\"$p_+=0.8$\" data-tex=\"inline\"\u002F\u003E. Подставляем и получаем: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc25\u002F62f\u002F5ef\u002Fc2562f5ef0d27f9097183c0938c48b52.svg\" alt=\"$p_+=\\frac{1}{1+e^{-1.38629}}=0.8$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПоздравляю вас, уважаемый читатель, мы только что вывели и протестировали функцию логистического отклика. Давайте посмотрим на график функции.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nГрафик 3 «Функция логистического отклика»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fks\u002Fby\u002F4c\u002Fksby4cvyvhchnyw3g7mogrucage.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fks\u002Fby\u002F4c\u002Fksby4cvyvhchnyw3g7mogrucage.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для отрисовки графика\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport math\n\ndef logit (f):\n    return 1\u002F(1+math.exp(-f))\n\nf = np.arange(-7,7,0.05)\np = []\n\nfor i in f:\n    p.append(logit(i))\n\nfig, axes = plt.subplots(figsize = (14,6), dpi = 80)\nplt.plot(f, p, color = 'grey', label = '$ 1 \u002F (1+e^{-w^Tx_i})$')\nplt.xlabel('$f(w,x_i) = w^Tx_i$', size = 16)\nplt.ylabel('$p_{i+}$', size = 16)\nplt.legend(prop = {'size': 14})\nplt.show()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВ литературе также можно встретить название данной функции как \u003Ci\u003Eсигмоид-функция\u003C\u002Fi\u003E. По графику хорошо заметно, что основное изменение вероятности принадлежности объекта к классу происходит на относительно небольшом диапазоне \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a9\u002Fd9b\u002F7c3\u002F4a9d9b7c3a796b664147c4267469a945.svg\" alt=\"$f(w,x_i)$\" data-tex=\"inline\"\u002F\u003E, где-то от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F712\u002F33f\u002F9da\u002F71233f9da088a69f4f80e0a824f0bd91.svg\" alt=\"$-4$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4c0\u002Fd80\u002Fe6b\u002F4c0d80e6b4c4049ac52c22fd0d27637e.svg\" alt=\"$+4$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредлагаю вернуться к нашему кредитному аналитику и помочь ему с вычислением вероятности погашения кредитов, иначе он рискует остаться без премии :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаблица 2 «Потенциальные заемщики»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F10\u002Ftg\u002F7r\u002F10tg7rztpblsl8swwgjzmlgtwlo.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F10\u002Ftg\u002F7r\u002F10tg7rztpblsl8swwgjzmlgtwlo.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для формирования таблицы\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eproba = []\nfor i in df['f(w,x)']:\n    proba.append(round(logit(i),2))\n    \ndf['Probability'] = proba\n\ndf[['The borrower', 'Salary', 'Payment', 'f(w,x)', 'Decision', 'Probability']]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nИтак, вероятность возврата кредита мы определили. В целом, это похоже на правду. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДействительно, вероятность того что Вася при зарплате в 120.000Р сможет ежемесячно отдавать в банк 3.000Р близка к 100%. Кстати, мы должны понимать, что банк может выдать кредит и Леше в том случае, если политикой банка предусмотрено, например, кредитовать клиентов с вероятностью возврата кредита более, ну скажем, 0.3. Просто в таком случае банк сформирует больший резерв под возможные потери.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТакже следует отметить, что соотношение зарплаты к платежу не менее 3 и с запасом в 5.000Р было взято с потолка. Поэтому нам нельзя было использовать в первоначальном виде вектор весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fefe\u002F096\u002F7c6\u002Fefe0967c69a87a9a7f693fd242b72387.svg\" alt=\"$\\vec w = (-5000,1,-3)$\" data-tex=\"inline\"\u002F\u003E. Нам требовалось сильно уменьшить коэффициенты и в таком случае мы разделили каждый коэффициент на 25.000, то есть по сути мы подогнали результат. Но это сделано было специально, чтобы упростить понимание материала на начальном этапе. В жизни, же нам потребуется не выдумывать и подгонять коэффициенты, а находить их. Как раз в следующих разделах статьи мы выведем уравнения, с помощью которых подбираются параметры \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003E04. Метод наименьших квадратов при определении вектора весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E в функции логистического отклика\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nНам уже известен такой метод подбора вектора весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E, как \u003Ci\u003Eметод наименьших квадратов (МНК)\u003C\u002Fi\u003E и собственно, почему бы нам тогда не использовать его в задачах бинарной классификации? Действительно, ничто не мешает использовать \u003Ci\u003EМНК\u003C\u002Fi\u003E, только вот данный способ в задачах классификации дает результаты менее точные, нежели \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E. Этому есть теоретическое обоснование. Давайте для начала посмотрим на один простой пример.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредположим, что наши модели (использующие \u003Ci\u003EMSE\u003C\u002Fi\u003E и \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E) уже начали подбор вектора весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E и мы остановили расчет на каком-то шаге. Неважно, в середине, в конце или в начале, главное, что у нас уже есть какие-то значения вектора весов и допустим, что на этом шаге, вектора весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E для обеих моделей не имеют различий. Тогда возьмем полученные веса и подставим их в \u003Ci\u003Eфункцию логистического отклика\u003C\u002Fi\u003E (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcd6\u002F887\u002F374\u002Fcd6887374d65ca7e0699f041a7654ae1.svg\" alt=\"$\\frac{1}{1+e^{-\\vec{w}^T\\vec{x}}}$\" data-tex=\"inline\"\u002F\u003E) для какого-нибудь объекта, который относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E. Исследуем два случая, когда в соответствии с подобранным вектором весов наша модель сильно ошибается и наоборот — модель сильно уверена в том, что объект относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E. Посмотрим какие штрафы будут «выписаны» при использовании \u003Ci\u003EМНК \u003C\u002Fi\u003Eи \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для расчета штрафов в зависимости от используемой функции потерь\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003E# класс объекта\ny = 1\n# вероятность отнесения объекта к классу в соответствии с параметрами w\nproba_1 = 0.01\n\nMSE_1 = (y - proba_1)**2\nprint 'Штраф MSE при грубой ошибке =', MSE_1\n\n# напишем функцию для вычисления f(w,x) при известной вероятности отнесения объекта к классу +1 (f(w,x)=ln(odds+))\ndef f_w_x(proba):\n    return math.log(proba\u002F(1-proba)) \n\nLogLoss_1 = math.log(1+math.exp(-y*f_w_x(proba_1)))\nprint 'Штраф Log Loss при грубой ошибке =', LogLoss_1\n\nproba_2 = 0.99\n\nMSE_2 = (y - proba_2)**2\nLogLoss_2 = math.log(1+math.exp(-y*f_w_x(proba_2)))\n\nprint '**************************************************************'\nprint 'Штраф MSE при сильной уверенности =', MSE_2\nprint 'Штраф Log Loss при сильной уверенности =', LogLoss_2\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EСлучай с грубой ошибкой\u003C\u002Fb\u003E — модель относит объект к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E с вероятностью в 0,01\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nШтраф при использовании \u003Ci\u003EМНК \u003C\u002Fi\u003Eсоставит: \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F443\u002F801\u002F8cd\u002F4438018cd3c35de475a419ecf521c389.svg\" alt=\"$MSE = (y - p_+) = (1-0.01)^2 = 0.9801$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nШтраф при использовании \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E составит: \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5c8\u002F4b2\u002F2b7\u002F5c84b22b7edd29e66fd652a658254ec0.svg\" alt=\"$Log Loss = log_e(1+e^{-yf(w,x)}) = log_e(1+e^{-1(-4.595...)}) \\approx 4.605$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EСлучай с сильной уверенностью\u003C\u002Fb\u003E — модель относит объект к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E с вероятностью в 0,99\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nШтраф при использовании \u003Ci\u003EМНК\u003C\u002Fi\u003E составит: \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F818\u002F0dc\u002Ff31\u002F8180dcf31c8787d11205a3b3536e2900.svg\" alt=\"$MSE = (1-0.99)^2 = 0.0001$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nШтраф при использовании \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E составит: \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F005\u002Fad0\u002Fd51\u002F005ad0d512f20ff825d820bdbd26ba7f.svg\" alt=\"$Log Loss = log_e(1+e^{-4.595...}) \\approx 0.01 $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭтот пример хорошо иллюстрирует, что при грубой ошибке функция потерь \u003Ci\u003ELog Loss\u003C\u002Fi\u003E штрафует модель значительно сильнее, чем \u003Ci\u003EMSE\u003C\u002Fi\u003E. Давайте теперь разберемся, каковы теоретические предпосылки использования функции потерь \u003Ci\u003ELog Loss\u003C\u002Fi\u003E в задачах классификации.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003E05. Метод максимального правдоподобия и логистическая регрессия\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nКак и было обещано в начале, статья изобилует простыми примерами. В студии очередной пример и старые гости — заемщики банка: Вася, Федя и Леша. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа всякий пожарный, перед тем как развивать пример, напомню, что в жизни мы имеем дело с обучающей выборкой из тысяч или миллионов объектов с десятками или сотнями признаков. Однако здесь цифры взяты так, чтобы они легко укладывались в голове начинающего датасайнтеста. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозвращаемся к примеру. Представим, что директор банка решил выдать кредит всем нуждающимся, несмотря на то, что алгоритм подсказывал не выдавать его Леше. И вот прошло достаточно времени и нам стало известно кто из трех героев погасил кредит, а кто нет. Что и следовало ожидать: Вася и Федя погасили кредит, а Леша — нет. Теперь давайте представим, что этот результат будет для нас новой обучающей выборкой и, при этом у нас как будто исчезли все данные о факторах, влияющих на вероятность погашения кредита (зарплата заемщика, размер ежемесячного платежа). Тогда интуитивно мы можем полагать, что каждый третий заемщик не возвращает банку кредит или другими словами вероятность возврата кредита следующим заемщиком \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe64\u002Fafb\u002Fa2b\u002Fe64afba2b591c3b84beebfc496e12c51.svg\" alt=\"$p=\\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E. Этому интуитивному предположению есть теоретическое подтверждение и основывается оно на \u003Ci\u003Eметоде максимального правдоподобия\u003C\u002Fi\u003E, часто в литературе его называют \u003Ci\u003Eпринципом максимального правдоподобия\u003C\u002Fi\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля начала познакомимся с понятийным аппаратом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EПравдоподобие выборки\u003C\u002Fi\u003E — это вероятность получения именно такой выборки, получения именно таких наблюдений \u002F результатов, т.е. произведение вероятностей получения каждого из результатов выборки (например, погашен или не погашен кредит Васей, Федей и Лешей одновременно). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EФункция правдоподобия\u003C\u002Fi\u003E связывает правдоподобие выборки со значениями параметров распределения. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ нашем случае, обучающая выборка представляет собой обобщённую схему Бернулли, в которой случайная величина принимает всего два значения: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E. Следовательно, правдоподобие выборки можно записать как функцию правдоподобия от параметра \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E следующим образом:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd0b\u002F857\u002Fb4e\u002Fd0b857b4ee991737b3ec7dbd1407cacb.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) = \\prod\\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)} \\mkern 5mu = \\mkern 5mu p^1(1-p)^{1-1} \\centerdot p^1(1-p)^{1-1} \\centerdot p^0(1-p)^{1-0} \\mkern 5mu = $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fedf\u002Ffd0\u002Ff08\u002Fedffd0f0825aef6a235b500fb1b87584.svg\" alt=\"$ = \\mkern 5mu p \\centerdot p \\centerdot (1-p) \\mkern 5mu = \\mkern 5mu p^2(1-p)$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВышеуказанную запись можно интерпретировать так. Совместная вероятность того, что Вася и Федя погасят кредит равна \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fad1\u002Fc0a\u002F9f6\u002Fad1c0a9f6ac079079f55104222ff7a13.svg\" alt=\"$p \\centerdot p = p^2$\" data-tex=\"inline\"\u002F\u003E, вероятность того что Леша НЕ погасит кредит равна \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd47\u002Fc89\u002F4c4\u002Fd47c894c4276b3f3b8b5fe9158ab0cfe.svg\" alt=\"$1-p$\" data-tex=\"inline\"\u002F\u003E (так как имело место именно НЕ погашение кредита), следовательно совместная вероятность всех трех событий равна \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdaf\u002F63d\u002F647\u002Fdaf63d6479f73e4d3402348866d62dbf.svg\" alt=\"$p^2(1-p)$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EМетод максимального правдоподобия\u003C\u002Fi\u003E — это метод оценки неизвестного параметра путём максимизации \u003Ci\u003Eфункции правдоподобия\u003C\u002Fi\u003E. В нашем случае требуется найти такое значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E, при котором \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffb3\u002Fa6d\u002F4e4\u002Ffb3a6d4e4b9ab34c577d6e5ddc7cb395.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) = p^2(1-p)$\" data-tex=\"inline\"\u002F\u003E достигает максимума. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОткуда собственно идея – искать значение неизвестного параметра, при котором функция правдоподобия достигает максимума? Истоки идеи проистекают из представления о том, что выборка – это единственный, доступный нам, источник знания о генеральной совокупности. Все, что нам известно о генеральной совокупности, представлено в выборке. Поэтому, все, что мы можем сказать, так это то, что выборка – это наиболее точное отражение генеральной совокупности, доступное нам. Следовательно, нам требуется найти такой параметр, при котором имеющаяся выборка становится наиболее вероятной.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОчевидно, мы имеем дело с оптимизационной задачей, в которой требуется найти точку экстремума функции. Для нахождения точки экстремума необходимо рассмотреть условие первого порядка, то есть приравнять производную функции к нулю и решить уравнение относительно искомого параметра. Однако поиски производной произведения большого количества множителей могут оказаться делом затяжным, чтобы этого избежать существует специальный прием — переход к логарифму \u003Ci\u003Eфункции правдоподобия\u003C\u002Fi\u003E. Почему возможен такой переход? Обратим внимание на то, что мы ищем не сам экстремум функции\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff8a\u002F1c5\u002F0ed\u002Ff8a1c50ed39505a982ca83ce75812904.svg\" alt=\"$ P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p)$\" data-tex=\"inline\"\u002F\u003E, а точку экстремума, то есть то значение неизвестного параметра \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E, при котором \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff8a\u002F1c5\u002F0ed\u002Ff8a1c50ed39505a982ca83ce75812904.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p)$\" data-tex=\"inline\"\u002F\u003E достигает максимума. При переходе к логарифму точка экстремума не меняется (хотя сам экстремум будет отличаться), так как логарифм — монотонная функция.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДавайте, в соответствии с вышеизложенным, продолжим развивать наш пример с кредитами у Васи, Феди и Леши. Для начала перейдем к \u003Ci\u003Eлогарифму функции правдоподобия\u003C\u002Fi\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff8e\u002Fca7\u002Fd90\u002Ff8eca7d90ef3968c1680a1be4dc64103.svg\" alt=\"$logP(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) \\mkern 5mu = \\mkern 5mu logp^2(1-p) \\mkern 5mu = \\mkern 5mu 2logp + log(1-p)$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь мы можем с легкостью продифференцировать выражение по \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F139\u002F181\u002Fad0\u002F139181ad0acdf2d6d84dcf662097019a.svg\" alt=\"$\\frac{\\partial logP(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p)}{\\partial p} \\mkern 5mu = \\mkern 5mu \\frac{\\partial}{\\partial p} (2logp + log(1-p)) \\mkern 5mu = \\mkern 5mu \\frac{2}{p} - \\frac{1}{1-p}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИ наконец, рассмотрим условие первого порядка — приравняем производную функции к нулю:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F832\u002Ffa7\u002Fc30\u002F832fa7c3084c0110a5e3d7621631a1fc.svg\" alt=\"$\\frac{2}{p} - \\frac{1}{1-p} = 0 \\mkern 5mu \\Longrightarrow \\mkern 5mu \\frac{2}{p} = \\frac{1}{1-p} \\mkern 5mu \\Longrightarrow \\mkern 5mu 2(1-p) = p \\mkern 5mu \\Longrightarrow \\mkern 5mu p = \\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаким образом, наша интуитивная оценка вероятности погашения кредита \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe64\u002Fafb\u002Fa2b\u002Fe64afba2b591c3b84beebfc496e12c51.svg\" alt=\"$p = \\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E была теоретически обоснована.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОтлично, но что нам теперь делать с такой информацией? Если мы будем считать, что каждый третий заемщик не вернет банку деньги, то последний неизбежно разорится. Так-то оно так, да только при оценке вероятности погашения кредита равной \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F919\u002Fa65\u002Fb66\u002F919a65b6676bcd796279a8aac6163a7a.svg\" alt=\"$\\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E мы не учли факторы, влияющие на возврат кредита: заработная плата заемщика и размер ежемесячного платежа. Вспомним, что ранее мы рассчитали вероятность возврата кредита каждым клиентом с учетом этих самых факторов. Логично, что и вероятности у нас получились отличные от константы равной \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F919\u002Fa65\u002Fb66\u002F919a65b6676bcd796279a8aac6163a7a.svg\" alt=\"$\\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДавайте определим правдоподобие выборок:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКод для расчетов правдоподобий выборок\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Efrom functools import reduce\n\ndef likelihood(y,p):\n    line_true_proba = []\n    for i in range(len(y)):\n        ltp_i = p[i]**y[i]*(1-p[i])**(1-y[i])\n        line_true_proba.append(ltp_i)\n    likelihood = []\n    return reduce(lambda a, b: a*b, line_true_proba)\n        \n    \ny = [1.0,1.0,0.0]\np_log_response = df['Probability']\nconst = 2.0\u002F3.0\np_const = [const, const, const]\n\n\nprint 'Правдоподобие выборки при константном значении p=2\u002F3:', round(likelihood(y,p_const),3)\n\nprint '****************************************************************************************************'\n\nprint 'Правдоподобие выборки при расчетном значении p:', round(likelihood(y,p_log_response),3)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EПравдоподобие выборки при константном значении \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe64\u002Fafb\u002Fa2b\u002Fe64afba2b591c3b84beebfc496e12c51.svg\" alt=\"$p=\\frac{2}{3}$\" data-tex=\"inline\"\u002F\u003E:\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe47\u002Fb36\u002Fa76\u002Fe47b36a76b99b13313aff0043d484c77.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) \\mkern 5mu = \\mkern 5mu p^2(1-p) \\mkern 5mu = \\mkern 5mu \\frac{2}{3}^2(1-\\frac{2}{3}) \\mkern 5mu \\approx \\mkern 5mu 0.148 $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EПравдоподобие выборки при расчете вероятности погашения кредита с учетом факторов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcca\u002F29f\u002Fb6c\u002Fcca29fb6c52655a8f94f7bbe703f11c7.svg\" alt=\"$\\vec{x}$\" data-tex=\"inline\"\u002F\u003E:\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F72f\u002F090\u002F8f0\u002F72f0908f0f53ffc3a54f80d75d3fb568.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) = \\prod\\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)} \\mkern 5mu = \\mkern 5mu p_1^1(1-p_1)^{1-1} \\centerdot p_2^1(1-p_2)^{1-1} \\centerdot p_3^0(1-p_3)^{1-0} \\mkern 5mu = $\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F27f\u002F4f6\u002F6c3\u002F27f4f66c312aa01b7a3501d94baa0c49.svg\" alt=\"$ = \\mkern 5mu p_1 \\centerdot p_2 \\centerdot (1-p_3) \\mkern 5mu = \\mkern 5mu 0.99 \\centerdot 0.73 \\centerdot (1-0.45) \\mkern 5mu \\approx \\mkern 5mu 0.397$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПравдоподобие выборки с вероятностью, посчитанной в зависимости от факторов оказалось выше правдоподобия при константном значении вероятности. О чем это говорит? Это говорит о том, что знания о факторах позволили подобрать более точно вероятность погашения кредита для каждого клиента. Поэтому, при выдаче очередного кредита, правильнее будет использовать, предложенную в конце 3-го раздела статьи, модель оценки вероятности погашения задолженности. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо тогда, если нам требуется максимизировать \u003Ci\u003Eфункцию правдоподобия выборки\u003C\u002Fi\u003E, то почему бы не использовать какой-нибудь алгоритм, который будет выдавать вероятности для Васи, Феди и Леши, например, равными 0.99, 0.99 и 0.01 соответственно. Возможно такой алгоритм и хорошо себя проявит на обучающей выборке, так как приблизит значение правдоподобия выборки к \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E, но, во-первых, у такого алгоритма будут, скорее всего трудности с обобщающей способностью, во-вторых, этот алгоритм будет точно не линейным. И если, методы борьбы с переобучением (равно слабая обобщающая способность) явно не входят в план этой статьи, то по второму пункту давайте пройдемся подробнее. Для этого, достаточно ответить на простой вопрос. Может ли вероятность погашения кредита Васей и Федей быть одинаковой с учетом известных нам факторов? С точки зрения здравой логики конечно же нет, не может. Так на погашение кредита Вася будет отдавать 2.5% своей зарплаты в месяц, а Федя — почти 27,8%. Также на графике 2 «Классификация клиентов» мы видим, что Вася находится значительно дальше от линии, разделяющей классы, чем Федя. Ну и наконец, мы знаем, что функция \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fee0\u002Fc6f\u002Ffe8\u002Fee0c6ffe8a8600fd1cbf065d96aef5ee.svg\" alt=\"$f(w,x) = w_0 + w_1x_1 + w_2x_2$\" data-tex=\"inline\"\u002F\u003E для Васи и Феди принимает различные значения: 4.24 для Васи и 1.0 для Феди. Вот если бы Федя, например, зарабатывал на порядок больше или кредит поменьше просил, то тогда вероятности погашения кредита у Васи и Феди были бы схожими. Другими словами, линейную зависимость не обманешь. И если бы мы действительно рассчитали коэффициенты \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E, а не взяли их с потолка, то могли бы смело заявить, что наши значения \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E лучше всего позволяют оценить вероятность погашения кредита каждым заемщиком, но так как мы условились считать, что определение коэффициентов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E было проведено по всем правилам, то мы так и будем считать — наши коэффициенты позволяют дать лучшую оценку вероятности :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОднако мы отвлеклись. В этом разделе нам надо разобраться как определяется вектор весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E, который необходим для оценки вероятности возврата кредита каждым заемщиком. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКратко резюмируем, с каким арсеналом мы выступаем на поиски коэффициентов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1. Мы предполагаем, что зависимость между целевой переменной (прогнозным значением) и фактором, оказывающим влияние на результат — линейная. По этой причине применяется \u003Ci\u003Eфункция линейной регрессии\u003C\u002Fi\u003E вида \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd9e\u002Ff57\u002F1ce\u002Fd9ef571ce10aee3f03bdbda6593efa25.svg\" alt=\"$f(w,x) = \\vec{w}^TX$\" data-tex=\"inline\"\u002F\u003E, линия которого делит объекты (клиентов) на классы \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E (клиенты, способные погасить кредит и не способные). В нашем случае уравнение имеет вид \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fee0\u002Fc6f\u002Ffe8\u002Fee0c6ffe8a8600fd1cbf065d96aef5ee.svg\" alt=\"$f(w,x) = w_0 + w_1x_1 + w_2x_2$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2. Мы используем \u003Ci\u003Eфункцию обратного логит-преобразования\u003C\u002Fi\u003E вида \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6c6\u002Fdea\u002F0d6\u002F6c6dea0d6895ca8fd36155c626096403.svg\" alt=\"$p_+ = \\frac{1}{1+e^{-\\vec{w}^T\\vec{x}}} = \\sigma(\\vec{w}^T\\vec{x})$\" data-tex=\"inline\"\u002F\u003E для определения вероятности принадлежности объекта к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3. Мы рассматриваем нашу обучающую выборку как реализацию обобщенной \u003Ci\u003Eсхемы Бернулли\u003C\u002Fi\u003E, то есть для каждого объекта генерируется случайная величина, которая с вероятностью \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E (своей для каждого объекта) принимает значение 1 и с вероятностью \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc60\u002F0eb\u002F78d\u002Fc600eb78d0627ef7e91964968ce726ab.svg\" alt=\"$(1–p)$\" data-tex=\"inline\"\u002F\u003E – 0.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4. Мы знаем, что нам требуется максимизировать \u003Ci\u003Eфункцию правдоподобия выборки\u003C\u002Fi\u003E с учетом принятых факторов для того, чтобы имеющаяся выборка стала наиболее правдоподобной. Другими словами, нам нужно подобрать такие параметры, при которых выборка будет наиболее правдоподобной. В нашем случае подбираемый параметр — это вероятность погашения кредита \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E, которая в свою очередь зависит от неизвестных коэффициентов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E. Значит нам требуется найти такой вектор весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E, при котором правдоподобие выборки будет максимальным.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n5. Мы знаем, что для максимизации \u003Ci\u003Eфункции правдоподобия выборки\u003C\u002Fi\u003E можно использовать \u003Ci\u003Eметод максимального правдоподобия\u003C\u002Fi\u003E. И мы знаем все хитрые приемы для работы с этим методом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот такая многоходовочка получается :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА теперь вспомним, что в самом начале статьи мы хотели вывести два вида функции потерь \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E в зависимости от того как обозначаются классы объектов. Так повелось, что в задачах классификации с двумя классами, классы обозначают как \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E. В зависимости от обозначения, на выходе будет соответствующая функция потерь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EСлучай 1. Классификация объектов на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nРаннее, при определении правдоподобия выборки, в котором вероятность погашения задолженности заемщиком рассчитывалась исходя из факторов и заданных коэффициентов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E, мы применили формулу:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff3\u002Fc27\u002F3c6\u002Fff3c273c683dbcd3c7b00d2a071d6a7c.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu p) = \\prod\\limits_{i=1}^3 p^{y_i} (1-p)^{(1-y_i)}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа самом деле \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F08b\u002Fa9c\u002F561\u002F08ba9c56140cf603308f9b84a26dc818.svg\" alt=\"$p_i$\" data-tex=\"inline\"\u002F\u003E — это значение \u003Ci\u003Eфункции логистического отклика\u003C\u002Fi\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6c6\u002Fdea\u002F0d6\u002F6c6dea0d6895ca8fd36155c626096403.svg\" alt=\"$p_+ = \\frac{1}{1+e^{-\\vec{w}^T\\vec{x}}} = \\sigma(\\vec{w}^T\\vec{x})$\" data-tex=\"inline\"\u002F\u003E при заданном векторе весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F734\u002Fc62\u002F0a1\u002F734c620a1b0b841a33c195da2b9eea42.svg\" alt=\"$\\vec{w}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТогда нам ничто не мешает записать функцию правдоподобия выборки так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd07\u002Ff1d\u002Fa80\u002Fd07f1da809e6567bb1d0c45ee267aef7.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu \\sigma(\\vec{w}^TX)) \\mkern 5mu = \\mkern 5mu \\prod\\limits_{i=1}^n \\sigma(\\vec{w}^T\\vec{x_i})^{y_i} \\mkern 10mu (1-\\sigma(\\vec{w}^T\\vec{x_i})^{(1-y_i)} \\mkern 10mu \\rightarrow \\mkern 10mu max$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБывает так, что иногда, некоторым начинающим аналитикам сложно сходу понять, как эта функция работает. Давайте рассмотрим 4 коротких примера, которые все прояснят:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E1. \u003C\u002Fb\u003EЕсли \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F577\u002F682\u002F05c\u002F57768205c03a5547a4d44277f9c9d441.svg\" alt=\"$y_i = +1$\" data-tex=\"inline\"\u002F\u003E (т.е. в соответствии с обучающей выборкой объект относится к классу +1), а наш алгоритм \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Feb8\u002Fe5d\u002Fbae\u002Feb8e5dbae515dac15b124967e822d9b9.svg\" alt=\"$\\sigma(\\vec{w}^TX))$\" data-tex=\"inline\"\u002F\u003E определяет вероятность отнесения объекта к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E равной 0.9, то вот этот кусочек правдоподобия выборки будет рассчитываться так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F50b\u002Fe11\u002F495\u002F50be114953cd6d5bc76bbb62189f8b1b.svg\" alt=\"$0.9^1 \\centerdot (1-0.9)^{(1-1)}= 0.9^1 \\centerdot 0.1^0 = 0.9$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E2.\u003C\u002Fb\u003E Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F577\u002F682\u002F05c\u002F57768205c03a5547a4d44277f9c9d441.svg\" alt=\"$y_i = +1$\" data-tex=\"inline\"\u002F\u003E, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff2d\u002F4d0\u002F64a\u002Ff2d4d064aa2bf94950efb5b08c371248.svg\" alt=\"$\\sigma(\\vec{w}^TX)) = 0.1$\" data-tex=\"inline\"\u002F\u003E, то расчет будет таким:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff5e\u002F477\u002F412\u002Ff5e477412164fb26f86f1919a3280d08.svg\" alt=\"$0.1^1 \\centerdot (1-0.1)^{(1-1)}= 0.1^1 \\centerdot 0.9^0 = 0.1$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E3. \u003C\u002Fb\u003EЕсли \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F961\u002F5a3\u002Fc22\u002F9615a3c22f2f2616e78ffa70509cb3aa.svg\" alt=\"$y_i = 0$\" data-tex=\"inline\"\u002F\u003E, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff2d\u002F4d0\u002F64a\u002Ff2d4d064aa2bf94950efb5b08c371248.svg\" alt=\"$\\sigma(\\vec{w}^TX)) = 0.1$\" data-tex=\"inline\"\u002F\u003E, то расчет будет таким:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002F337\u002Fa20\u002F784337a20607f4c11e39bdf873b1136a.svg\" alt=\"$0.1^0 \\centerdot (1-0.1)^{(1-0)}= 0.1^0 \\centerdot 0.9^1 = 0.9$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E4.\u003C\u002Fb\u003E Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F961\u002F5a3\u002Fc22\u002F9615a3c22f2f2616e78ffa70509cb3aa.svg\" alt=\"$y_i = 0$\" data-tex=\"inline\"\u002F\u003E, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F0cf\u002Fb19\u002Fbe5\u002F0cfb19be54f9e85b2b01e516230de60c.svg\" alt=\"$\\sigma(\\vec{w}^TX)) = 0.9$\" data-tex=\"inline\"\u002F\u003E, то расчет будет таким:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb2d\u002Ff21\u002F037\u002Fb2df210378053a29907debcb8e4594e9.svg\" alt=\"$0.9^0 \\centerdot (1-0.9)^{(1-0)}= 0.9^0 \\centerdot 0.1^1 = 0.1$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОчевидно, что функция правдоподобия будет максимизироваться в случаях 1 и 3 или в общем случае — при правильно отгаданных значениях вероятностей отнесения объекта к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ связи с тем, что при определении вероятности отнесения объекта к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E нам не известны только коэффициенты \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E, то мы их и будем искать. Как и говорилось выше, это задача оптимизации, в которой для начала нам требуется найти производную от функции правдоподобия по вектору весов \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E. Однако предварительно имеет смысл упростить себе задачу: производную будем искать от логарифма \u003Ci\u003Eфункции правдоподобия\u003C\u002Fi\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F6cd\u002F3e7\u002Fa4e\u002F6cd3e7a4e1762efb4733a1ef7d0047de.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-y_i \\mkern 2mu log_e \\mkern 5mu \\sigma(\\vec{w}^T \\vec{x_i}) - (1-y_i) \\mkern 2mu log_e \\mkern 5mu (1 - \\sigma(\\vec{w}^T \\vec{x_i})) ) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\nПочему после логарифмирования, в \u003Ci\u003Eфункции логистической ошибки\u003C\u002Fi\u003E, мы поменяли знак с \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fae4\u002Fdc5\u002Fc6f\u002Fae4dc5c6fd4ec28ba4b81a2ec09d88b9.svg\" alt=\"$+$\" data-tex=\"inline\"\u002F\u003E на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd3d\u002Ff50\u002Fb83\u002Fd3df50b83f85c2e599b5a46b9d893c5e.svg\" alt=\"$-$\" data-tex=\"inline\"\u002F\u003E. Все просто, так как в задачах оценки качества модели принято минимизировать значение функции, то мы умножили правую часть выражения на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd3d\u002Ff50\u002Fb83\u002Fd3df50b83f85c2e599b5a46b9d893c5e.svg\" alt=\"$-$\" data-tex=\"inline\"\u002F\u003E и соответственно вместо максимизации, теперь минимизируем функцию.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСобственно, сейчас, на ваших глазах была много страдальчески выведена функция потерь — \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E для обучающей выборки с двумя классами: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь, для нахождения коэффициентов, нам потребуется всего лишь найти производную \u003Ci\u003Eфункции логистической ошибки\u003C\u002Fi\u003E и далее, используя численные методы оптимизации, такие как градиентный спуск или стохастический градиентный спуск, подобрать наиболее оптимальные коэффициенты \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1d0\u002F034\u002Fa09\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\" alt=\"$w$\" data-tex=\"inline\"\u002F\u003E. Но, учитывая, уже не малый объем статьи, предлагается провести дифференцирование самостоятельно или, быть может, это будет темой для следующей статьи с большим количеством арифметики без столь подробных примеров.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EСлучай 2. Классификация объектов на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nПодход здесь будет такой же, как и с классами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e4\u002Fc77\u002Fa6e\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\" alt=\"$1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9c\u002F3c8\u002Fe48\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\" alt=\"$0$\" data-tex=\"inline\"\u002F\u003E, но сама дорожка к выводу функции потерь \u003Ci\u003ELogistic Loss\u003C\u002Fi\u003E, будет более витиеватой. Приступаем. Будем для функции правдоподобия использовать оператор \u003Ci\u003E«если..., то...»\u003C\u002Fi\u003E. То есть, если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbf8\u002F3b5\u002F32c\u002Fbf83b532cd867d34004f8eded8c5c79a.svg\" alt=\"$i$\" data-tex=\"inline\"\u002F\u003E-ый объект относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E, то для расчета правдоподобия выборки используем вероятность \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E, если объект относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E, то в правдоподобие подставляем \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffd1\u002F184\u002F5be\u002Ffd11845becb97f0b8b77b8b6e081ae3f.svg\" alt=\"$(1-p)$\" data-tex=\"inline\"\u002F\u003E. Вот так выглядит функция правдоподобия:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4a1\u002F375\u002Fd87\u002F4a1375d876abb71c1dd376a63d13c727.svg\" alt=\"$P(\\mkern 5mu \\vec{y} \\mkern 5mu |\\mkern 5mu \\sigma(\\vec{w}^TX)) \\mkern 5mu = \\mkern 5mu \\prod\\limits_{i=1}^n \\sigma(\\vec{w}^T\\vec{x_i})^{[y_i=+1]} \\mkern 10mu (1-\\sigma(\\vec{w}^T\\vec{x_i})^{[y_i=-1])} \\mkern 10mu \\rightarrow \\mkern 10mu max$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа пальцах распишем как это работает. Рассмотрим 4 случая:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E1. \u003C\u002Fb\u003EЕсли \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F577\u002F682\u002F05c\u002F57768205c03a5547a4d44277f9c9d441.svg\" alt=\"$y_i=+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F569\u002Fd14\u002Fc6b\u002F569d14c6b282aa74ae81d7e57e25205d.svg\" alt=\"$\\sigma(\\vec{w}^T\\vec{x_i})=0.9$\" data-tex=\"inline\"\u002F\u003E, то в правдоподобие выборки «пойдет» \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff82\u002F7d8\u002F2db\u002Ff827d82db4267e554348e2466d45bba6.svg\" alt=\"$0.9$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E2.\u003C\u002Fb\u003E Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F577\u002F682\u002F05c\u002F57768205c03a5547a4d44277f9c9d441.svg\" alt=\"$y_i=+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F482\u002Fd62\u002Fb49\u002F482d62b4937323f4105296ea8c16acef.svg\" alt=\"$\\sigma(\\vec{w}^T\\vec{x_i})=0.1$\" data-tex=\"inline\"\u002F\u003E, то в правдоподобие выборки «пойдет» \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb5d\u002Ff1c\u002Fa28\u002Fb5df1ca28f5177703028579f63ece0a3.svg\" alt=\"$0.1$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E3.\u003C\u002Fb\u003E Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F42a\u002Fee5\u002F5a3\u002F42aee55a3d38b48198849d201571fec7.svg\" alt=\"$y_i=-1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F482\u002Fd62\u002Fb49\u002F482d62b4937323f4105296ea8c16acef.svg\" alt=\"$\\sigma(\\vec{w}^T\\vec{x_i})=0.1$\" data-tex=\"inline\"\u002F\u003E, то в правдоподобие выборки «пойдет» \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F631\u002Fc81\u002Fb26\u002F631c81b26a64fc66071635fc4d148e83.svg\" alt=\"$1-0.1=0.9$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E4.\u003C\u002Fb\u003E Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F42a\u002Fee5\u002F5a3\u002F42aee55a3d38b48198849d201571fec7.svg\" alt=\"$y_i=-1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F569\u002Fd14\u002Fc6b\u002F569d14c6b282aa74ae81d7e57e25205d.svg\" alt=\"$\\sigma(\\vec{w}^T\\vec{x_i})=0.9$\" data-tex=\"inline\"\u002F\u003E, то в правдоподобие выборки «пойдет» \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc78\u002F83a\u002F44f\u002Fc7883a44f4318bc1e3efbc58d60ae578.svg\" alt=\"$1-0.9=0.1$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОчевидно, что в 1 и 3 случае, когда вероятности были правильно определены алгоритмом, \u003Ci\u003Eфункция правдоподобия\u003C\u002Fi\u003E будет максимизироваться, то есть именно это мы и хотели получить. Однако, такой подход достаточно громоздок и далее мы рассмотрим более компактную запись. Но для начала, логарифмируем функцию правдоподобия с заменой знака, так как теперь мы будем минимизировать ее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F130\u002Fe8f\u002F691\u002F130e8f691883e01464d6cff33b3855b8.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-[y_i=+1] \\mkern 2mu log_e \\mkern 5mu \\sigma(\\vec{w}^T \\vec{x_i}) - [y_i=-1] \\mkern 2mu log_e \\mkern 5mu (1 - \\sigma(\\vec{w}^T \\vec{x_i})) ) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\nПодставим вместо \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1ad\u002Fa5b\u002F74b\u002F1ada5b74b1742762c61122c55c12278d.svg\" alt=\"$\\sigma(\\vec{w}^T \\vec{x_i})$\" data-tex=\"inline\"\u002F\u003E выражение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F12e\u002Fd0f\u002Fce9\u002F12ed0fce95916e6d30c11224edeedb2f.svg\" alt=\"$\\frac{1}{1+e^{-\\vec{w}^T\\vec{x_i}}}$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc2c\u002F0ab\u002F36e\u002Fc2c0ab36e7845ed6bc08f3bfa7f7a6f5.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-[y_i=+1] \\mkern 2mu log_e \\mkern 5mu (\\frac{1}{1+e^{-\\vec{w}^T\\vec{x_i}}}) - [y_i=-1] \\mkern 2mu log_e \\mkern 5mu (1 - \\frac{1}{1+e^{-\\vec{w}^T\\vec{x_i}}})) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\nУпростим правое слагаемое под логарифмом, используя простые арифметические приемы и получим:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc5e\u002F32f\u002Ff29\u002Fc5e32ff297d5114261c85aa8b00d74e4.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n(-[y_i=+1] \\mkern 2mu log_e \\mkern 5mu (\\frac{1}{1+e^{-\\vec{w}^T\\vec{x_i}}}) - [y_i=-1] \\mkern 2mu log_e \\mkern 5mu (\\frac{1}{1+e^{\\vec{w}^T\\vec{x_i}}})) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\nА теперь настало время избавиться от оператора \u003Ci\u003E«если..., то...»\u003C\u002Fi\u003E. Заметим, что когда объект \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F98f\u002F639\u002F4b2\u002F98f6394b2bd98b852bb0895b97d55e9f.svg\" alt=\"$y_i$\" data-tex=\"inline\"\u002F\u003E относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E, то в выражении под логарифмом, в знаменателе, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5ca\u002F4b8\u002Fca1\u002F5ca4b8ca180f7495da819508f8afce6e.svg\" alt=\"$e$\" data-tex=\"inline\"\u002F\u003E возводится в степень \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F2ef\u002Ffe9\u002Fb2f\u002F2effe9b2fa746e71bccdc797bd588ee2.svg\" alt=\"$-\\vec{w}^T\\vec{x_i}$\" data-tex=\"inline\"\u002F\u003E, если объект относится к классу \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E, то $e$ возводится в степень \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fcd2\u002Fd35\u002Facf\u002Fcd2d35acf1773be3215db6fd6e748ec9.svg\" alt=\"$+\\vec{w}^T\\vec{x_i}$\" data-tex=\"inline\"\u002F\u003E. Следовательно запись степени можно упростить — объединить оба случая в один: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F938\u002F9c1\u002F2ac\u002F9389c12ac3c73b94e1a58ee72b0a2f4b.svg\" alt=\"$-y_i\\vec{w}^T\\vec{x_i}$\" data-tex=\"inline\"\u002F\u003E. Тогда \u003Ci\u003Eфункция логистической ошибки\u003C\u002Fi\u003E примет вид:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F870\u002F10b\u002F55a\u002F87010b55ab3e5edfcdce9d64fcd39532.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n- \\mkern 2mu log_e \\mkern 5mu (\\frac{1}{1+e^{-y_i\\vec{w}^T\\vec{x_i}}} ) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ соответствии с правилами логарифмирования, перевернем дробь и вынесем знак \"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd3d\u002Ff50\u002Fb83\u002Fd3df50b83f85c2e599b5a46b9d893c5e.svg\" alt=\"$-$\" data-tex=\"inline\"\u002F\u003E\" (минус) за логарифм, получим:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd6e\u002F0b4\u002F554\u002Fd6e0b4554b2d543ca71a394156c386b1.svg\" alt=\"$L_{log}(X,\\vec{y},\\vec{w}) = \\sum\\limits_{i=1}^n \\mkern 2mu log_e \\mkern 5mu (1+e^{-y_i\\vec{w}^T\\vec{x_i}}) \\rightarrow min$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПеред вами функция потерь \u003Ci\u003Elogistic Loss\u003C\u002Fi\u003E, которая применяется в обучающей выборке с объектами относимых к классам: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9d1\u002F49e\u002Fa8e\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\" alt=\"$+1$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd06\u002F719\u002Fedc\u002Fd06719edc69908e7467f7e6189302b74.svg\" alt=\"$-1$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто ж, на этом моменте я откланиваюсь и мы завершаем статью.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F479398\u002F\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F1ea\u002Ff1d\u002F7cc\u002F1eaf1d7cc593750347f384d8d73d69a5.svg\" alt=\"$\\leftarrow$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fa\u003E Предыдущая работа автора — «Приводим уравнение линейной регрессии в матричный вид»\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВспомогательные материалы\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003E1. Литература\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n1) Прикладной регрессионный анализ \u002F Н. Дрейпер, Г. Смит – 2-е изд. – М.: Финансы и статистика, 1986 (перевод с английского)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) Теория вероятностей и математическая статистика \u002F В.Е. Гмурман — 9-е изд. — М.: Высшая школа, 2003\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) Теория вероятностей \u002F Н.И. Чернова — Новосибирск: Новосибирский государственный университет, 2007\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4) Бизнес-аналитика: от данных к знаниям \u002F Паклин Н. Б., Орешков В. И. — 2-е изд. — Санкт-Петербург: Питер, 2013\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n5) Data Science Наука о данных с нуля \u002F Джоэл Грас — Санкт-Петербург: БХВ Петербург, 2017\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n6) Практическая статистика для специалистов Data Science \u002F П.Брюс, Э.Брюс — Санкт-Петербург: БХВ Петербург, 2018\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003E2. Лекции, курсы (видео)\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n1) \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=2iRIqkm1mug\" rel=\"nofollow\"\u003EСуть метода максимального правдоподобия, Борис Демешев\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=9CeB32vxM0A\" rel=\"nofollow\"\u003EМетод максимального правдоподобия в непрерывном случае, Борис Демешев\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=NO4KSNbsXZE\" rel=\"nofollow\"\u003EЛогистическая регрессия. Открытый курс ODS, Yury Kashnitsky\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4) \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=PrsLyrz7Zlw&amp;list=PLEqoHzpnmTfDwuwrFHWVHdr1-qJsfqCUX&amp;index=3\" rel=\"nofollow\"\u003EЛекция 4, Евгений Соколов (с 47 минуты видео)\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n5) \u003Ca href=\"https:\u002F\u002Fwww.coursera.org\u002Flecture\u002Fvvedenie-mashinnoe-obuchenie\u002Floghistichieskaia-rieghriessiia-8G3Xu\" rel=\"nofollow\"\u003EЛогистическая регрессия, Вячеслав Воронцов\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003E3. Интернет-источники\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n1) \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fods\u002Fblog\u002F323890\u002F\"\u003EЛинейные модели классификации и регрессии\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fio\u002Fblog\u002F265007\u002F\"\u003EКак легко понять логистическую регрессию\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) \u003Ca href=\"https:\u002F\u002Fdyakonov.org\u002F2018\u002F03\u002F12\u002F%D0%BB%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F-%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B8\u002F\" rel=\"nofollow\"\u003EЛогистическая функция ошибки\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4) \u003Ca href=\"http:\u002F\u002Fmathprofi.ru\u002Fnezavisimye_ispytanija_i_formula_bernulli.html\" rel=\"nofollow\"\u003EНезависимые испытания и формула Бернули\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n5) \u003Ca href=\"https:\u002F\u002Fwww.hse.ru\u002Fdata\u002F2012\u002F11\u002F21\u002F1248365473\u002F%D0%9C%D0%9C%D0%9F%20%D0%B4%D0%BB%D1%8F%202%20%D0%BA%D1%83%D1%80%D1%81%D0%B0%20%D0%BF%D0%BE%D0%BB%D0%B8%D1%82%D0%BE%D0%BB%D0%BE%D0%B3%D0%BE%D0%B2%20(%D0%BF%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5%20-%20%D1%87%D1%8C%D1%8F-%D1%82%D0%BE%20%D0%BC%D0%B0%D1%82%D1%8C).pdf\" rel=\"nofollow\"\u003EБаллада о ММП\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n6) \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D1%80%D0%B0%D0%B2%D0%B4%D0%BE%D0%BF%D0%BE%D0%B4%D0%BE%D0%B1%D0%B8%D1%8F\" rel=\"nofollow\"\u003EМетод максимального правдоподобия\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n7) \u003Ca href=\"https:\u002F\u002Fru.onlinemschool.com\u002Fmath\u002Fformula\u002Flogarithm_formula\u002F\" rel=\"nofollow\"\u003EФормулы и свойства логарифмов\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n8) \u003Ca href=\"https:\u002F\u002Fzero2hero.org\u002Farticle\u002Fmath\u002F34-eksponenta-i-chislo-e-prosto-i-ponyatno\" rel=\"nofollow\"\u003EПочему число \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5ca\u002F4b8\u002Fca1\u002F5ca4b8ca180f7495da819508f8afce6e.svg\" alt=\"$e$\" data-tex=\"inline\"\u002F\u003E?\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9B%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B9_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80\" rel=\"nofollow\"\u003E9) Линейный классификатор\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n9) \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlexanderPetrenko83\u002FArticles\u002Ftree\u002Fmaster\u002F20200128_Logistic_Regression\" rel=\"nofollow\"\u003EJupyter notebook на гитхабе\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"анализ данных для начинающих"},{"titleHtml":"линейный классификатор"},{"titleHtml":"логистическая регрессия"},{"titleHtml":"правдоподобие"},{"titleHtml":"функция потерь 'Logistic Loss'"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgo\u002Fl_\u002Fhb\u002Fgol_hb6f3ink4lzvhvgj5mk0gnc.jpeg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgo\u002Fl_\u002Fhb\u002Fgol_hb6f3ink4lzvhvgj5mk0gnc.jpeg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F485872\\\u002F\"},\"headline\":\"Пережевывая логистическую регрессию\",\"datePublished\":\"2020-01-28T13:32:47+03:00\",\"dateModified\":\"2020-10-30T11:48:14+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Александр Петренко\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, фун...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F485872\\\u002F#post-content-body\",\"about\":[\"h_python\",\"h_maths\",\"h_machine_learning\",\"h_study\",\"h_artificial_intelligence\",\"f_develop\",\"f_management\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F485872\\\u002F2ef456ad68f6970ce2f07b0622f8c45a\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fgz\\\u002Fx1\\\u002Foz\\\u002Fgzx1ozgcc-evcxyxrjjefqfetja.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F734\\\u002Fc62\\\u002F0a1\\\u002F734c620a1b0b841a33c195da2b9eea42.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F585\\\u002Fef6\\\u002Fe3a\\\u002F585ef6e3a3cddcd7fc7f3a2066a186b5.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe80\\\u002Fd81\\\u002F93d\\\u002Fe80d8193d49469dee69b5a8c4bf8b6ec.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F6cd\\\u002F3e7\\\u002Fa4e\\\u002F6cd3e7a4e1762efb4733a1ef7d0047de.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd6e\\\u002F0b4\\\u002F554\\\u002Fd6e0b4554b2d543ca71a394156c386b1.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F9b3\\\u002F4c4\\\u002Fda5\\\u002F9b34c4da5c757d4982bbd1b6f2e8998a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F6d6\\\u002Fa4f\\\u002F78f\\\u002F6d6a4f78fbacd6edecc018ce8ad3e364.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc6e\\\u002F9ce\\\u002F6fa\\\u002Fc6e9ce6fa3ec33e39afdda03e5559c67.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F64b\\\u002Feb7\\\u002F37a\\\u002F64beb737a23fb5cb0a455f0e9213f2a4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd07\\\u002Fcc5\\\u002Fb26\\\u002Fd07cc5b26db621faab45e0e0b54ede62.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb81\\\u002Fa7c\\\u002F1e9\\\u002Fb81a7c1e9676b36cc02ddeea5d5f6e51.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fis\\\u002Fxw\\\u002F0m\\\u002Fisxw0mnnbx1iowlms-cim4nekzs.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fbc0\\\u002F520\\\u002F56d\\\u002Fbc052056d1d8b3737378422e61c0b96a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1d6\\\u002Ffc6\\\u002F8e9\\\u002F1d6fc68e93e5b2fb640d3c5ba30838b4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb9a\\\u002F683\\\u002Fb5b\\\u002Fb9a683b5bb695de57126e5db4ebb7436.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4d5\\\u002F24b\\\u002F21f\\\u002F4d524b21f2020047e2d340a59f17ccba.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F0df\\\u002F530\\\u002Ffff\\\u002F0df530ffff8762f5174e6539bc64ddc4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fbf8\\\u002F3b5\\\u002F32c\\\u002Fbf83b532cd867d34004f8eded8c5c79a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F941\\\u002Fd95\\\u002F780\\\u002F941d95780d8800fd32e758b586120101.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F6u\\\u002Fmu\\\u002Fvk\\\u002F6umuvkl-ulskbew1eptm9azq-ns.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc8a\\\u002F7a1\\\u002Fd6e\\\u002Fc8a7a1d6ed0bb61476e853b184c1ae34.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4a9\\\u002Fd9b\\\u002F7c3\\\u002F4a9d9b7c3a796b664147c4267469a945.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fd5\\\u002Fmt\\\u002Fvp\\\u002Fd5mtvp3cdodptyrglkqkjumcz4c.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F77c\\\u002F86b\\\u002F417\\\u002F77c86b4173bc0406c4de95039461df33.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F9d1\\\u002F49e\\\u002Fa8e\\\u002F9d149ea8ef8692eb106a55ce5af36ccd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd06\\\u002F719\\\u002Fedc\\\u002Fd06719edc69908e7467f7e6189302b74.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff9c\\\u002F3c8\\\u002Fe48\\\u002Ff9c3c8e488ead4696749012f5ece6d13.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F83a\\\u002F09b\\\u002F484\\\u002F83a09b484baf09b29374b626743ee4de.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb0b\\\u002F232\\\u002Ff34\\\u002Fb0b232f343595119559cf1186dd5f4a7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe52\\\u002Fd01\\\u002F8f8\\\u002Fe52d018f87e1844bc2e714af79f0cdf0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd6d\\\u002F1e2\\\u002Fab7\\\u002Fd6d1e2ab791a06785be738fe3a3a4f9d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd11\\\u002F82d\\\u002Fcbe\\\u002Fd1182dcbec38620f7bdfad6d7a8529ab.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff68\\\u002F2d0\\\u002F19e\\\u002Ff682d019e8fd1f11da97e75f9863c232.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1d0\\\u002F034\\\u002Fa09\\\u002F1d0034a09108db7af7cf42ea23a91ecd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F80b\\\u002F03c\\\u002Fcfd\\\u002F80b03ccfdd0e8cb84e222715755ccf26.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa5d\\\u002F538\\\u002Ff83\\\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F3e4\\\u002Fc77\\\u002Fa6e\\\u002F3e4c77a6e7c579a778fa84a18b6f4be0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1f1\\\u002F806\\\u002Fcaa\\\u002F1f1806caa396ad814c5cbae44638a38f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F3d4\\\u002F4dd\\\u002Fae7\\\u002F3d44ddae7c3d13b9dd873c4a1e09491b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F91c\\\u002F34b\\\u002F351\\\u002F91c34b351d7bb8df08e960b4cdc79b16.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F53f\\\u002F440\\\u002F8d3\\\u002F53f4408d3030531b75daef03c76269a0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fcc6\\\u002Ff03\\\u002F35e\\\u002Fcc6f0335e61e908711d629714f8d8b9e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff5c\\\u002Fdcd\\\u002F662\\\u002Ff5cdcd662a6590cdf971e57494ad123e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fca8\\\u002F978\\\u002Fec5\\\u002Fca8978ec597af63524046a377099d3e3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F578\\\u002F281\\\u002Fd89\\\u002F578281d8997e0a562a02dd61422d408e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc61\\\u002F27e\\\u002Fd7b\\\u002Fc6127ed7b7116b2c9a29e8e238568254.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe94\\\u002F750\\\u002F131\\\u002Fe9475013121faba30996b549a41012e4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F5ca\\\u002F4b8\\\u002Fca1\\\u002F5ca4b8ca180f7495da819508f8afce6e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F3b2\\\u002F5f5\\\u002F4ec\\\u002F3b25f54ec24ac9790536a5bfcdb7dcbd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc7e\\\u002F327\\\u002Fed9\\\u002Fc7e327ed9d8fd93eb5907c962f2f0328.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1d2\\\u002F7d3\\\u002Fbdb\\\u002F1d27d3bdb1b03bf2039cce88af50c550.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd2c\\\u002Fbf7\\\u002F357\\\u002Fd2cbf7357ab08df200b02965bbb4ab7d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc6d\\\u002F3a5\\\u002Fe80\\\u002Fc6d3a5e8054aff891d32c89f4ee0c644.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F833\\\u002F9ae\\\u002F0b9\\\u002F8339ae0b9d7645bc12a507a4ac54cf5d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F998\\\u002Fca3\\\u002F299\\\u002F998ca3299c7f4129d6975ea34d17809a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff0f\\\u002Fe94\\\u002F423\\\u002Ff0fe944236e68f60b16034803d6f1823.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F84e\\\u002F9ac\\\u002F43b\\\u002F84e9ac43b312c23b9b1f4df072eef404.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F8a4\\\u002F3e6\\\u002Fbe5\\\u002F8a43e6be57441a31f74f074ea308af36.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa63\\\u002Fd3d\\\u002F38a\\\u002Fa63d3d38ab1e837cefce61df83c7462e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F581\\\u002Fdfc\\\u002F94f\\\u002F581dfc94f691212b843d5ca4ceb6cd9e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F6c6\\\u002Fdea\\\u002F0d6\\\u002F6c6dea0d6895ca8fd36155c626096403.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa12\\\u002F825\\\u002F840\\\u002Fa128258409b83f835e4ec02da427bfcf.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc25\\\u002F62f\\\u002F5ef\\\u002Fc2562f5ef0d27f9097183c0938c48b52.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fks\\\u002Fby\\\u002F4c\\\u002Fksby4cvyvhchnyw3g7mogrucage.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F712\\\u002F33f\\\u002F9da\\\u002F71233f9da088a69f4f80e0a824f0bd91.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4c0\\\u002Fd80\\\u002Fe6b\\\u002F4c0d80e6b4c4049ac52c22fd0d27637e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F10\\\u002Ftg\\\u002F7r\\\u002F10tg7rztpblsl8swwgjzmlgtwlo.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fefe\\\u002F096\\\u002F7c6\\\u002Fefe0967c69a87a9a7f693fd242b72387.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fcd6\\\u002F887\\\u002F374\\\u002Fcd6887374d65ca7e0699f041a7654ae1.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F443\\\u002F801\\\u002F8cd\\\u002F4438018cd3c35de475a419ecf521c389.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F5c8\\\u002F4b2\\\u002F2b7\\\u002F5c84b22b7edd29e66fd652a658254ec0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F818\\\u002F0dc\\\u002Ff31\\\u002F8180dcf31c8787d11205a3b3536e2900.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F005\\\u002Fad0\\\u002Fd51\\\u002F005ad0d512f20ff825d820bdbd26ba7f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe64\\\u002Fafb\\\u002Fa2b\\\u002Fe64afba2b591c3b84beebfc496e12c51.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F839\\\u002Ff25\\\u002Fc27\\\u002F839f25c2746382debd4f08ea25ad5ecf.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd0b\\\u002F857\\\u002Fb4e\\\u002Fd0b857b4ee991737b3ec7dbd1407cacb.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fedf\\\u002Ffd0\\\u002Ff08\\\u002Fedffd0f0825aef6a235b500fb1b87584.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fad1\\\u002Fc0a\\\u002F9f6\\\u002Fad1c0a9f6ac079079f55104222ff7a13.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd47\\\u002Fc89\\\u002F4c4\\\u002Fd47c894c4276b3f3b8b5fe9158ab0cfe.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fdaf\\\u002F63d\\\u002F647\\\u002Fdaf63d6479f73e4d3402348866d62dbf.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ffb3\\\u002Fa6d\\\u002F4e4\\\u002Ffb3a6d4e4b9ab34c577d6e5ddc7cb395.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff8a\\\u002F1c5\\\u002F0ed\\\u002Ff8a1c50ed39505a982ca83ce75812904.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff8e\\\u002Fca7\\\u002Fd90\\\u002Ff8eca7d90ef3968c1680a1be4dc64103.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F139\\\u002F181\\\u002Fad0\\\u002F139181ad0acdf2d6d84dcf662097019a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F832\\\u002Ffa7\\\u002Fc30\\\u002F832fa7c3084c0110a5e3d7621631a1fc.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F919\\\u002Fa65\\\u002Fb66\\\u002F919a65b6676bcd796279a8aac6163a7a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe47\\\u002Fb36\\\u002Fa76\\\u002Fe47b36a76b99b13313aff0043d484c77.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fcca\\\u002F29f\\\u002Fb6c\\\u002Fcca29fb6c52655a8f94f7bbe703f11c7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F72f\\\u002F090\\\u002F8f0\\\u002F72f0908f0f53ffc3a54f80d75d3fb568.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F27f\\\u002F4f6\\\u002F6c3\\\u002F27f4f66c312aa01b7a3501d94baa0c49.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fee0\\\u002Fc6f\\\u002Ffe8\\\u002Fee0c6ffe8a8600fd1cbf065d96aef5ee.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd9e\\\u002Ff57\\\u002F1ce\\\u002Fd9ef571ce10aee3f03bdbda6593efa25.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc60\\\u002F0eb\\\u002F78d\\\u002Fc600eb78d0627ef7e91964968ce726ab.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fff3\\\u002Fc27\\\u002F3c6\\\u002Fff3c273c683dbcd3c7b00d2a071d6a7c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F08b\\\u002Fa9c\\\u002F561\\\u002F08ba9c56140cf603308f9b84a26dc818.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd07\\\u002Ff1d\\\u002Fa80\\\u002Fd07f1da809e6567bb1d0c45ee267aef7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F577\\\u002F682\\\u002F05c\\\u002F57768205c03a5547a4d44277f9c9d441.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Feb8\\\u002Fe5d\\\u002Fbae\\\u002Feb8e5dbae515dac15b124967e822d9b9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F50b\\\u002Fe11\\\u002F495\\\u002F50be114953cd6d5bc76bbb62189f8b1b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff2d\\\u002F4d0\\\u002F64a\\\u002Ff2d4d064aa2bf94950efb5b08c371248.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff5e\\\u002F477\\\u002F412\\\u002Ff5e477412164fb26f86f1919a3280d08.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F961\\\u002F5a3\\\u002Fc22\\\u002F9615a3c22f2f2616e78ffa70509cb3aa.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F784\\\u002F337\\\u002Fa20\\\u002F784337a20607f4c11e39bdf873b1136a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F0cf\\\u002Fb19\\\u002Fbe5\\\u002F0cfb19be54f9e85b2b01e516230de60c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb2d\\\u002Ff21\\\u002F037\\\u002Fb2df210378053a29907debcb8e4594e9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fae4\\\u002Fdc5\\\u002Fc6f\\\u002Fae4dc5c6fd4ec28ba4b81a2ec09d88b9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd3d\\\u002Ff50\\\u002Fb83\\\u002Fd3df50b83f85c2e599b5a46b9d893c5e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ffd1\\\u002F184\\\u002F5be\\\u002Ffd11845becb97f0b8b77b8b6e081ae3f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4a1\\\u002F375\\\u002Fd87\\\u002F4a1375d876abb71c1dd376a63d13c727.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F569\\\u002Fd14\\\u002Fc6b\\\u002F569d14c6b282aa74ae81d7e57e25205d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff82\\\u002F7d8\\\u002F2db\\\u002Ff827d82db4267e554348e2466d45bba6.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F482\\\u002Fd62\\\u002Fb49\\\u002F482d62b4937323f4105296ea8c16acef.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb5d\\\u002Ff1c\\\u002Fa28\\\u002Fb5df1ca28f5177703028579f63ece0a3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F42a\\\u002Fee5\\\u002F5a3\\\u002F42aee55a3d38b48198849d201571fec7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F631\\\u002Fc81\\\u002Fb26\\\u002F631c81b26a64fc66071635fc4d148e83.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc78\\\u002F83a\\\u002F44f\\\u002Fc7883a44f4318bc1e3efbc58d60ae578.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F130\\\u002Fe8f\\\u002F691\\\u002F130e8f691883e01464d6cff33b3855b8.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1ad\\\u002Fa5b\\\u002F74b\\\u002F1ada5b74b1742762c61122c55c12278d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F12e\\\u002Fd0f\\\u002Fce9\\\u002F12ed0fce95916e6d30c11224edeedb2f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc2c\\\u002F0ab\\\u002F36e\\\u002Fc2c0ab36e7845ed6bc08f3bfa7f7a6f5.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc5e\\\u002F32f\\\u002Ff29\\\u002Fc5e32ff297d5114261c85aa8b00d74e4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F98f\\\u002F639\\\u002F4b2\\\u002F98f6394b2bd98b852bb0895b97d55e9f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F2ef\\\u002Ffe9\\\u002Fb2f\\\u002F2effe9b2fa746e71bccdc797bd588ee2.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fcd2\\\u002Fd35\\\u002Facf\\\u002Fcd2d35acf1773be3215db6fd6e748ec9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F938\\\u002F9c1\\\u002F2ac\\\u002F9389c12ac3c73b94e1a58ee72b0a2f4b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F870\\\u002F10b\\\u002F55a\\\u002F87010b55ab3e5edfcdce9d64fcd39532.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F1ea\\\u002Ff1d\\\u002F7cc\\\u002F1eaf1d7cc593750347f384d8d73d69a5.svg\"]}","metaDescription":"В этой статье, мы будем разбирать теоретические выкладки преобразования функции линейной регрессии в функцию обратного логит-преобразования (иначе говорят, функцию логистического отклика) . Затем,...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"tutorial","banner":null,"multiwidget":null,"readingTime":20,"complexity":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":["501414","479816","579072","148840","91811","710240","678524","431950","499990","430216"],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"Django разработчик","vacanciesCount":55,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fdjango_razrabotchik","itemHubs":["django","python"]},{"title":"Data Scientist","vacanciesCount":160,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fdata_scientist","itemHubs":["bigdata","r","data_mining","python","machine_learning"]},{"title":"Python разработчик","vacanciesCount":149,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fprogrammist_python","itemHubs":["django","flask","python"]}],"hubs":"python,maths,machine_learning,study,artificial_intelligence"},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewPostsAll":78,"countNewNewsAll":63},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"courses":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-366","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F086\u002F89e\u002F632\u002F08689e632aca9e7a8b3ce0cbf90684ad.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002Fon6br"},"title":"Активность найма на IT-рынке в марте","lang":"ru","startTime":"2023-04-13T15:00:52+03:00","finishTime":"2023-04-19T15:46:52+03:00","slides":[{"id":"story-366_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F500\u002F416\u002F672\u002F500416672540bb5785f750f03cfaebcc.png","button":null},{"id":"story-366_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd5a\u002Fea8\u002F6fa\u002Fd5aea86fa35f4e2e653f58fbf3c1d0dd.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fon6br","colorType":"dark"}},{"id":"story-366_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F179\u002Fc9b\u002F5fc\u002F179c9b5fc2f77a62cc4e2321a9a2be8b.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fon6br","colorType":"dark"}},{"id":"story-366_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F409\u002Fb7e\u002Fb16\u002F409b7eb16023212089f85a9cb43124bc.png","button":{"title":"Смотреть","link":"https:\u002F\u002Fu.habr.com\u002Fon6br","colorType":"dark"}}]},{"id":"story-368","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb8a\u002Fc91\u002F391\u002Fb8ac9139163036dcfc8b7cb45c71f057.png","title":"Хабр Новости","link":"https:\u002F\u002Fu.habr.com\u002F1zgg0"},"title":"ИИ помог выявить простуду по голосу","lang":"ru","startTime":"2023-04-13T11:00:17+03:00","finishTime":"2023-04-16T23:59:00+03:00","slides":[{"id":"story-368_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fab0\u002Fbb6\u002Fc7c\u002Fab0bb6c7c353925f61448eb7beec4bc6.jpg","button":null},{"id":"story-368_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F199\u002F76a\u002F914\u002F19976a914a62f9a30c315af43d4e1640.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002F1zgg0","colorType":"light"}},{"id":"story-368_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F700\u002F656\u002F9e4\u002F7006569e41a6f59101e0682017565009.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002F1zgg0","colorType":"light"}}]},{"id":"story-364","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd83\u002Fe67\u002F8b1\u002Fd83e678b14becd59d4f93e3529aaea6b.png","title":"Хабр Карьера","link":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies?type=suitable"},"title":"Бесплатные вакансии в тестировании","lang":"ru","startTime":"2023-04-12T14:27:00+03:00","finishTime":"2023-04-19T14:27:01+03:00","slides":[{"id":"story-364_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc3c\u002Ff8f\u002F3f4\u002Fc3cf8f3f470787454666ed3e94ab58ef.png","button":{"title":"Добавить вакансию","link":"https:\u002F\u002Fu.habr.com\u002FiEJVA","colorType":"dark"}},{"id":"story-364_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F50f\u002Fec8\u002Fb70\u002F50fec8b702f25d9a0beec9c5705120be.png","button":{"title":"Добавить вакансию","link":"https:\u002F\u002Fu.habr.com\u002FiEJVA","colorType":"dark"}}]},{"id":"story-362","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0a8\u002F579\u002F1eb\u002F0a85791eb9b6f50356f143fac33415fe.png","title":"Хабр","link":null},"title":"День космонавтики","lang":"ru","startTime":"2023-04-12T13:16:00+03:00","finishTime":"2023-04-19T13:16:05+03:00","slides":[{"id":"story-362_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F335\u002F682\u002Fed1\u002F335682ed151b5a887f39ab3a02036817.jpg","button":null},{"id":"story-362_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbfc\u002F2df\u002F1fa\u002Fbfc2df1fa937e2eec1a45a7f37b2ed51.jpg","button":{"title":"Перенять","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fvk\u002Farticles\u002F485612\u002F","colorType":"light"}},{"id":"story-362_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5d1\u002F37a\u002Fa2e\u002F5d137aa2e932caff65c3940da491e39e.jpg","button":{"title":"Подвезти?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F592143\u002F","colorType":"light"}},{"id":"story-362_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8cb\u002F525\u002Fe13\u002F8cb525e1383b34641fc13398a7451996.jpg","button":{"title":"Прогуляться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fruvds\u002Farticles\u002F461453\u002F","colorType":"light"}},{"id":"story-362_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F99a\u002Fa20\u002F060\u002F99aa20060d9e409ac7eec7853e41eeab.jpg","button":{"title":"Удивиться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fvk\u002Farticles\u002F448210\u002F","colorType":"light"}},{"id":"story-362_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F190\u002F85e\u002F70e\u002F19085e70e2fe99118186ea714af01c80.jpg","button":{"title":"Читать интервью","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F375519\u002F","colorType":"light"}},{"id":"story-362_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe87\u002F208\u002Fb50\u002Fe87208b5038f2e110f348ba9151dd1b8.jpg","button":{"title":"Закусить","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F223211\u002F","colorType":"light"}},{"id":"story-362_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd23\u002F59d\u002Fb55\u002Fd2359db5586f1539ab1528847c87877d.jpg","button":{"title":"Пристыковаться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F215627\u002F","colorType":"light"}}]},{"id":"story-360","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9f3\u002Fc4e\u002F858\u002F9f3c4e858b7c6f1453ad89779815f76f.png","title":"Хабр","link":null},"title":"Топ-7 годноты из блогов компаний","lang":"ru","startTime":"2023-04-11T15:10:00+03:00","finishTime":"2023-04-19T15:10:00+03:00","slides":[{"id":"story-360_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd52\u002F91d\u002F9dd\u002Fd5291d9ddefbd079d2fe6b4f31ec9470.jpg","button":null},{"id":"story-360_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F710\u002F952\u002Ff8a\u002F710952f8ae13475ad7bb5d2ade0ec726.jpg","button":{"title":"Согнуть ложку","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ffirst\u002Fblog\u002F724300\u002F","colorType":"light"}},{"id":"story-360_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F74a\u002F7af\u002F256\u002F74a7af2568c5a951893e53bd4330fd37.jpg","button":{"title":"Сэкономили","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fqiwi\u002Fblog\u002F724298\u002F","colorType":"light"}},{"id":"story-360_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffe1\u002Fc12\u002F81b\u002Ffe1c1281be6062341ff9212a396d410e.jpg","button":{"title":"И что делать?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fgetmatch\u002Fblog\u002F724320\u002F","colorType":"light"}},{"id":"story-360_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F507\u002F222\u002F1a4\u002F5072221a4bdbf38bfb063ff84bc0ea94.jpg","button":{"title":"Кладите трубку","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002FVoximplant\u002Fblog\u002F725314\u002F","colorType":"dark"}},{"id":"story-360_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd17\u002Fbb2\u002Fcee\u002Fd17bb2ceec2efe7308d8c14cd729ec1c.jpg","button":{"title":"Под микроскопом","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F724340\u002F","colorType":"light"}},{"id":"story-360_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6f2\u002F87b\u002F146\u002F6f287b14607e21faa30a0b1e16dea922.jpg","button":{"title":"Таблицы и графики","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fispsystem\u002Fblog\u002F724882\u002F","colorType":"light"}},{"id":"story-360_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1a4\u002F6af\u002Fe0f\u002F1a46afe0f4034edee47207236c337470.jpg","button":{"title":"По солнцу","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F718680\u002F","colorType":"light"}}]},{"id":"story-358","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc03\u002Fcd3\u002F60d\u002Fc03cd360d093edfe80d51017fe497046.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FU65Ng"},"title":"Дайджест событий для IT HR в апреле","lang":"ru","startTime":"2023-04-10T15:51:00+03:00","finishTime":"2023-04-17T15:51:42+03:00","slides":[{"id":"story-358_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F40c\u002Fb88\u002Fd70\u002F40cb88d702349602f65539b0332a83ac.png","button":{"title":"Подробности","link":"https:\u002F\u002Fu.habr.com\u002FU65Ng","colorType":"dark"}},{"id":"story-358_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F077\u002Fc25\u002F227\u002F077c252274d15bfd12888691ac32afce.png","button":{"title":"Читать пост","link":"https:\u002F\u002Fu.habr.com\u002FU65Ng","colorType":"dark"}},{"id":"story-358_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fec8\u002Fec3\u002F269\u002Fec8ec3269ae0043cf4e80881ebd1b552.png","button":{"title":"Смотреть","link":"https:\u002F\u002Fu.habr.com\u002FU65Ng","colorType":"dark"}}]},{"id":"story-356","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffb0\u002Fd35\u002Fcac\u002Ffb0d35cac059015696bbe2d3ec40c769.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main"},"title":"Сезон нейроарта на Хабре","lang":"ru","startTime":"2023-04-07T14:57:00+03:00","finishTime":"2023-04-14T14:57:52+03:00","slides":[{"id":"story-356_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1a7\u002F346\u002Fa55\u002F1a7346a558379effad15fba5e1e40d20.jpg","button":{"title":"Что за конкурс?","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}},{"id":"story-356_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd93\u002Fd9f\u002F0a7\u002Fd93d9f0a793a04ae179c02b50e0dc243.jpg","button":{"title":"Какая обложка?","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"dark"}},{"id":"story-356_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe1a\u002F9b3\u002Ff3e\u002Fe1a9b3f3ed678cd1a591d8ee13fd9728.jpg","button":{"title":"Все правила","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}},{"id":"story-356_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fff6\u002Faae\u002F36a\u002Fff6aae36abd5c4861e6b713306d34277.jpg","button":null},{"id":"story-356_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F159\u002F90f\u002F59e\u002F15990f59e680dce1bbb3bd47cd6f2a36.jpg","button":{"title":"Найти ссылки","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"dark"}},{"id":"story-356_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc08\u002Fe40\u002F31b\u002Fc08e4031b3251ecae64fb53051cbc677.jpg","button":{"title":"К конкурсу","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}}]},{"id":"story-354","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F89b\u002Fa37\u002Fecd\u002F89ba37ecd346168d1d2cb61d66dcd516.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s"},"title":"Туториалы по Kubernetes","lang":"ru","startTime":"2023-04-07T14:43:00+03:00","finishTime":"2023-04-16T14:43:00+03:00","slides":[{"id":"story-354_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F036\u002F4e9\u002F9c5\u002F0364e99c56807882ebdccc77bd4bf672.jpg","button":{"title":"Публикации Сезона","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"light"}},{"id":"story-354_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff4d\u002F8fe\u002F8cc\u002Ff4d8fe8cc20d49190abc5325af5d8945.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"dark"}},{"id":"story-354_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F00c\u002F1a7\u002Ff54\u002F00c1a7f548ede2da8500fc8575af45da.jpg","button":{"title":"К постам","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"dark"}},{"id":"story-354_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Feaf\u002Fdf7\u002Fe16\u002Feafdf7e164e761cabbc27f6183b0084d.jpg","button":{"title":"Все посты Сезона","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"light"}}]},{"id":"story-350","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F290\u002F2f5\u002F0d3\u002F2902f50d338f93d8b65285dd2a153463.png","title":"Хабр","link":null},"title":"Читай и худей","lang":"ru","startTime":"2023-04-07T11:01:00+03:00","finishTime":"2023-04-23T23:59:00+03:00","slides":[{"id":"story-350_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F723\u002F65c\u002Fda6\u002F72365cda6d0c14aca18a524fc3e4a0e0.jpg","button":null},{"id":"story-350_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F11e\u002F1c9\u002F727\u002F11e1c9727148e5d0cb8ad95aa9c47b9f.jpg","button":{"title":"Будь готов","link":"https:\u002F\u002Fu.habr.com\u002Fwl-01","colorType":"dark"}},{"id":"story-350_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F979\u002F557\u002F6e4\u002F9795576e46e0ca5941af9b8a523051d5.jpg","button":{"title":"Не ошибись","link":"https:\u002F\u002Fu.habr.com\u002Fwl-02","colorType":"dark"}},{"id":"story-350_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F69a\u002Fd40\u002F433\u002F69ad40433d4262d10a9e70dfc4885ed6.jpg","button":{"title":"Больше о жире","link":"https:\u002F\u002Fu.habr.com\u002Fwl-03","colorType":"dark"}},{"id":"story-350_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fae7\u002Fb48\u002Fa1d\u002Fae7b48a1d46af3cbc4b88f1500d6b548.jpg","button":{"title":"Весь список","link":"https:\u002F\u002Fu.habr.com\u002Fwl-04","colorType":"dark"}},{"id":"story-350_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1e\u002F2e8\u002Fc45\u002Ff1e2e8c45f91149c9a10660223a8f085.jpg","button":{"title":"Мир внутри нас","link":"https:\u002F\u002Fu.habr.com\u002Fwl-05","colorType":"dark"}},{"id":"story-350_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F37b\u002F031\u002Fa4e\u002F37b031a4e3ff0d236bf7badd391c1eae.jpg","button":{"title":"Что в накладной","link":"https:\u002F\u002Fu.habr.com\u002Fwl-06","colorType":"dark"}}]},{"id":"story-314","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd4c\u002F911\u002F44c\u002Fd4c91144cb05d33315e57be2bfd5af08.png","title":"Хабр","link":null},"title":"Полезная подборка о зрении","lang":"ru","startTime":"2023-03-21T16:00:00+03:00","finishTime":"2023-04-23T23:59:00+03:00","slides":[{"id":"story-314_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4a1\u002Ff41\u002F14d\u002F4a1f4114d49edde48bec833df98ba458.jpg","button":null},{"id":"story-314_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F68c\u002Fead\u002F0c9\u002F68cead0c9add87d677e3cdd9a9914bec.jpg","button":{"title":"Присмотреться","link":"https:\u002F\u002Fu.habr.com\u002Fzr_01","colorType":"light"}},{"id":"story-314_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7e0\u002F8a0\u002F304\u002F7e08a0304c22f5cdc700436cdecff97d.jpg","button":{"title":"Читать правила","link":"https:\u002F\u002Fu.habr.com\u002Fzr_02","colorType":"light"}},{"id":"story-314_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F189\u002F246\u002Fd5d\u002F189246d5d41e0bad685479a177a5f060.jpg","button":{"title":"Провериться","link":"https:\u002F\u002Fu.habr.com\u002Fzr_03","colorType":"light"}},{"id":"story-314_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F464\u002F80e\u002F77d\u002F46480e77d696dafcd61161e4782bae6a.jpg","button":{"title":"Читать пост","link":"https:\u002F\u002Fu.habr.com\u002Fzr_04","colorType":"dark"}},{"id":"story-314_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F06a\u002F503\u002Fbf5\u002F06a503bf5ec67255007e1687a2573730.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fu.habr.com\u002Fzr_05","colorType":"light"}},{"id":"story-314_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe5e\u002Fa53\u002Fa0b\u002Fe5ea53a0b6f45d43f893fcf8d6d647da.jpg","button":{"title":"Смотреть туториал","link":"https:\u002F\u002Fu.habr.com\u002Fzr_06","colorType":"light"}},{"id":"story-314_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd42\u002Fa6a\u002F5ed\u002Fd42a6a5edb8845acfc321ba577e51c9e.jpg","button":{"title":"Пример настройки","link":"https:\u002F\u002Fu.habr.com\u002Fzr_07","colorType":"light"}}]},{"id":"story-310","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F755\u002F06c\u002Fe7f\u002F75506ce7f8701ea8761ea0ac9d2b72d9.png","title":"Хабр","link":null},"title":"Тренируйся: физкульт-подборка","lang":"ru","startTime":"2023-03-17T11:00:44+03:00","finishTime":"2023-04-23T23:59:00+03:00","slides":[{"id":"story-310_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F649\u002F416\u002F979\u002F64941697969ed302b95b0a11602221d8.jpg","button":null},{"id":"story-310_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F90b\u002F662\u002F984\u002F90b662984b76a7975dc7be8d250cd6b3.jpg","button":{"title":"Вставай на лыжи","link":"https:\u002F\u002Fu.habr.com\u002F8NOwN","colorType":"light"}},{"id":"story-310_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58a\u002F32e\u002Ff76\u002F58a32ef76f19b55c9169dc5d7c1aa42e.jpg","button":{"title":"Воодушевиться","link":"https:\u002F\u002Fu.habr.com\u002Fv7Zfv","colorType":"light"}},{"id":"story-310_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F134\u002F46d\u002F40c\u002F13446d40c83ee0e5647aca89c8f22b55.jpg","button":{"title":"Смотреть обзор","link":"https:\u002F\u002Fu.habr.com\u002Fn52KP","colorType":"light"}},{"id":"story-310_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F373\u002F0c3\u002Fd52\u002F3730c3d521fc2b7f2b3835ef935f96d3.jpg","button":{"title":"Прогуляться","link":"https:\u002F\u002Fu.habr.com\u002F1Hpbs","colorType":"light"}},{"id":"story-310_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd3c\u002Fb9c\u002Fb42\u002Fd3cb9cb42046eb5b44450aeecd4ef650.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FRZxhy","colorType":"light"}},{"id":"story-310_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbef\u002F940\u002F5ed\u002Fbef9405ed753baca270fef3de37c5735.jpg","button":{"title":"Читать исследование","link":"https:\u002F\u002Fu.habr.com\u002FEMnZT","colorType":"light"}},{"id":"story-310_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb3d\u002Faf4\u002F957\u002Fb3daf495751f36899dc6c7598ef0b42c.jpg","button":{"title":"Поразмыслить","link":"https:\u002F\u002Fu.habr.com\u002FWJzt6","colorType":"light"}}]},{"id":"story-152","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa49\u002F0d3\u002F609\u002Fa490d3609f29b6dfc53a7b88ab47ca64.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa"},"title":"Сеньоры — очень странные люди","lang":"ru","startTime":"2023-01-23T11:00:00+03:00","finishTime":"2023-04-30T23:59:00+03:00","slides":[{"id":"story-152_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbb\u002F901\u002F063\u002Fbbb9010630ae483ed1f41ec4e2572c13.png","button":null},{"id":"story-152_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f8\u002F66c\u002F14f\u002F4f866c14f0ca8999334438d7f17c0e3a.png","button":null},{"id":"story-152_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b9\u002Fa07\u002Fa61\u002F6b9a07a612df213ac3a1c179301828df.png","button":null},{"id":"story-152_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff6b\u002Fadb\u002Fb99\u002Ff6badbb9969d7e34ef4f7492767c6a77.png","button":null},{"id":"story-152_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd9c\u002F9ac\u002F878\u002Fd9c9ac878bec5b494699e0080dd2e813.png","button":null},{"id":"story-152_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdb1\u002Faf9\u002Fc3b\u002Fdb1af9c3bb557f6cee698cf67610f977.png","button":null},{"id":"story-152_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5cf\u002Fbed\u002F65b\u002F5cfbed65bd20b7051b1aac2b9d6e807e.png","button":null},{"id":"story-152_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa8\u002F251\u002F4a9\u002Ffa82514a9471cd455339e97178d8c021.png","button":null},{"id":"story-152_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbd5\u002F901\u002Fe95\u002Fbd5901e952d9cf638355a3cc8b0c0911.png","button":{"title":"Хочу помочь джуну","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.2d67f629.js" defer></script><script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.aeffa4e0.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
